



TLS                                                           M. Thomson
Internet-Draft                                                   Mozilla
Intended status: Informational                             June 29, 2018
Expires: December 31, 2018


                  Example Handshake Traces for TLS 1.3
                  draft-ietf-tls-tls13-vectors-latest

Abstract

   Examples of TLS 1.3 handshakes are shown.  Private keys and inputs
   are provided so that these handshakes might be reproduced.
   Intermediate values, including secrets, traffic keys and ivs are
   shown so that implementations might be checked incrementally against
   these values.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 31, 2018.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Thomson                 Expires December 31, 2018               [Page 1]

Internet-Draft               TLS 1.3 Traces                    June 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Private Keys  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Simple 1-RTT Handshake  . . . . . . . . . . . . . . . . . . .   3
   4.  Resumed 0-RTT Handshake . . . . . . . . . . . . . . . . . . .  15
   5.  HelloRetryRequest . . . . . . . . . . . . . . . . . . . . . .  26
   6.  Client Authentication . . . . . . . . . . . . . . . . . . . .  38
   7.  Compatibility Mode  . . . . . . . . . . . . . . . . . . . . .  49
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  60
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  60
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  60
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  60
     10.2.  Informative References . . . . . . . . . . . . . . . . .  60
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .  61
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  61

1.  Introduction

   TLS 1.3 [TLS13] defines a new key schedule and a number new
   cryptographic operations.  This document includes sample handshakes
   that show all intermediate values.  This allows an implementation to
   be verified incrementally, examining inputs and outputs of each
   cryptographic computation independently.

   A private key is included with the traces so that implementations can
   be checked by importing these values and verifying that the same
   outputs are produced.

   Note:  Invocations of HMAC-based Extract-and-Expand Key Derivation
      Function (HKDF) [RFC5869] are not labelled, but can be identified
      through the use the labels used by HKDF.

2.  Private Keys

   Ephemeral private keys are shown as they are generated in the traces.

   The server in most examples uses an RSA certificate with a private
   key of:

   modulus (public):  b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c
      0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab
      bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
      a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f
      da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0
      3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e
      3f




Thomson                 Expires December 31, 2018               [Page 2]

Internet-Draft               TLS 1.3 Traces                    June 2018


   public exponent:  01 00 01

   private exponent:  04 de a7 05 d4 3a 6e a7 20 9d d8 07 21 11 a8 3c 81
      e3 22 a5 92 78 b3 34 80 64 1e af 7c 0a 69 85 b8 e3 1c 44 f6 de 62
      e1 b4 c2 30 9f 61 26 e7 7b 7c 41 e9 23 31 4b bf a3 88 13 05 dc 12
      17 f1 6c 81 9c e5 38 e9 22 f3 69 82 8d 0e 57 19 5d 8c 84 88 46 02
      07 b2 fa a7 26 bc f7 08 bb d7 db 7f 67 9f 89 34 92 fc 2a 62 2e 08
      97 0a ac 44 1c e4 e0 c3 08 8d f2 5a e6 79 23 3d f8 a3 bd a2 ff 99
      41

   prime1:  e4 35 fb 7c c8 37 37 75 6d ac ea 96 ab 7f 59 a2 cc 10 69 db
      7d eb 19 0e 17 e3 3a 53 2b 27 3f 30 a3 27 aa 0a aa bc 58 cd 67 46
      6a f9 84 5f ad c6 75 fe 09 4a f9 2c 4b d1 f2 c1 bc 33 dd 2e 05 15

   prime2:  ca bd 3b c0 e0 43 86 64 c8 d4 cc 9f 99 97 7a 94 d9 bb fe ad
      8e 43 87 0a ba e3 f7 eb 8b 4e 0e ee 8a f1 d9 b4 71 9b a6 19 6c f2
      cb ba ee eb f8 b3 49 0a fe 9e 9f fa 74 a8 8a a5 1f c6 45 62 93 03

   exponent1:  3f 57 34 5c 27 fe 1b 68 7e 6e 76 16 27 b7 8b 1b 82 64 33
      dd 76 0f a0 be a6 a6 ac f3 94 90 aa 1b 47 cd a4 86 9d 68 f5 84 dd
      5b 50 29 bd 32 09 3b 82 58 66 1f e7 15 02 5e 5d 70 a4 5a 08 d3 d3
      19

   exponent2:  18 3d a0 13 63 bd 2f 28 85 ca cb dc 99 64 bf 47 64 f1 51
      76 36 f8 64 01 28 6f 71 89 3c 52 cc fe 40 a6 c2 3d 0d 08 6b 47 c6
      fb 10 d8 fd 10 41 e0 4d ef 7e 9a 40 ce 95 7c 41 77 94 e1 04 12 d1
      39

   coefficient:  83 9c a9 a0 85 e4 28 6b 2c 90 e4 66 99 7a 2c 68 1f 21
      33 9a a3 47 78 14 e4 de c1 18 33 05 0e d5 0d d1 3c c0 38 04 8a 43
      c5 9b 2a cc 41 68 89 c0 37 66 5f e5 af a6 05 96 9f 8c 01 df a5 ca
      96 9d

3.  Simple 1-RTT Handshake

   In this example, the simplest possible handshake is completed.  The
   server is authenticated, but the client remains anonymous.  After
   connecting, a few application data octets are exchanged.  The server
   sends a session ticket that permits the use of 0-RTT in any resumed
   session.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  ba cd 81 99 10 20 b4 df 5d b1 da c8 d5
         f7 19 03 d0 06 65 d3 2f f7 49 9f d7 40 88 6b 29 e5 09 81

      public key (32 octets):  4e 21 af 32 09 a3 67 3e b6 52 45 2f ca 86
         95 c3 7f dc 1d 9e 23 fc 1d 9e 7e 91 35 ca 14 7c 13 1e



Thomson                 Expires December 31, 2018               [Page 3]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (196 octets):  01 00 00 c0 03 03 66 6a 1b 62 11 b6 9b 14
         82 41 15 06 b5 04 f8 7c ec b4 b6 28 c3 e0 a7 0e 69 4e 5a 75 29
         69 a5 6c 00 00 06 13 01 13 03 13 02 01 00 00 91 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23 00
         00 00 33 00 26 00 24 00 1d 00 20 4e 21 af 32 09 a3 67 3e b6 52
         45 2f ca 86 95 c3 7f dc 1d 9e 23 fc 1d 9e 7e 91 35 ca 14 7c 13
         1e 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      ciphertext (201 octets):  16 03 01 00 c4 01 00 00 c0 03 03 66 6a
         1b 62 11 b6 9b 14 82 41 15 06 b5 04 f8 7c ec b4 b6 28 c3 e0 a7
         0e 69 4e 5a 75 29 69 a5 6c 00 00 06 13 01 13 03 13 02 01 00 00
         91 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 23 00 00 00 33 00 26 00 24 00 1d 00 20 4e 21 af 32
         09 a3 67 3e b6 52 45 2f ca 86 95 c3 7f dc 1d 9e 23 fc 1d 9e 7e
         91 35 ca 14 7c 13 1e 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  92 0d 68 f5 5c 28 a2 80 1a aa f0 26 61
         f9 32 56 50 8a ec 19 cc 2c 03 cc 87 0d 39 b4 ca ca d1 f2

      public key (32 octets):  10 69 5a f6 6d d7 01 79 bd 13 9e f7 f7 bb
         b8 ad 0c 04 e5 8f 1b 33 e3 19 0d 46 fe c2 85 ef 44 07

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":




Thomson                 Expires December 31, 2018               [Page 4]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  f1 2d ac 08 95 5c 21 47 7a b1 14 8e eb 35 30 50
         2f d4 a0 6b 49 2d e5 77 5b 27 b6 cb a8 01 21 46

      secret (32 octets):  92 6a 05 98 d4 56 21 b5 ce 65 0e a2 4e a6 45
         ee 1e d8 e6 96 24 23 9c c6 96 8b 2e cd 50 8b 03 7f

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  92 6a 05 98 d4 56 21 b5 ce 65 0e a2 4e a6 45 ee
         1e d8 e6 96 24 23 9c c6 96 8b 2e cd 50 8b 03 7f

      hash (32 octets):  21 18 89 f3 91 d4 3b 68 0f f8 ef 1c 11 cf d7 ad
         2c 99 d6 97 c7 ac 51 7d aa 06 9a 9d 97 39 ee 81

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 21 18 89 f3 91 d4 3b 68 0f f8 ef 1c 11 cf d7
         ad 2c 99 d6 97 c7 ac 51 7d aa 06 9a 9d 97 39 ee 81

      output (32 octets):  0e 2f 06 9a 3a 94 21 96 3b 62 3e a4 c7 7c 60
         bb 25 f8 7e 8f 67 a5 65 79 24 27 30 48 8d 51 64 d8

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  92 6a 05 98 d4 56 21 b5 ce 65 0e a2 4e a6 45 ee
         1e d8 e6 96 24 23 9c c6 96 8b 2e cd 50 8b 03 7f

      hash (32 octets):  21 18 89 f3 91 d4 3b 68 0f f8 ef 1c 11 cf d7 ad
         2c 99 d6 97 c7 ac 51 7d aa 06 9a 9d 97 39 ee 81





Thomson                 Expires December 31, 2018               [Page 5]

Internet-Draft               TLS 1.3 Traces                    June 2018


      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 21 18 89 f3 91 d4 3b 68 0f f8 ef 1c 11 cf d7
         ad 2c 99 d6 97 c7 ac 51 7d aa 06 9a 9d 97 39 ee 81

      output (32 octets):  c8 1e a6 7e 1c 72 3d c2 da a2 16 12 c2 6d 74
         9a aa 9d 86 8a 0c 95 d8 80 a1 0a 49 13 79 fd 5e 34

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  92 6a 05 98 d4 56 21 b5 ce 65 0e a2 4e a6 45 ee
         1e d8 e6 96 24 23 9c c6 96 8b 2e cd 50 8b 03 7f

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  e8 25 a9 bf 8c 1d 9d 67 02 87 a2 bf 7a 89 61
         69 48 de c1 c6 01 b3 e4 f0 01 e5 64 d4 0c e2 5d 56

   {server}  extract secret "master":

      salt (32 octets):  e8 25 a9 bf 8c 1d 9d 67 02 87 a2 bf 7a 89 61 69
         48 de c1 c6 01 b3 e4 f0 01 e5 64 d4 0c e2 5d 56

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  49 55 7f f6 89 a0 b1 bb 1c a5 9b a6 25 f7 5b
         cb 78 19 42 05 e4 e5 c2 4d 0b ea 18 89 fd ea 71 07

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 e7 fc 14 c8 06 1c e2 a2 f6
         d1 09 73 58 31 83 1d 2c 02 26 c9 af 7e 2c be 6b 9d d8 b6 fb 4e
         fa 75 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 10 69 5a f6 6d
         d7 01 79 bd 13 9e f7 f7 bb b8 ad 0c 04 e5 8f 1b 33 e3 19 0d 46
         fe c2 85 ef 44 07 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 e7 fc 14
         c8 06 1c e2 a2 f6 d1 09 73 58 31 83 1d 2c 02 26 c9 af 7e 2c be
         6b 9d d8 b6 fb 4e fa 75 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 10 69 5a f6 6d d7 01 79 bd 13 9e f7 f7 bb b8 ad 0c 04 e5 8f
         1b 33 e3 19 0d 46 fe c2 85 ef 44 07 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:



Thomson                 Expires December 31, 2018               [Page 6]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  c8 1e a6 7e 1c 72 3d c2 da a2 16 12 c2 6d 74 9a
         aa 9d 86 8a 0c 95 d8 80 a1 0a 49 13 79 fd 5e 34

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  6b 43 1b 59 84 fb 18 64 95 ee 9f 18 b2 cd
         8b 53

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  a2 71 ee 05 c5 eb 4b 4e c7 47 53 27

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  c8 1e a6 7e 1c 72 3d c2 da a2 16 12 c2 6d 74 9a
         aa 9d 86 8a 0c 95 d8 80 a1 0a 49 13 79 fd 5e 34

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  c9 a6 8e 32 24 e9 61 9e ff c5 81 b3 2f 28 22
         be 41 3f 8a 7f 12 4b 20 22 47 57 d0 73 76 e2 49 e0

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (657 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30
         82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d
         01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36
         30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04
         03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01
         01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30
         3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a
         24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e
         aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01
         8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53



Thomson                 Expires December 31, 2018               [Page 7]

Internet-Draft               TLS 1.3 Traces                    June 2018


         0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab
         9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01
         a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d
         0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05
         00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17
         06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5
         8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72
         60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63
         a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84
         e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29
         ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 a0 13 00 5d
         d8 ce 88 f1 56 13 7d 2e b6 bd e6 d2 49 0a d2 6c 3b f1 56 71 d4
         f6 26 93 e3 d0 ea f9 36 1a 3b 24 67 f3 45 6a 77 9d 41 d5 91 19
         ba 21 ae 26 6e 41 c4 67 97 15 7d 3a 9c 02 49 4c bb a5 d0 0a 1d
         81 89 c0 85 b9 6a f5 a2 20 49 6c 22 ec d3 3b 48 5b c6 c8 51 32
         36 a8 e2 91 e4 1a e2 3d 17 d8 8c fc 1e 44 4e ce 6e 08 75 ba 40
         92 a3 8e 63 05 a7 05 8b f0 08 d3 d3 e9 e3 b1 f6 f9 8d 38 14 00
         00 20 58 b9 8d ea d4 bb e5 d0 8b 5a 4a 6f 48 31 ee 4d 44 eb e2
         27 dc a1 2e fc d2 92 79 25 a8 11 89 a8

      ciphertext (679 octets):  17 03 03 02 a2 f6 ac 71 21 65 6e 24 30
         e6 9e 85 18 17 c5 63 94 03 39 e1 6c 1c c0 78 af 7a 40 d2 f1 90
         81 c9 0c 68 da 36 27 f4 a4 f3 cc e7 fd 1d f0 e0 c2 14 12 2f 20
         15 25 a8 32 05 4c 7b 20 1a 00 7e 2d 5e e1 c5 40 1a ed 69 8c 10
         2b d5 43 49 b4 1f 67 dc ce fe 9d 1b 1f b9 38 20 49 9b ea 31 79
         00 d7 80 94 08 97 f1 6e 77 e2 29 17 83 8e 21 ce 22 51 80 c2 91
         18 99 aa f4 39 67 84 38 e2 c4 b4 63 2b 32 8f 68 0b ec e4 8c 39
         43 5b 66 18 04 58 16 57 7f 07 ee 06 1d 57 68 2d 9c 02 1a 20 eb
         8f 8b 2b 94 e8 9a 19 15 05 59 8a 30 8b aa cd da 70 ca 1e 38 ce
         e2 2f b2 1e 14 14 13 8f 32 35 8e 8a 73 be ac a4 58 a0 fc b1 c0
         25 90 be 17 a9 a6 d4 b5 b8 5e c3 fb e4 91 0e 3e ed 96 9f 72 d0
         e2 bf 79 5f 23 70 59 49 60 5a 71 e4 2f 9a e9 1f 20 f5 91 78 65
         dc 10 11 9f 7e 1e 2f 36 89 c2 b2 45 61 a4 58 52 6f a7 2c 46 25
         a8 97 3d d1 37 c1 61 47 c2 e0 96 50 8e 6e db 4b f9 91 03 e4 b5
         5c 64 be 2f fe e0 89 7f e6 50 ad d3 f4 04 98 e5 83 25 46 89 b1
         24 ad 68 98 4c e1 33 3d dd 11 3e 18 b1 59 8c 17 71 49 ee 58 4e
         ba 02 f0 ab ee 6b 25 0d 2a 58 23 e6 54 da 2b ae 67 61 af 34 a5
         de 33 cc 85 7c af da 78 c7 cc 2b f8 d1 2a 15 b6 21 c8 19 8e 0f
         7e ce 12 59 fe f6 01 48 07 78 8f 7d 30 d9 aa 7c b0 76 ca 63 5f
         1b 82 87 bc db 23 a0 48 89 11 eb 7e 70 50 64 84 26 97 7b 95 7a
         5f e3 23 ed 1c 61 de 70 f6 85 4c 3a 6f ce dd a0 3d 53 a5 08 58
         00 45 69 86 eb 08 67 e9 b0 5e 06 dd 9c 05 7a bf 4b 63 33 ec 3f
         cc 27 91 8d e3 14 1a 32 9f 02 58 b0 53 aa 37 92 df c8 14 20 f1
         27 61 22 f3 fa 32 01 41 e5 ec 5a c0 9b c4 ff 5a 87 91 f0 54 bf
         e5 5c e7 4b 12 5a 3e ad 34 3c cf 19 ac 47 22 b8 7d a3 cd 09 19
         28 31 30 df ef 91 9e 4e e3 69 4d 42 1b 73 70 f8 a5 89 c4 b7 c2
         6b 09 cc a7 5d 8c 8f cd c1 f3 96 9d b1 41 1b 07 b8 c8 1d f3 c6
         83 8b 1b 07 b1 ae fc b9 c7 0c 4f 6d 48 1d 03 ee a5 de 44 f5 07



Thomson                 Expires December 31, 2018               [Page 8]

Internet-Draft               TLS 1.3 Traces                    June 2018


         6c bd 11 c1 6d fc 11 44 9f b4 db 54 23 f2 c8 2f 32 09 80 1a bf
         97 6b 48 38 0e 0d 80 63 50 b7 f2 7b 2a 6a df 00 5d 74 f3 c0 4f
         91 20 d9 74 73 7d 9c 35 33 63 52 4f ac df c9 17 9b 9e 1a 4f 86
         fe b6 92 d5 20 70 f1 32 57 cb 85 1e c8 46 f0 49 82 d8 a2 7a e9
         be f7 7e 1e cf e5 db be b7 fe b9 2e 8f 2f 65

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  49 55 7f f6 89 a0 b1 bb 1c a5 9b a6 25 f7 5b cb
         78 19 42 05 e4 e5 c2 4d 0b ea 18 89 fd ea 71 07

      hash (32 octets):  56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92 ed
         a6 0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92
         ed a6 0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d

      output (32 octets):  16 9e 5f bd 45 5f 38 0b ad 7a ef ae 82 ff f9
         f3 01 e0 23 df 03 84 52 5b 9e 7e ab f9 94 a5 63 4a

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  49 55 7f f6 89 a0 b1 bb 1c a5 9b a6 25 f7 5b cb
         78 19 42 05 e4 e5 c2 4d 0b ea 18 89 fd ea 71 07

      hash (32 octets):  56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92 ed
         a6 0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92
         ed a6 0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d

      output (32 octets):  60 c5 be 9a 0f 9a ad 9d df c8 10 bf 37 80 82
         53 4b 3c 7c 34 0d 35 5e 2d 67 56 2b 36 2f a0 f3 23

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  49 55 7f f6 89 a0 b1 bb 1c a5 9b a6 25 f7 5b cb
         78 19 42 05 e4 e5 c2 4d 0b ea 18 89 fd ea 71 07

      hash (32 octets):  56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92 ed
         a6 0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 56 49 c9 51 df 38 48 db 40 49 89 e3 42 34 92 ed a6
         0a f0 bb 65 1a d1 12 5f 12 e3 19 a3 c3 59 8d




Thomson                 Expires December 31, 2018               [Page 9]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  88 19 2d 34 9d fd 7f 3c 43 51 97 1d a8 e1 34
         13 16 78 69 ac a5 61 ea 80 e0 73 43 4a 1a 97 ee a3

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  60 c5 be 9a 0f 9a ad 9d df c8 10 bf 37 80 82 53
         4b 3c 7c 34 0d 35 5e 2d 67 56 2b 36 2f a0 f3 23

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  56 10 4a 45 32 73 2d 2e f7 af 07 9b 56 3d
         e2 4d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  31 59 f6 41 f8 3e 8e ae d8 d7 d2 ab

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  0e 2f 06 9a 3a 94 21 96 3b 62 3e a4 c7 7c 60 bb
         25 f8 7e 8f 67 a5 65 79 24 27 30 48 8d 51 64 d8

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b5 54 f8 b7 08 60 4f 92 19 b8 7f 83 ef be
         02 d5

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  7c fc 9e c0 55 de be d2 3a db 55 e7

   {client}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55



Thomson                 Expires December 31, 2018              [Page 10]

Internet-Draft               TLS 1.3 Traces                    June 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  f1 2d ac 08 95 5c 21 47 7a b1 14 8e eb 35 30 50
         2f d4 a0 6b 49 2d e5 77 5b 27 b6 cb a8 01 21 46

      secret (32 octets):  92 6a 05 98 d4 56 21 b5 ce 65 0e a2 4e a6 45
         ee 1e d8 e6 96 24 23 9c c6 96 8b 2e cd 50 8b 03 7f

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  c8 1e a6 7e 1c 72 3d c2 da a2 16 12 c2 6d 74 9a
         aa 9d 86 8a 0c 95 d8 80 a1 0a 49 13 79 fd 5e 34

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  6b 43 1b 59 84 fb 18 64 95 ee 9f 18 b2 cd
         8b 53

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  a2 71 ee 05 c5 eb 4b 4e c7 47 53 27

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires December 31, 2018              [Page 11]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  0e 2f 06 9a 3a 94 21 96 3b 62 3e a4 c7 7c 60 bb
         25 f8 7e 8f 67 a5 65 79 24 27 30 48 8d 51 64 d8

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  7d 23 a3 fa 8f 6d a0 3a c3 9e c9 11 bb ed 78
         48 75 6d 8d f8 e4 18 94 58 2f b7 09 cf 25 f8 7b 6f

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 48 0a 9f 69 8a cb 6e c8 3e 9e 29
         d3 ce 67 49 c9 bc da 64 9a d9 c4 ad e2 a8 4d af 1a 62 d2 5d 27

      ciphertext (58 octets):  17 03 03 00 35 62 b5 b6 6b 11 29 81 0b e3
         ac f1 c7 1e 54 2a ea e8 cc 3c f0 7c 6a 98 c3 54 a0 2e 80 a7 6d
         57 cc 29 93 e1 31 b7 da b0 fe 24 aa 27 98 15 7b 1c 6e 3d e8 10
         52 34

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  16 9e 5f bd 45 5f 38 0b ad 7a ef ae 82 ff f9 f3
         01 e0 23 df 03 84 52 5b 9e 7e ab f9 94 a5 63 4a

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  79 98 a9 3a 9b b0 b3 ac 24 24 02 47 84 d6
         77 c7

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c5 52 c6 0f 3f ba ae f2 9b ed 02 c1

   {client}  derive secret "tls13 res master":





Thomson                 Expires December 31, 2018              [Page 12]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  49 55 7f f6 89 a0 b1 bb 1c a5 9b a6 25 f7 5b cb
         78 19 42 05 e4 e5 c2 4d 0b ea 18 89 fd ea 71 07

      hash (32 octets):  d8 f1 74 91 bd b6 d2 67 22 98 4f 89 9e 36 f1 19
         9f 6c e3 99 98 6b 4c fc 37 fb 8d 21 19 69 4e 7b

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 d8 f1 74 91 bd b6 d2 67 22 98 4f 89 9e 36 f1 19 9f
         6c e3 99 98 6b 4c fc 37 fb 8d 21 19 69 4e 7b

      output (32 octets):  76 87 8c ff 98 83 ec 4f e5 7a 55 55 36 77 c0
         c4 cf 29 be 74 b3 9d 09 2a f5 26 a6 9f 3a 18 2b fc

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {server}  generate resumption secret "tls13 resumption":

      PRK (32 octets):  76 87 8c ff 98 83 ec 4f e5 7a 55 55 36 77 c0 c4
         cf 29 be 74 b3 9d 09 2a f5 26 a6 9f 3a 18 2b fc

      hash (2 octets):  00 00

      info (22 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 75 6d 70 74
         69 6f 6e 02 00 00

      output (32 octets):  53 0e ce 77 e5 27 2d 1d 6b d3 e1 a4 a8 98 81
         2a 2a 34 15 ea 0c 06 04 b3 a1 31 cd 25 61 94 cd 93

   {server}  send a NewSessionTicket handshake message

   {server}  send handshake record:

      payload (205 octets):  04 00 00 c9 00 00 00 1e 6f 6b 62 50 02 00
         00 00 b2 c7 8d 3e c7 6f 2f 7a 2e b9 02 36 e9 00 00 00 00 a8 90
         20 42 39 6a 98 e4 0c 65 24 e1 ce 60 00 ea 00 70 79 89 d0 97 74
         d5 90 ef 6f 62 a3 e6 7e 3c a1 c8 cc 00 1b 05 f7 f5 60 1f b4 5f
         ba 91 4c a3 01 d0 d1 75 97 3e 93 f5 57 72 0d df 38 bc ca d9 e9
         bd 82 45 36 f1 52 46 b0 b0 53 fc c8 dd 3c cb 0c 52 79 38 96 33
         34 c2 cc 40 30 4a ab bc d9 08 41 d0 1c 5f 10 0a 86 2f 19 a1 c8
         72 76 ab 11 d4 60 68 a4 e3 91 13 ef 58 ed 42 91 7d b3 eb 1f dd
         6a af c6 57 f1 4f 39 b6 32 a5 ec 07 ab 26 a1 73 70 cb 33 6b 41
         a2 36 00 36 8c 74 59 93 94 29 dc 8a 04 00 08 00 2a 00 04 00 00
         04 00



Thomson                 Expires December 31, 2018              [Page 13]

Internet-Draft               TLS 1.3 Traces                    June 2018


      ciphertext (227 octets):  17 03 03 00 de e1 7d b7 60 4a 6a e1 c4
         80 c7 75 7d f4 89 18 9a 84 2a 76 6e 8f ae 31 96 e6 7c 67 fa 6a
         16 bf 30 1f fd fe 97 48 22 22 91 22 ef 35 94 4b 6c 2d ee fb 48
         43 48 c0 6e 19 e1 01 e7 1d 4e ed 42 69 84 2a d3 a0 cd 56 d8 84
         0a 13 ff e4 07 62 6d 92 60 96 6c 2c 1b 43 e0 93 4a e4 34 1e d1
         7c 2e 55 60 5d 0c 4d 43 fe 31 14 be a2 d2 f0 67 44 06 b6 ed 87
         24 e2 4d d6 35 8a 5b 76 ac d5 d4 8c 05 3a 46 dd c5 93 9c 10 5b
         23 b1 74 ad ba fb f9 c0 fd 5b c3 a1 84 b7 84 4b 93 75 4f 58 bf
         a3 03 46 89 f0 0e f6 78 ad fb 89 d4 62 70 e9 61 94 bc d3 6f 4c
         75 ac 89 b5 15 31 a9 bb 1b 15 e5 3d 0c 09 d6 c8 9f c1 d9 4b 9d
         a6 b6 c2 f2 30 12 74 3f fd 1a 3e 8f e7 9c 5f 91 d2 48 ab a8 9a
         d9 f3 ba c3

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 fc e3 2c 71 51 45 a6 51 34
         dd 66 2f e3 d4 1b 65 b0 8c 1b 4f c6 fa 41 8d 75 8a 48 50 4d 5b
         73 fc 79 aa 4f 2d 62 e8 42 53 60 86 bc bb 0a 2b 54 8a e3 3a 0e
         02 9d 39 15 a6 06 bd fb 98 7c 42 7e 13 26 7a a0

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 9e c9 a4 5e 14 b1 30 c4 5c
         fc b6 bd a8 41 68 25 9d c3 3d 87 f4 b7 34 b6 30 38 e0 53 e9 44
         6f a8 93 b4 fe d7 5e e9 30 42 df 42 5d 9e c6 f7 16 30 08 93 d5
         3b 0b 8b 4e 1c cb cd cf 1c fa 66 26 a2 43 e4 51

   {client}  generate resumption secret "tls13 resumption" (same as
      server)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 59 a9 65 9b 5c 8d 90 c3 45
         29 65 a6 6a 88 60 cf 04 b7 0e

   {server}  send alert record:

      payload (2 octets):  01 00



Thomson                 Expires December 31, 2018              [Page 14]

Internet-Draft               TLS 1.3 Traces                    June 2018


      ciphertext (24 octets):  17 03 03 00 13 69 9f 7c 06 aa 50 c8 61 20
         8c 78 f9 03 57 22 f0 2e b2 df

4.  Resumed 0-RTT Handshake

   This handshake resumes from the handshake in Section 3.  Since the
   server provided a session ticket that permitted 0-RTT, and the client
   is configured for 0-RTT, the client is able to send 0-RTT data.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  ed 9e 59 32 e2 dd 3b 0c 96 a0 45 8f 2d
         d1 95 f8 0f f7 f6 6a 7a de ea e6 82 49 ef 2e a0 f5 af fc

      public key (32 octets):  be b4 bc 28 ab 32 9d 45 f0 7c a5 5e 65 ac
         e1 ed db 31 48 59 f9 38 d8 f3 c8 81 51 00 e5 c6 a7 57

   {client}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  53 0e ce 77 e5 27 2d 1d 6b d3 e1 a4 a8 98 81 2a
         2a 34 15 ea 0c 06 04 b3 a1 31 cd 25 61 94 cd 93

      secret (32 octets):  59 49 4e cc 24 ad a2 f6 2b aa 8f 68 23 eb 82
         bc e6 74 33 6a a6 a2 2d 96 a4 80 9b 4a d7 aa 12 21

   {client}  send a ClientHello handshake message

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  c7 0e 25 5d 61 14 2c 94 ca 29 89 02 86 bb 3a da
         b4 cf 47 00 33 fe 89 73 2f 63 4f 5f 88 6c 05 11

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  58 f1 a0 71 9a f4 9d e9 97 6a fc 75 c2 e3 1e
         75 ba 33 5e 33 03 eb b1 c9 ff e9 65 2d cd 7b 17 5a

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 78 14 aa 00 1b 81 f3 5f
         40 45 c1 a1 dc 51 7b 96 0d 11 c3 51 0c 16 96 8e 7a 7a d3 ed e0
         40 bc 22 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12



Thomson                 Expires December 31, 2018              [Page 15]

Internet-Draft               TLS 1.3 Traces                    June 2018


         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 be b4 bc 28 ab 32 9d 45 f0 7c a5 5e 65 ac
         e1 ed db 31 48 59 f9 38 d8 f3 c8 81 51 00 e5 c6 a7 57 00 2a 00
         00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 1c 00 02 40 01 00 15 00 57 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 29 00 dd 00 b8 00 b2 c7 8d 3e c7 6f 2f 7a 2e b9 02 36 e9 00
         00 00 00 a8 90 20 42 39 6a 98 e4 0c 65 24 e1 ce 60 00 ea 00 70
         79 89 d0 97 74 d5 90 ef 6f 62 a3 e6 7e 3c a1 c8 cc 00 1b 05 f7
         f5 60 1f b4 5f ba 91 4c a3 01 d0 d1 75 97 3e 93 f5 57 72 0d df
         38 bc ca d9 e9 bd 82 45 36 f1 52 46 b0 b0 53 fc c8 dd 3c cb 0c
         52 79 38 96 33 34 c2 cc 40 30 4a ab bc d9 08 41 d0 1c 5f 10 0a
         86 2f 19 a1 c8 72 76 ab 11 d4 60 68 a4 e3 91 13 ef 58 ed 42 91
         7d b3 eb 1f dd 6a af c6 57 f1 4f 39 b6 32 a5 ec 07 ab 26 a1 73
         70 cb 33 6b 41 a2 36 00 36 8c 74 59 93 94 29 dc 8a 04 6f 6b 62
         57 00 21 20 a0 f3 e8 ba 33 16 3a 60 e3 1f b4 a5 4b 97 b6 ab b9
         18 8c 79 8f af 4a c5 f0 5a 31 11 14 d4 fd 31

      ciphertext (517 octets):  16 03 01 02 00 01 00 01 fc 03 03 78 14
         aa 00 1b 81 f3 5f 40 45 c1 a1 dc 51 7b 96 0d 11 c3 51 0c 16 96
         8e 7a 7a d3 ed e0 40 bc 22 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 be b4 bc 28 ab 32 9d 45
         f0 7c a5 5e 65 ac e1 ed db 31 48 59 f9 38 d8 f3 c8 81 51 00 e5
         c6 a7 57 00 2a 00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01 00
         15 00 57 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 29 00 dd 00 b8 00 b2 c7 8d 3e c7 6f 2f 7a
         2e b9 02 36 e9 00 00 00 00 a8 90 20 42 39 6a 98 e4 0c 65 24 e1
         ce 60 00 ea 00 70 79 89 d0 97 74 d5 90 ef 6f 62 a3 e6 7e 3c a1
         c8 cc 00 1b 05 f7 f5 60 1f b4 5f ba 91 4c a3 01 d0 d1 75 97 3e
         93 f5 57 72 0d df 38 bc ca d9 e9 bd 82 45 36 f1 52 46 b0 b0 53
         fc c8 dd 3c cb 0c 52 79 38 96 33 34 c2 cc 40 30 4a ab bc d9 08
         41 d0 1c 5f 10 0a 86 2f 19 a1 c8 72 76 ab 11 d4 60 68 a4 e3 91
         13 ef 58 ed 42 91 7d b3 eb 1f dd 6a af c6 57 f1 4f 39 b6 32 a5
         ec 07 ab 26 a1 73 70 cb 33 6b 41 a2 36 00 36 8c 74 59 93 94 29
         dc 8a 04 6f 6b 62 57 00 21 20 a0 f3 e8 ba 33 16 3a 60 e3 1f b4
         a5 4b 97 b6 ab b9 18 8c 79 8f af 4a c5 f0 5a 31 11 14 d4 fd 31




Thomson                 Expires December 31, 2018              [Page 16]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  derive secret "tls13 c e traffic":

      PRK (32 octets):  59 49 4e cc 24 ad a2 f6 2b aa 8f 68 23 eb 82 bc
         e6 74 33 6a a6 a2 2d 96 a4 80 9b 4a d7 aa 12 21

      hash (32 octets):  31 09 80 21 c1 a7 dd 64 49 07 8c 0f 6f a0 c9 eb
         1f 88 c2 f1 74 91 66 f4 c1 b6 af 12 9c 3d 11 c1

      info (53 octets):  00 20 11 74 6c 73 31 33 20 63 20 65 20 74 72 61
         66 66 69 63 20 31 09 80 21 c1 a7 dd 64 49 07 8c 0f 6f a0 c9 eb
         1f 88 c2 f1 74 91 66 f4 c1 b6 af 12 9c 3d 11 c1

      output (32 octets):  4c 0b eb c8 76 70 6d 06 46 be ec ce 3f 1a 6e
         eb db 4c de f1 27 ac 1e 32 bd 1a f8 0c 33 20 06 d5

   {client}  derive secret "tls13 e exp master":

      PRK (32 octets):  59 49 4e cc 24 ad a2 f6 2b aa 8f 68 23 eb 82 bc
         e6 74 33 6a a6 a2 2d 96 a4 80 9b 4a d7 aa 12 21

      hash (32 octets):  31 09 80 21 c1 a7 dd 64 49 07 8c 0f 6f a0 c9 eb
         1f 88 c2 f1 74 91 66 f4 c1 b6 af 12 9c 3d 11 c1

      info (54 octets):  00 20 12 74 6c 73 31 33 20 65 20 65 78 70 20 6d
         61 73 74 65 72 20 31 09 80 21 c1 a7 dd 64 49 07 8c 0f 6f a0 c9
         eb 1f 88 c2 f1 74 91 66 f4 c1 b6 af 12 9c 3d 11 c1

      output (32 octets):  41 b9 26 f3 45 7c 1c c4 89 d4 bd a2 06 83 aa
         42 57 c6 ea 2d 29 3a 8d cd bf 7d e0 a3 df f0 5d 82

   {client}  derive write traffic keys for early application data:

      PRK (32 octets):  4c 0b eb c8 76 70 6d 06 46 be ec ce 3f 1a 6e eb
         db 4c de f1 27 ac 1e 32 bd 1a f8 0c 33 20 06 d5

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  20 ac fd b2 33 e4 ff 86 f4 86 f9 ab c3 d9
         f0 37

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  90 6b 06 2b 2d 5c ba fd fb 6c df 00

   {client}  send application_data record:

      payload (6 octets):  41 42 43 44 45 46




Thomson                 Expires December 31, 2018              [Page 17]

Internet-Draft               TLS 1.3 Traces                    June 2018


      ciphertext (28 octets):  17 03 03 00 17 e3 47 2f 9f 37 fe f1 89 c8
         ed 98 cf 88 c0 22 3a ec d0 98 00 92 00 25

   {server}  extract secret "early" (same as client)

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  2e bb d4 8b 79 ed 89 18 82 4b 06 da 78
         64 9a 46 72 20 61 e9 62 a4 5b ee 26 27 eb b7 8e 49 a4 79

      public key (32 octets):  20 5d 29 34 9f af 70 03 f4 8d 34 73 ab 74
         78 70 7c 26 52 44 ae 8c 31 d1 46 5a b3 50 5f 8f 43 7e

   {server}  derive secret "tls13 c e traffic" (same as client)

   {server}  derive secret "tls13 e exp master" (same as client)

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  59 49 4e cc 24 ad a2 f6 2b aa 8f 68 23 eb 82 bc
         e6 74 33 6a a6 a2 2d 96 a4 80 9b 4a d7 aa 12 21

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6e e3 92 8c 63 94 0b 65 63 ba 4a 61 b6 95 e5
         c5 c2 36 43 aa 5c ff 67 2e 39 de 5f 35 43 24 8e 2e

   {server}  extract secret "handshake":

      salt (32 octets):  6e e3 92 8c 63 94 0b 65 63 ba 4a 61 b6 95 e5 c5
         c2 36 43 aa 5c ff 67 2e 39 de 5f 35 43 24 8e 2e

      IKM (32 octets):  2d d2 15 04 6c 0b 0e 36 04 64 59 e1 0b c2 4d 6f
         38 6b b8 01 24 b9 25 28 99 9d ce 5c 4f 8f 64 56

      secret (32 octets):  85 6a 8d ec 39 c3 18 2a 72 3d 0e d6 63 c7 9d
         41 5c 50 89 a5 1c ae fd 58 62 d0 5d c6 db 6c d7 c3

   {server}  derive secret "tls13 c hs traffic":



Thomson                 Expires December 31, 2018              [Page 18]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  85 6a 8d ec 39 c3 18 2a 72 3d 0e d6 63 c7 9d 41
         5c 50 89 a5 1c ae fd 58 62 d0 5d c6 db 6c d7 c3

      hash (32 octets):  88 dc 6a 6a 5e 6b bc 2c c2 17 01 5b c2 90 ab 38
         b8 3d e8 6a 6b 95 36 35 1a 53 33 8e e7 ef e1 7e

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 88 dc 6a 6a 5e 6b bc 2c c2 17 01 5b c2 90 ab
         38 b8 3d e8 6a 6b 95 36 35 1a 53 33 8e e7 ef e1 7e

      output (32 octets):  0a 51 f4 64 e7 c7 b2 42 60 6c 44 9b e3 1c ce
         1c 91 97 b5 98 43 33 a8 4e 43 25 a8 bb e8 18 09 5f

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  85 6a 8d ec 39 c3 18 2a 72 3d 0e d6 63 c7 9d 41
         5c 50 89 a5 1c ae fd 58 62 d0 5d c6 db 6c d7 c3

      hash (32 octets):  88 dc 6a 6a 5e 6b bc 2c c2 17 01 5b c2 90 ab 38
         b8 3d e8 6a 6b 95 36 35 1a 53 33 8e e7 ef e1 7e

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 88 dc 6a 6a 5e 6b bc 2c c2 17 01 5b c2 90 ab
         38 b8 3d e8 6a 6b 95 36 35 1a 53 33 8e e7 ef e1 7e

      output (32 octets):  d5 44 46 7b 9a ac 97 2f b9 44 62 1e c5 38 e9
         54 ab c1 ab de 84 f4 6b 0a 77 6b ce bd 66 de 31 bb

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  85 6a 8d ec 39 c3 18 2a 72 3d 0e d6 63 c7 9d 41
         5c 50 89 a5 1c ae fd 58 62 d0 5d c6 db 6c d7 c3

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  42 be ec 4e 79 e4 f7 d9 c4 30 08 71 de 8f 90
         13 f6 5d dc 9b 2e f2 53 ef 57 85 a3 df 65 b0 86 28

   {server}  extract secret "master":

      salt (32 octets):  42 be ec 4e 79 e4 f7 d9 c4 30 08 71 de 8f 90 13
         f6 5d dc 9b 2e f2 53 ef 57 85 a3 df 65 b0 86 28




Thomson                 Expires December 31, 2018              [Page 19]

Internet-Draft               TLS 1.3 Traces                    June 2018


      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  9b be 51 c5 1e 39 c5 d6 c4 95 57 63 cc df eb
         55 0c 4d 26 1a f1 36 dd 56 89 b3 04 9e 05 b1 46 ac

   {server}  send handshake record:

      payload (96 octets):  02 00 00 5c 03 03 42 39 00 bd 0a 3c 1d 67 5e
         09 8c 98 1a 86 ef 76 97 2d ad d4 bd 76 30 6b a1 48 81 1c 1a d8
         d5 d7 00 13 01 00 00 34 00 29 00 02 00 00 00 33 00 24 00 1d 00
         20 20 5d 29 34 9f af 70 03 f4 8d 34 73 ab 74 78 70 7c 26 52 44
         ae 8c 31 d1 46 5a b3 50 5f 8f 43 7e 00 2b 00 02 7f 1c

      ciphertext (101 octets):  16 03 03 00 60 02 00 00 5c 03 03 42 39
         00 bd 0a 3c 1d 67 5e 09 8c 98 1a 86 ef 76 97 2d ad d4 bd 76 30
         6b a1 48 81 1c 1a d8 d5 d7 00 13 01 00 00 34 00 29 00 02 00 00
         00 33 00 24 00 1d 00 20 20 5d 29 34 9f af 70 03 f4 8d 34 73 ab
         74 78 70 7c 26 52 44 ae 8c 31 d1 46 5a b3 50 5f 8f 43 7e 00 2b
         00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  d5 44 46 7b 9a ac 97 2f b9 44 62 1e c5 38 e9 54
         ab c1 ab de 84 f4 6b 0a 77 6b ce bd 66 de 31 bb

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  04 79 b5 dd 79 e6 13 96 d3 93 72 b5 36 26
         a2 1e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  91 f6 66 8d e7 b0 82 67 94 cc 39 45

   {server}  send a EncryptedExtensions handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  d5 44 46 7b 9a ac 97 2f b9 44 62 1e c5 38 e9 54
         ab c1 ab de 84 f4 6b 0a 77 6b ce bd 66 de 31 bb

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00





Thomson                 Expires December 31, 2018              [Page 20]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  95 0c d6 bc 38 6a 71 39 5c b9 e5 f0 39 64 1d
         97 ab bf 52 d9 44 36 32 87 de 35 d5 02 bc 9f c0 dd

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (80 octets):  08 00 00 28 00 26 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40 01
         00 00 00 00 00 2a 00 00 14 00 00 20 30 02 1e b0 20 7e e2 39 b5
         6c 6f f7 be ee 38 01 c3 54 54 54 79 cc 2e ff d7 ee 50 eb 0b ee
         5f 1b

      ciphertext (102 octets):  17 03 03 00 61 e6 3f 33 b6 8b cd 95 42
         b2 28 46 43 0b 9e ae c7 86 de ef f1 aa de a6 e1 8a 43 8f ed 2f
         24 5d 5c 98 8e a0 0c 2b 42 37 99 1a 01 d8 1e d5 24 9d 65 e2 92
         3a 7b e6 7c 07 51 28 2e 4d 73 f6 43 72 ac 06 c7 e0 77 52 59 89
         1b 1a 15 a4 54 cf dc 59 be eb 1a 26 3e 98 5f b3 5d 3d e1 8c 30
         99 90 4e 5b 63

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  9b be 51 c5 1e 39 c5 d6 c4 95 57 63 cc df eb 55
         0c 4d 26 1a f1 36 dd 56 89 b3 04 9e 05 b1 46 ac

      hash (32 octets):  b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca 25
         c3 37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca
         25 c3 37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5

      output (32 octets):  ce bf c9 91 73 b8 cb a3 fd 12 d5 9b 20 c9 06
         a1 58 1c 0c 79 c2 0c 05 cc 42 3f 0f 92 c0 83 5a d6

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  9b be 51 c5 1e 39 c5 d6 c4 95 57 63 cc df eb 55
         0c 4d 26 1a f1 36 dd 56 89 b3 04 9e 05 b1 46 ac

      hash (32 octets):  b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca 25
         c3 37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca
         25 c3 37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5





Thomson                 Expires December 31, 2018              [Page 21]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  e2 27 31 f8 ce 89 bf b4 14 ed 0d 4c f9 fc fe
         07 a6 5d 77 d0 e8 4a 61 75 6d b7 74 1c 71 e6 d6 b1

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  9b be 51 c5 1e 39 c5 d6 c4 95 57 63 cc df eb 55
         0c 4d 26 1a f1 36 dd 56 89 b3 04 9e 05 b1 46 ac

      hash (32 octets):  b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca 25
         c3 37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 b4 cd 57 25 8a 27 50 e0 77 20 7a 52 f5 ec ca 25 c3
         37 01 24 3f 43 da d9 85 af fb 2c d8 3e 87 b5

      output (32 octets):  55 43 89 2c d3 3c 7c 9e 1b e5 86 06 b8 ba fb
         c6 a6 61 88 6c b4 83 cc de 1e 58 45 f2 df 03 86 e6

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  e2 27 31 f8 ce 89 bf b4 14 ed 0d 4c f9 fc fe 07
         a6 5d 77 d0 e8 4a 61 75 6d b7 74 1c 71 e6 d6 b1

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  5f 2e e9 70 f7 aa db 80 79 d4 dd 31 2a d2
         50 84

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9d 76 cb 64 3b b9 6f 48 95 70 24 7f

   {server}  derive read traffic keys for early application data (same
      as client write traffic keys)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  59 49 4e cc 24 ad a2 f6 2b aa 8f 68 23 eb 82 bc
         e6 74 33 6a a6 a2 2d 96 a4 80 9b 4a d7 aa 12 21

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55





Thomson                 Expires December 31, 2018              [Page 22]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  6e e3 92 8c 63 94 0b 65 63 ba 4a 61 b6 95 e5
         c5 c2 36 43 aa 5c ff 67 2e 39 de 5f 35 43 24 8e 2e

   {client}  extract secret "handshake":

      salt (32 octets):  6e e3 92 8c 63 94 0b 65 63 ba 4a 61 b6 95 e5 c5
         c2 36 43 aa 5c ff 67 2e 39 de 5f 35 43 24 8e 2e

      IKM (32 octets):  2d d2 15 04 6c 0b 0e 36 04 64 59 e1 0b c2 4d 6f
         38 6b b8 01 24 b9 25 28 99 9d ce 5c 4f 8f 64 56

      secret (32 octets):  85 6a 8d ec 39 c3 18 2a 72 3d 0e d6 63 c7 9d
         41 5c 50 89 a5 1c ae fd 58 62 d0 5d c6 db 6c d7 c3

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  d5 44 46 7b 9a ac 97 2f b9 44 62 1e c5 38 e9 54
         ab c1 ab de 84 f4 6b 0a 77 6b ce bd 66 de 31 bb

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  04 79 b5 dd 79 e6 13 96 d3 93 72 b5 36 26
         a2 1e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  91 f6 66 8d e7 b0 82 67 94 cc 39 45

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send a EndOfEarlyData handshake message

   {client}  send handshake record:




Thomson                 Expires December 31, 2018              [Page 23]

Internet-Draft               TLS 1.3 Traces                    June 2018


      payload (4 octets):  05 00 00 00

      ciphertext (26 octets):  17 03 03 00 15 e7 ea d1 34 ae 28 dc 2f ca
         18 54 78 8c 5e 31 1e 56 b8 c6 f3 b2

   {client}  derive write traffic keys for handshake data:

      PRK (32 octets):  0a 51 f4 64 e7 c7 b2 42 60 6c 44 9b e3 1c ce 1c
         91 97 b5 98 43 33 a8 4e 43 25 a8 bb e8 18 09 5f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  16 20 44 68 d4 b2 54 04 6b c7 ff f5 b2 c9
         42 28

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9a 0c bd f2 8e 47 7e 39 02 a8 4d 2b

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  0a 51 f4 64 e7 c7 b2 42 60 6c 44 9b e3 1c ce 1c
         91 97 b5 98 43 33 a8 4e 43 25 a8 bb e8 18 09 5f

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  99 a5 34 2f 0e 58 61 29 63 4a 59 5e ab b9 7e
         df 15 b2 7b 5b f2 bd e0 44 47 a9 f0 4e 96 c2 69 25

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 af 3d e6 05 ec fd f2 62 03 3e c0
         57 16 2b 93 ce bc e4 18 78 6a 31 61 dd 90 4a af 88 e5 fe f5 50

      ciphertext (58 octets):  17 03 03 00 35 07 d5 7c 07 81 b7 0c 74 99
         0a 20 5c 46 d0 8c 5b cc a7 3d 4d 25 1c ed 59 52 c5 ed 01 84 ab
         95 57 e7 01 9d 6c 57 a9 e3 7e 84 d9 0a 78 37 2d 9a 22 74 28 8f
         dd 17

   {client}  derive write traffic keys for application data:



Thomson                 Expires December 31, 2018              [Page 24]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  ce bf c9 91 73 b8 cb a3 fd 12 d5 9b 20 c9 06 a1
         58 1c 0c 79 c2 0c 05 cc 42 3f 0f 92 c0 83 5a d6

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  2a b7 1a 4d 8a 6e ba 3f e3 c9 d2 a8 30 6d
         09 68

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  af 0b e7 99 8b 7f 35 c7 84 06 e3 4c

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  9b be 51 c5 1e 39 c5 d6 c4 95 57 63 cc df eb 55
         0c 4d 26 1a f1 36 dd 56 89 b3 04 9e 05 b1 46 ac

      hash (32 octets):  24 2c 7b 32 03 df c7 f5 86 cf 17 25 86 16 9d e2
         a2 0f 2a 79 ed cf 95 79 cf 67 35 68 7e 3a 88 54

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 24 2c 7b 32 03 df c7 f5 86 cf 17 25 86 16 9d e2 a2
         0f 2a 79 ed cf 95 79 cf 67 35 68 7e 3a 88 54

      output (32 octets):  f9 78 3c 14 d1 9f b3 fc 42 92 60 15 72 93 55
         b8 74 29 d2 0b 4f ac 0f 82 8e b7 b5 59 b0 f1 87 45

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  0a 51 f4 64 e7 c7 b2 42 60 6c 44 9b e3 1c ce 1c
         91 97 b5 98 43 33 a8 4e 43 25 a8 bb e8 18 09 5f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  16 20 44 68 d4 b2 54 04 6b c7 ff f5 b2 c9
         42 28

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  9a 0c bd f2 8e 47 7e 39 02 a8 4d 2b

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)




Thomson                 Expires December 31, 2018              [Page 25]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 b0 4a ed e8 45 5a b0 be 8f
         c6 2a da a1 d1 2d e3 07 ab a7 27 76 08 78 b6 8c 2c f2 12 f3 ee
         3d 46 0c 3c ad 48 9a 56 7e 3f 7b f4 23 c7 34 2e d5 a9 77 f5 35
         7b 41 4e 58 38 55 ab 51 99 b0 20 93 4c e0 f6 18

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      ciphertext (72 octets):  17 03 03 00 43 82 7a c3 f0 88 75 a6 30 96
         e7 27 05 dd ab 3a 6f 8b 7e f1 e8 6d a3 b2 d0 63 02 ed 67 7b 56
         65 93 bc f9 c6 8f bc d6 51 b3 7d 14 d5 a2 35 eb 35 0e 43 31 c0
         42 07 3e ad cf cb e4 63 f3 30 a5 a7 bb 8b 9a 4c

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 f5 59 e1 1b a0 a1 e1 98 b9
         66 47 4e 72 c9 5a 2f 6b 6f 31

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 94 98 48 f4 25 ae d3 a2 91
         e0 48 07 7f 27 c4 15 ea 0a 10

5.  HelloRetryRequest

   In this example, the client initiates a handshake with an X25519
   [RFC7748] share.  The server however prefers P-256 [FIPS186] and
   sends a HelloRetryRequest that requires the client to generate a key
   share on the P-256 curve.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  9d 4c c0 9b b2 73 6c 2d c2 19 cc c5 93
         ba ec b6 8a b5 27 57 de 8d 0b da 98 9b 6e c5 6c b0 0b 90




Thomson                 Expires December 31, 2018              [Page 26]

Internet-Draft               TLS 1.3 Traces                    June 2018


      public key (32 octets):  1f 55 23 1c 33 db 34 62 6d 5f 5d de 0f 9a
         69 61 c5 77 d2 e1 05 3c a7 f5 ae 9b 63 dd 25 aa 3e 6f

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (180 octets):  01 00 00 b0 03 03 38 05 fe 1b 09 2c 98 be
         05 b6 6b 53 dc 1d 3f dd 75 a3 44 77 b1 80 79 ac 2d be f2 b8 63
         ac 8c 94 00 00 06 13 01 13 03 13 02 01 00 00 81 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00 20 1f 55 23 1c 33
         db 34 62 6d 5f 5d de 0f 9a 69 61 c5 77 d2 e1 05 3c a7 f5 ae 9b
         63 dd 25 aa 3e 6f 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03
         05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04
         02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      ciphertext (185 octets):  16 03 01 00 b4 01 00 00 b0 03 03 38 05
         fe 1b 09 2c 98 be 05 b6 6b 53 dc 1d 3f dd 75 a3 44 77 b1 80 79
         ac 2d be f2 b8 63 ac 8c 94 00 00 06 13 01 13 03 13 02 01 00 00
         81 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00
         20 1f 55 23 1c 33 db 34 62 6d 5f 5d de 0f 9a 69 61 c5 77 d2 e1
         05 3c a7 f5 ae 9b 63 dd 25 aa 3e 6f 00 2b 00 03 02 7f 1c 00 0d
         00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05
         01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c
         00 02 40 01

   {server}  send a ServerHello handshake message

   {server}  send handshake record:

      payload (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61 11
         be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2 c8
         a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17 00 2c 00 74 00 72
         9d ea e5 c6 f0 51 6e 21 78 60 4d 42 00 00 00 00 12 2f c8 32 d5
         82 60 69 6a c5 ab 4d e0 41 db df 00 30 de 57 89 67 e7 85 b2 f8
         d0 46 33 5b 33 fa 08 2b a4 3a bf d6 bf 58 bc d1 9f a5 c4 d2 eb
         52 45 12 41 f9 3b 7f 9d ba d8 ad 2e 23 47 d7 12 0c f9 f8 a4 a2
         e3 f6 45 99 c7 55 0e 1e 24 94 18 10 d4 2e 2c 41 04 2d 39 ac 17
         7c 2e 40 21 cb 08 cf a4 b2 00 2b 00 02 7f 1c

      ciphertext (181 octets):  16 03 03 00 b0 02 00 00 ac 03 03 cf 21
         ad 74 e5 9a 61 11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c
         5e 07 9e 09 e2 c8 a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17
         00 2c 00 74 00 72 9d ea e5 c6 f0 51 6e 21 78 60 4d 42 00 00 00
         00 12 2f c8 32 d5 82 60 69 6a c5 ab 4d e0 41 db df 00 30 de 57
         89 67 e7 85 b2 f8 d0 46 33 5b 33 fa 08 2b a4 3a bf d6 bf 58 bc



Thomson                 Expires December 31, 2018              [Page 27]

Internet-Draft               TLS 1.3 Traces                    June 2018


         d1 9f a5 c4 d2 eb 52 45 12 41 f9 3b 7f 9d ba d8 ad 2e 23 47 d7
         12 0c f9 f8 a4 a2 e3 f6 45 99 c7 55 0e 1e 24 94 18 10 d4 2e 2c
         41 04 2d 39 ac 17 7c 2e 40 21 cb 08 cf a4 b2 00 2b 00 02 7f 1c

   {client}  create an ephemeral P-256 key pair:

      private key (32 octets):  b7 d5 0e 61 ad 6c 4a 6a 04 85 c0 a4 55
         80 c0 79 7c ec de 69 6c 41 7a b5 28 72 f7 8a a7 fc 49 53

      public key (65 octets):  04 48 d7 35 98 ea 4d 3f 16 d0 81 ba 00 d5
         bb 27 31 69 19 60 00 5e 5c e2 df 5b 18 46 5a 76 11 82 de c2 ac
         93 76 10 a1 12 da aa ed 86 f2 16 3b bf fe c9 dc 59 35 92 a0 2e
         8f ee 4b 6f f7 99 8d 63 7d

   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 38 05 fe 1b 09 2c 98 be
         05 b6 6b 53 dc 1d 3f dd 75 a3 44 77 b1 80 79 ac 2d be f2 b8 63
         ac 8c 94 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00 41 04 48 d7 35 98
         ea 4d 3f 16 d0 81 ba 00 d5 bb 27 31 69 19 60 00 5e 5c e2 df 5b
         18 46 5a 76 11 82 de c2 ac 93 76 10 a1 12 da aa ed 86 f2 16 3b
         bf fe c9 dc 59 35 92 a0 2e 8f ee 4b 6f f7 99 8d 63 7d 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2c
         00 74 00 72 9d ea e5 c6 f0 51 6e 21 78 60 4d 42 00 00 00 00 12
         2f c8 32 d5 82 60 69 6a c5 ab 4d e0 41 db df 00 30 de 57 89 67
         e7 85 b2 f8 d0 46 33 5b 33 fa 08 2b a4 3a bf d6 bf 58 bc d1 9f
         a5 c4 d2 eb 52 45 12 41 f9 3b 7f 9d ba d8 ad 2e 23 47 d7 12 0c
         f9 f8 a4 a2 e3 f6 45 99 c7 55 0e 1e 24 94 18 10 d4 2e 2c 41 04
         2d 39 ac 17 7c 2e 40 21 cb 08 cf a4 b2 00 2d 00 02 01 01 00 1c
         00 02 40 01 00 15 00 af 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      ciphertext (517 octets):  16 03 03 02 00 01 00 01 fc 03 03 38 05
         fe 1b 09 2c 98 be 05 b6 6b 53 dc 1d 3f dd 75 a3 44 77 b1 80 79
         ac 2d be f2 b8 63 ac 8c 94 00 00 06 13 01 13 03 13 02 01 00 01
         cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00



Thomson                 Expires December 31, 2018              [Page 28]

Internet-Draft               TLS 1.3 Traces                    June 2018


         00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00
         41 04 48 d7 35 98 ea 4d 3f 16 d0 81 ba 00 d5 bb 27 31 69 19 60
         00 5e 5c e2 df 5b 18 46 5a 76 11 82 de c2 ac 93 76 10 a1 12 da
         aa ed 86 f2 16 3b bf fe c9 dc 59 35 92 a0 2e 8f ee 4b 6f f7 99
         8d 63 7d 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2c 00 74 00 72 9d ea e5 c6 f0 51 6e 21 78 60 4d
         42 00 00 00 00 12 2f c8 32 d5 82 60 69 6a c5 ab 4d e0 41 db df
         00 30 de 57 89 67 e7 85 b2 f8 d0 46 33 5b 33 fa 08 2b a4 3a bf
         d6 bf 58 bc d1 9f a5 c4 d2 eb 52 45 12 41 f9 3b 7f 9d ba d8 ad
         2e 23 47 d7 12 0c f9 f8 a4 a2 e3 f6 45 99 c7 55 0e 1e 24 94 18
         10 d4 2e 2c 41 04 2d 39 ac 17 7c 2e 40 21 cb 08 cf a4 b2 00 2d
         00 02 01 01 00 1c 00 02 40 01 00 15 00 af 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral P-256 key pair:

      private key (32 octets):  f5 da 46 df df e3 21 09 17 bc a5 de f9
         e5 c2 56 e0 e8 3c 83 da 86 7e bb 94 9d 92 b2 de f4 fe 7e

      public key (65 octets):  04 f9 2d ef dc 4c 54 b6 85 75 cb 9c 3f fb
         f2 2a 49 15 e0 2e a1 4d 2a 83 a1 11 3c 1f e6 20 a8 21 fd e7 0f
         8e 23 e2 6e 93 bd ef c5 8c 54 7b b5 83 01 4c 8b 58 48 cc fc 95
         0e de 6a 91 9e e2 9d f7 42

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a



Thomson                 Expires December 31, 2018              [Page 29]

Internet-Draft               TLS 1.3 Traces                    June 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  0c 34 aa 3f 08 91 88 1f 86 3b cb 6b b3 5c 70 c3
         17 04 08 88 b2 e2 9a 13 45 f3 35 00 16 53 02 97

      secret (32 octets):  aa 99 fd ed 8f 6d c8 ad 21 89 a1 36 29 7e 72
         94 61 ae 78 ab 3c b5 d6 58 20 a2 d7 ea 3d 1c 3a db

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  aa 99 fd ed 8f 6d c8 ad 21 89 a1 36 29 7e 72 94
         61 ae 78 ab 3c b5 d6 58 20 a2 d7 ea 3d 1c 3a db

      hash (32 octets):  ef 2e a8 ec 32 6c 18 72 56 ff be 2a cc 58 8f c8
         fd cf ba 72 eb a3 77 ac 02 4c f4 19 6b 7d 94 d9

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 ef 2e a8 ec 32 6c 18 72 56 ff be 2a cc 58 8f
         c8 fd cf ba 72 eb a3 77 ac 02 4c f4 19 6b 7d 94 d9

      output (32 octets):  f2 df ab b4 85 b9 d0 98 be 71 2c 12 e5 2d c2
         40 b5 67 51 ea 49 10 62 3f 73 1b f5 c7 15 4d 3a 98

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  aa 99 fd ed 8f 6d c8 ad 21 89 a1 36 29 7e 72 94
         61 ae 78 ab 3c b5 d6 58 20 a2 d7 ea 3d 1c 3a db

      hash (32 octets):  ef 2e a8 ec 32 6c 18 72 56 ff be 2a cc 58 8f c8
         fd cf ba 72 eb a3 77 ac 02 4c f4 19 6b 7d 94 d9

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 ef 2e a8 ec 32 6c 18 72 56 ff be 2a cc 58 8f
         c8 fd cf ba 72 eb a3 77 ac 02 4c f4 19 6b 7d 94 d9




Thomson                 Expires December 31, 2018              [Page 30]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  94 f8 87 22 4f d2 d2 be f0 ce a7 f3 a2 95 d5
         9e 15 3c 65 78 51 32 bb de 1b e7 61 c5 94 fc 19 70

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  aa 99 fd ed 8f 6d c8 ad 21 89 a1 36 29 7e 72 94
         61 ae 78 ab 3c b5 d6 58 20 a2 d7 ea 3d 1c 3a db

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  35 82 11 d9 23 67 94 06 05 26 fe 0c fe 49 11
         bf 49 e6 c1 41 4f 04 04 a9 3a 29 d7 34 0f 92 7e 0e

   {server}  extract secret "master":

      salt (32 octets):  35 82 11 d9 23 67 94 06 05 26 fe 0c fe 49 11 bf
         49 e6 c1 41 4f 04 04 a9 3a 29 d7 34 0f 92 7e 0e

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  3e 0b 2b 02 45 0e c8 0b 8f fe 1b 80 54 cf 04
         4d 49 3e 0b 67 34 ed 75 16 14 97 76 5a b7 6f aa 4c

   {server}  send handshake record:

      payload (123 octets):  02 00 00 77 03 03 f1 1d a0 9f 47 f6 3f ef
         41 c4 57 9d bc 66 a1 9f c7 a4 52 2b bc 0b d5 15 b7 52 1d 31 68
         4f 09 62 00 13 01 00 00 4f 00 33 00 45 00 17 00 41 04 f9 2d ef
         dc 4c 54 b6 85 75 cb 9c 3f fb f2 2a 49 15 e0 2e a1 4d 2a 83 a1
         11 3c 1f e6 20 a8 21 fd e7 0f 8e 23 e2 6e 93 bd ef c5 8c 54 7b
         b5 83 01 4c 8b 58 48 cc fc 95 0e de 6a 91 9e e2 9d f7 42 00 2b
         00 02 7f 1c

      ciphertext (128 octets):  16 03 03 00 7b 02 00 00 77 03 03 f1 1d
         a0 9f 47 f6 3f ef 41 c4 57 9d bc 66 a1 9f c7 a4 52 2b bc 0b d5
         15 b7 52 1d 31 68 4f 09 62 00 13 01 00 00 4f 00 33 00 45 00 17
         00 41 04 f9 2d ef dc 4c 54 b6 85 75 cb 9c 3f fb f2 2a 49 15 e0
         2e a1 4d 2a 83 a1 11 3c 1f e6 20 a8 21 fd e7 0f 8e 23 e2 6e 93
         bd ef c5 8c 54 7b b5 83 01 4c 8b 58 48 cc fc 95 0e de 6a 91 9e
         e2 9d f7 42 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:



Thomson                 Expires December 31, 2018              [Page 31]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  94 f8 87 22 4f d2 d2 be f0 ce a7 f3 a2 95 d5 9e
         15 3c 65 78 51 32 bb de 1b e7 61 c5 94 fc 19 70

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  93 ba 2a 24 c1 ad 38 0c 58 65 63 4b 3c 77
         56 21

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  63 e9 70 0c d4 ab fe 39 91 01 34 94

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  94 f8 87 22 4f d2 d2 be f0 ce a7 f3 a2 95 d5 9e
         15 3c 65 78 51 32 bb de 1b e7 61 c5 94 fc 19 70

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  9a 6d 5f f6 c9 b1 70 03 7b db 9a 04 69 6a e1
         2f 82 b9 ff 35 fb 89 22 56 26 49 ee 67 48 88 50 86

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (645 octets):  08 00 00 18 00 16 00 0a 00 08 00 06 00 17
         00 18 00 1d 00 1c 00 02 40 01 00 00 00 00 0b 00 01 b9 00 00 01
         b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30
         0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31
         32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06
         09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81
         81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68
         de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc
         9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
         a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a
         5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6



Thomson                 Expires December 31, 2018              [Page 32]

Internet-Draft               TLS 1.3 Traces                    June 2018


         d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7
         9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04
         02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a
         86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27
         6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5
         94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5
         5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70
         2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9
         b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d
         40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d e1 00 00 0f 00 00
         84 08 04 00 80 42 46 96 e2 38 87 8b 8d 78 8f 2f 60 b9 f2 ec a9
         0d 5e c8 38 f0 4a ba 48 62 4b 2a c9 64 58 f6 7b 8a 00 78 83 db
         68 3f 05 5a 6d 4f 7d 55 6a 57 2b 35 bb 0f d7 a5 74 58 3a f5 df
         89 74 b3 b8 17 8f 55 8c fe 66 31 61 b8 23 42 ca 2b 4c ad b9 d4
         bc 88 6e 4f 98 d1 6a 24 77 a6 58 07 6f 93 5a 7d ea 34 f6 cc be
         25 75 17 ba 29 d7 bf bc 7d 12 12 32 57 c0 2f f3 dd db c4 12 e3
         b3 f7 22 12 b3 f2 76 14 00 00 20 75 33 a0 fc 42 04 35 0c 19 0e
         26 ef 04 0e a6 eb 6b ec ad 27 1f 5a 64 41 1c 81 11 6c 16 71 4d
         e3

      ciphertext (667 octets):  17 03 03 02 96 40 a7 3b 85 84 05 c2 af
         30 5c 62 96 8d 17 08 eb 34 1b 45 8a 9e 41 a8 e3 b0 c7 5e fa 6a
         78 43 66 10 bb 5c 86 26 e5 1e 7c 66 a1 01 07 cd 6a 29 f0 2c ee
         9c a4 40 65 59 18 e1 14 72 25 4a 97 27 8c a3 d4 6d 3a 14 ac 2f
         2c 3f 27 22 b8 9c 4d f5 fc d4 d5 dc cf 38 16 dc 88 82 ae 0c 07
         dc 09 0e ae b6 6e de b7 c3 cb 12 3f 72 c4 d3 07 ab a1 a9 a2 60
         3e 82 38 ce 26 a6 03 f6 3d 00 bc e7 b6 05 6d 5c 14 8b 21 4f 55
         17 51 76 5e a0 96 d6 7a 96 64 96 0f 7a ed f9 c2 08 05 64 99 47
         ed cb 65 7f 4e aa ef db d0 e4 6c 6b 9c 10 8a 2b c0 65 ab b5 72
         88 e6 75 60 8c 6b e8 97 32 7e 4e 0e 93 88 07 59 3d 6f bc 08 dd
         cd e4 9f 70 29 f5 07 3d 26 bb a7 6f 23 72 a9 9c 3d 01 1a a8 1e
         07 24 d4 a2 53 db a0 fa f7 27 1b 1a f1 97 fe 92 90 70 bb 27 78
         31 6c 70 d4 ff 9b 99 ba 44 db b7 c0 5e e2 32 b3 1e 1c 68 87 cb
         1d d6 00 eb 63 62 1d 38 59 79 cb 14 43 3c a2 b3 75 29 43 b7 17
         16 b9 42 c0 1e f8 bd f5 9e e8 69 e1 de 2b 8d bb 5c 1a fe 96 1f
         c6 55 cf f0 5e 10 b0 5c cc ff 09 af b8 83 d6 31 1a 55 a3 b3 75
         d0 cc 63 98 de 25 31 e0 67 af 7f 00 d8 05 ed 69 4f a1 6c 04 f4
         44 40 f5 9b 82 1c e7 14 d0 ab 7e 01 43 74 78 68 0b bf 5a bc 9d
         2c c8 60 99 0a 54 07 dd e3 20 f3 bd 7c f5 59 61 be 73 4b e5 a7
         e5 ee aa ad 46 80 4a 88 99 b2 af 4a 03 d7 37 e6 b4 01 3b 61 db
         48 d4 93 1c f5 22 ae 6b 73 7f dc 59 0e 8e cc b6 63 03 09 94 5d
         51 52 62 46 7b f5 af 40 d9 ad a7 40 44 eb 52 6c 44 f5 5d 54 b7
         62 80 a5 0f c0 fb f9 b9 9d 05 99 9a 3d c2 03 d7 47 22 37 d7 e2
         0d 54 d1 6c 24 23 39 f8 8d 71 fd 28 7e 35 24 3e 43 39 1a f5 d6
         17 a0 16 b5 ad ce 38 f4 8b b7 5c 5e 08 91 31 f9 6c 8f 2b b4 f4
         c4 eb 81 82 be 8f 3a 0b d9 f1 45 aa 5e 0f 93 26 c0 19 c8 88 4a
         4c 81 89 1f 70 aa 7c 81 d9 8e 66 08 5f ce 8b c0 4f 56 26 af d3
         59 57 d0 70 3c 2a d2 7b 0d c3 7c 51 8b 83 fa 17 66 9a c4 67 c8



Thomson                 Expires December 31, 2018              [Page 33]

Internet-Draft               TLS 1.3 Traces                    June 2018


         62 64 80 ec d1 71 80 44 ee 5d 47 fe 49 ba 16 41 81 13 a5 3d ae
         c0 30 40 c0 f9 cf a2 9e 79 4f 7c bb 94 68 cc 06 1d 8a 34 64 fa
         d5 54 66 9f 54 cc 62 57 ad 4f b7 4c af c2 1f d5 ae d2 cb 5e 0f
         98 d5 ae cf 0b 9d 71 de 2f b8 fb ae f4 97 7a aa ec af 1a b1 f9
         63 a9 6c

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  3e 0b 2b 02 45 0e c8 0b 8f fe 1b 80 54 cf 04 4d
         49 3e 0b 67 34 ed 75 16 14 97 76 5a b7 6f aa 4c

      hash (32 octets):  78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97 70
         33 cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97
         70 33 cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3

      output (32 octets):  3f 63 11 13 0d 0f 47 b8 49 f3 df 42 69 ed ce
         52 e8 01 11 2d 2e b5 93 d4 f0 eb fb 73 1b dc f8 3c

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  3e 0b 2b 02 45 0e c8 0b 8f fe 1b 80 54 cf 04 4d
         49 3e 0b 67 34 ed 75 16 14 97 76 5a b7 6f aa 4c

      hash (32 octets):  78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97 70
         33 cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97
         70 33 cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3

      output (32 octets):  0c a3 e5 65 eb 25 6a f4 4a 8d 4a 7c 95 bb 76
         10 0c ef e9 78 68 96 6e 22 3a fd 52 10 1b f6 8c be

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  3e 0b 2b 02 45 0e c8 0b 8f fe 1b 80 54 cf 04 4d
         49 3e 0b 67 34 ed 75 16 14 97 76 5a b7 6f aa 4c

      hash (32 octets):  78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97 70
         33 cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 78 a1 3c 06 dc 7f 8a ab 15 0a 3c 21 23 e9 97 70 33
         cb 15 31 9f 0c ae f4 d8 ac e3 be 80 de 5c e3




Thomson                 Expires December 31, 2018              [Page 34]

Internet-Draft               TLS 1.3 Traces                    June 2018


      output (32 octets):  50 7a ad 36 14 ec 28 05 9b 64 63 4f 97 45 bf
         ee fd f9 b1 19 88 11 92 69 e1 f0 2f 04 60 cc 37 d1

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  0c a3 e5 65 eb 25 6a f4 4a 8d 4a 7c 95 bb 76 10
         0c ef e9 78 68 96 6e 22 3a fd 52 10 1b f6 8c be

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  e0 4b 13 78 c3 fb f2 9f d4 da c9 20 c4 56
         dd 94

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  57 75 86 93 89 c7 13 6e 29 15 59 6a

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  f2 df ab b4 85 b9 d0 98 be 71 2c 12 e5 2d c2 40
         b5 67 51 ea 49 10 62 3f 73 1b f5 c7 15 4d 3a 98

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  b1 7e bd 43 50 f3 28 a8 e9 75 52 45 3b 12
         3d da

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  87 58 1e d1 1f 0b 29 cb 8e de 17 ae

   {client}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55



Thomson                 Expires December 31, 2018              [Page 35]

Internet-Draft               TLS 1.3 Traces                    June 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  0c 34 aa 3f 08 91 88 1f 86 3b cb 6b b3 5c 70 c3
         17 04 08 88 b2 e2 9a 13 45 f3 35 00 16 53 02 97

      secret (32 octets):  aa 99 fd ed 8f 6d c8 ad 21 89 a1 36 29 7e 72
         94 61 ae 78 ab 3c b5 d6 58 20 a2 d7 ea 3d 1c 3a db

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  94 f8 87 22 4f d2 d2 be f0 ce a7 f3 a2 95 d5 9e
         15 3c 65 78 51 32 bb de 1b e7 61 c5 94 fc 19 70

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  93 ba 2a 24 c1 ad 38 0c 58 65 63 4b 3c 77
         56 21

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  63 e9 70 0c d4 ab fe 39 91 01 34 94

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)




Thomson                 Expires December 31, 2018              [Page 36]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  f2 df ab b4 85 b9 d0 98 be 71 2c 12 e5 2d c2 40
         b5 67 51 ea 49 10 62 3f 73 1b f5 c7 15 4d 3a 98

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  bf b2 56 d1 62 d5 1c 88 fa 87 be 0b e8 64 20
         6c aa 09 f4 3b 31 e9 53 7a c5 ec cd 42 7f 0c 2e d5

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 0b d1 f4 02 37 f4 8f 9d ec 7d 8e
         35 98 d4 00 06 4e b0 ba a2 88 62 d4 d2 8e 94 e4 46 7d 43 bd 8b

      ciphertext (58 octets):  17 03 03 00 35 24 9d e4 04 63 97 d8 32 93
         19 e9 cf 36 ac 43 18 12 3d 81 56 00 d4 0d 82 97 82 72 6b 84 76
         d7 c8 c3 e8 97 57 c2 3a 6e f0 52 1a b2 d6 0b 48 e9 1d 00 a5 3f
         1a 3b

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  3f 63 11 13 0d 0f 47 b8 49 f3 df 42 69 ed ce 52
         e8 01 11 2d 2e b5 93 d4 f0 eb fb 73 1b dc f8 3c

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  d0 d8 df 11 56 83 a2 ed 79 7f 99 36 ed 19
         ed 9a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f0 1c 97 4b bd 3a 81 05 9e 1a e0 59

   {client}  derive secret "tls13 res master":





Thomson                 Expires December 31, 2018              [Page 37]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  3e 0b 2b 02 45 0e c8 0b 8f fe 1b 80 54 cf 04 4d
         49 3e 0b 67 34 ed 75 16 14 97 76 5a b7 6f aa 4c

      hash (32 octets):  eb a1 77 cf 1f b7 bd 8e e1 b6 39 cb 7e f3 b2 bd
         5a 21 bc c0 14 bd 8e 97 4c ee 67 5d f8 4f 03 21

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 eb a1 77 cf 1f b7 bd 8e e1 b6 39 cb 7e f3 b2 bd 5a
         21 bc c0 14 bd 8e 97 4c ee 67 5d f8 4f 03 21

      output (32 octets):  c6 e5 5b bb b8 b1 e8 29 a1 b7 49 c8 d3 6c 12
         8f d4 92 77 b8 b3 fe 87 f4 4a 37 6f 2c f8 ca 9f 36

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 d7 63 41 04 92 cb 78 39 08
         86 ba 65 7c 16 56 12 8c 10 26

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 34 2e 82 47 7c 62 59 52 c9
         65 ec 69 ef de df 35 38 6a 03

6.  Client Authentication

   In this example, the server requests client authentication.  The
   client uses a certificate with an RSA key, the server uses an ECDSA
   certificate with a P-256 key.  Note that private keys for this
   example are not included in the draft.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  41 4f 21 aa a6 08 92 dc b3 51 a1 10 a7
         2b 63 0a fa aa be c2 81 1f b4 4a 4f 4c b5 58 08 59 4b b7

      public key (32 octets):  dc 79 54 03 4b 1e 73 ce ae 83 47 d0 0f 7e
         76 b9 e6 e4 e4 34 99 78 ce 09 94 02 ac 07 3c 2a 39 7c



Thomson                 Expires December 31, 2018              [Page 38]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (192 octets):  01 00 00 bc 03 03 5f a1 33 7e 94 59 1b 1d
         2a 09 91 20 18 e0 09 cf b1 72 79 c0 3f ae b6 60 ee 56 f4 c5 de
         32 2e 8f 00 00 06 13 01 13 03 13 02 01 00 00 8d 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 dc 79 54 03 4b 1e 73 ce ae 83 47 d0 0f 7e
         76 b9 e6 e4 e4 34 99 78 ce 09 94 02 ac 07 3c 2a 39 7c 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d
         00 02 01 01 00 1c 00 02 40 01

      ciphertext (197 octets):  16 03 01 00 c0 01 00 00 bc 03 03 5f a1
         33 7e 94 59 1b 1d 2a 09 91 20 18 e0 09 cf b1 72 79 c0 3f ae b6
         60 ee 56 f4 c5 de 32 2e 8f 00 00 06 13 01 13 03 13 02 01 00 00
         8d 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00
         00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01
         03 01 04 00 33 00 26 00 24 00 1d 00 20 dc 79 54 03 4b 1e 73 ce
         ae 83 47 d0 0f 7e 76 b9 e6 e4 e4 34 99 78 ce 09 94 02 ac 07 3c
         2a 39 7c 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06
         03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02
         06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  29 6e 3f 71 d1 3c 49 10 9b f3 45 99 74
         fb 77 46 3a ad 78 5e f9 1d 68 84 26 56 39 bb 9e e3 82 5e

      public key (32 octets):  2b cd 0b 06 43 cb 6e f8 a6 5c a1 a4 4b 9c
         53 1d 9f 69 ae 10 16 44 47 89 a1 ca af 9e 61 df 34 6a

   {server}  send a ServerHello handshake message

   {server}  derive secret for handshake "tls13 derived":




Thomson                 Expires December 31, 2018              [Page 39]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  8e 96 f1 6e 9a 90 4a 33 b9 45 d5 8a c2 cf 20 72
         f2 39 76 cd 8a 37 ae 00 52 c8 a7 95 69 a1 ec 31

      secret (32 octets):  c3 83 bd e0 c5 70 84 db 44 16 ca 05 20 31 2d
         37 2f cd 35 17 2a f5 2c f6 c3 3c 29 1d 15 9f 83 4b

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  c3 83 bd e0 c5 70 84 db 44 16 ca 05 20 31 2d 37
         2f cd 35 17 2a f5 2c f6 c3 3c 29 1d 15 9f 83 4b

      hash (32 octets):  90 49 1b 1e 50 da e0 d5 ab eb bc 57 bd 15 05 00
         32 37 a1 2d 9b 37 7a ad a6 9b e0 7e 3c a6 bc 64

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 90 49 1b 1e 50 da e0 d5 ab eb bc 57 bd 15 05
         00 32 37 a1 2d 9b 37 7a ad a6 9b e0 7e 3c a6 bc 64

      output (32 octets):  57 af e9 3f 2a e6 c8 97 07 c6 08 cb 08 07 ce
         d7 f2 6d 36 a5 66 4c 6b a8 86 50 ad 13 45 3e 96 21

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  c3 83 bd e0 c5 70 84 db 44 16 ca 05 20 31 2d 37
         2f cd 35 17 2a f5 2c f6 c3 3c 29 1d 15 9f 83 4b

      hash (32 octets):  90 49 1b 1e 50 da e0 d5 ab eb bc 57 bd 15 05 00
         32 37 a1 2d 9b 37 7a ad a6 9b e0 7e 3c a6 bc 64





Thomson                 Expires December 31, 2018              [Page 40]

Internet-Draft               TLS 1.3 Traces                    June 2018


      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 90 49 1b 1e 50 da e0 d5 ab eb bc 57 bd 15 05
         00 32 37 a1 2d 9b 37 7a ad a6 9b e0 7e 3c a6 bc 64

      output (32 octets):  3e 71 3f 11 79 e7 0b 69 2b e6 04 78 a5 a4 25
         9b 4d bd bb 21 7d 5d 9c e7 8c a7 aa 5c 8b 1c 2d 98

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  c3 83 bd e0 c5 70 84 db 44 16 ca 05 20 31 2d 37
         2f cd 35 17 2a f5 2c f6 c3 3c 29 1d 15 9f 83 4b

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  8d 5a 03 1a d8 c8 bf 0c bd 08 10 7c 1e 0e 13
         34 9a 1b d8 fd b0 70 b9 24 ae 81 62 78 c3 8c 22 1e

   {server}  extract secret "master":

      salt (32 octets):  8d 5a 03 1a d8 c8 bf 0c bd 08 10 7c 1e 0e 13 34
         9a 1b d8 fd b0 70 b9 24 ae 81 62 78 c3 8c 22 1e

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  f5 54 68 d3 92 2e 97 97 d5 7f 70 f2 3e 87 1c
         b0 0b 87 ce 4f e4 f1 9a 86 ba c5 9b c9 27 2d 37 10

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 c2 7d 34 d6 5d ad 10 68 1a
         ab 85 89 a4 93 30 ad 90 87 89 da e6 40 fe 25 b6 44 58 40 d9 9b
         0e 8e 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 2b cd 0b 06 43
         cb 6e f8 a6 5c a1 a4 4b 9c 53 1d 9f 69 ae 10 16 44 47 89 a1 ca
         af 9e 61 df 34 6a 00 2b 00 02 7f 1c

      ciphertext (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 c2 7d 34
         d6 5d ad 10 68 1a ab 85 89 a4 93 30 ad 90 87 89 da e6 40 fe 25
         b6 44 58 40 d9 9b 0e 8e 00 13 01 00 00 2e 00 33 00 24 00 1d 00
         20 2b cd 0b 06 43 cb 6e f8 a6 5c a1 a4 4b 9c 53 1d 9f 69 ae 10
         16 44 47 89 a1 ca af 9e 61 df 34 6a 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:



Thomson                 Expires December 31, 2018              [Page 41]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  3e 71 3f 11 79 e7 0b 69 2b e6 04 78 a5 a4 25 9b
         4d bd bb 21 7d 5d 9c e7 8c a7 aa 5c 8b 1c 2d 98

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  7d 7f 49 bf 57 9b d9 8b ff dd 7f 44 fc 8a
         10 3a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c7 a5 65 1f 7c 84 77 56 5d dd 3c 20

   {server}  send a EncryptedExtensions handshake message

   {server}  send a CertificateRequest handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  3e 71 3f 11 79 e7 0b 69 2b e6 04 78 a5 a4 25 9b
         4d bd bb 21 7d 5d 9c e7 8c a7 aa 5c 8b 1c 2d 98

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  e8 35 66 99 95 51 d8 b2 7d cd 39 18 84 2b 1d
         4a 1b 05 dd 64 e2 22 8e 7e 8c 03 a0 b2 74 a4 ab 73

   {server}  send a Finished handshake message

   {server}  send handshake record:

      payload (516 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0d 00 00 27 00 00 24 00 0d 00 20 00 1e 04 03 05
         03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02
         05 02 06 02 02 02 0b 00 01 3b 00 00 01 37 00 01 32 30 82 01 2e
         30 81 d5 a0 03 02 01 02 02 01 07 30 0a 06 08 2a 86 48 ce 3d 04
         03 02 30 13 31 11 30 0f 06 03 55 04 03 13 08 65 63 64 73 61 32
         35 36 30 1e 17 0d 31 36 30 37 33 30 30 31 32 34 30 30 5a 17 0d
         32 36 30 37 33 30 30 31 32 34 30 30 5a 30 13 31 11 30 0f 06 03
         55 04 03 13 08 65 63 64 73 61 32 35 36 30 59 30 13 06 07 2a 86
         48 ce 3d 02 01 06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 08 d5



Thomson                 Expires December 31, 2018              [Page 42]

Internet-Draft               TLS 1.3 Traces                    June 2018


         30 16 15 75 f4 cf e7 f1 54 ee 34 48 18 00 86 00 1e 88 43 1a 79
         ee 62 ee 6e 2f 83 ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4 d2 f5
         b5 6d 1f 04 ec e4 5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d d0 a3
         1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f
         04 04 03 02 07 80 30 0a 06 08 2a 86 48 ce 3d 04 03 02 03 48 00
         30 45 02 21 00 df 30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4 79 ca
         69 3f ee ca 3b 71 b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62 e2 a4
         72 50 d3 20 fe a8 3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db d1 3f
         ee 94 6e 51 3e 01 1d 11 00 00 0f 00 00 4a 04 03 00 46 30 44 02
         20 05 3d ae 63 48 3d 01 82 37 ec 73 d1 9a 50 5c 0e 30 5b 9d 21
         2e 08 f4 19 a6 0d 6a 74 8a 6a 1a 09 02 20 3a 21 52 a9 07 c3 ab
         d0 c0 d9 0a 9f 3c 5b 5d fb 53 0f 74 0e ae ca 66 83 42 39 e6 1a
         22 b7 e2 f4 14 00 00 20 2b 1c dc 3d 2d 67 5e 91 28 73 fd 17 3f
         6f 3a 83 49 73 6e 3d c7 a5 ea cc f9 52 f4 e2 7e 1d 82 35

      ciphertext (538 octets):  17 03 03 02 15 e6 4f 6c 6e 14 a6 64 61
         7d f6 0d 3f 5f d7 e8 b7 e0 8b bc 0b 93 ef c1 d5 97 45 54 64 0c
         c5 41 cb f3 b4 45 39 10 52 e1 c7 8a 4f 8a d9 c7 1c d5 44 72 97
         38 65 65 b0 23 98 ae ae 4f 29 b7 2b ae 0d 77 43 04 75 2e 9f ab
         86 16 8e e9 20 59 e6 09 ea 43 e5 01 49 74 bd 3b 8b 98 fd 40 49
         6e a5 c6 cb ca 03 c5 e5 fe 32 ff 6d 33 80 91 02 7f 2f 42 36 b4
         46 b1 7a 94 c6 c1 ee 78 b6 fb 96 47 a3 39 c4 d3 3f eb e1 9d ff
         09 cb 61 f3 73 1d 33 ee c2 16 bc 20 e0 6b c2 d9 35 9f 1a e9 09
         ed 69 35 d7 2b 5d fe b5 56 8d ea 86 87 4e 60 04 e2 40 7c 49 91
         9a bc 09 3a 94 05 04 fc 88 4d 6e 65 2a bc 08 a9 7d 9b 17 68 4d
         84 11 de 68 d0 34 01 7a a0 0f dd 7b c8 ac 2b 51 2a 2c 72 72 75
         98 ef df 5c 7e 20 99 74 8c 9c dc 83 eb d5 17 30 37 39 d2 43 5e
         4d 4d 6e 31 8c a2 af 49 87 ae 0f 1a d9 1b 3f 08 9c 79 e6 9f d1
         ca 2b 85 14 d2 29 5c d5 c1 6d 9d a7 3d a0 ff ab ae 3d fd 03 bf
         37 a6 b5 07 dc a0 fc f6 64 ab 69 21 8e f9 8b 97 07 cf 82 a0 90
         76 4d c9 c6 ef cc 8d 9d 0a 84 bd 1f c1 51 8f 4b b9 cb 26 5e 98
         5b a1 73 fc ba 89 d7 1f 73 54 ce d0 41 1f 7e 02 53 65 8c 2f bb
         f7 8f 8e d8 b4 22 3d 92 b9 a0 31 48 44 c3 72 74 cb 75 8c e3 a4
         f9 78 71 41 f1 bb e8 b3 7d 4c 59 60 15 4f d0 d5 d1 ce 65 3a 59
         37 01 41 be cd 53 ce 72 3d 4d 80 11 d2 d7 b1 9c 7f 3d 28 b3 57
         4a 2a 4d 63 86 9a 0d e0 91 e1 72 fc 49 9d 8e 02 e3 a8 6d 83 17
         71 17 9c 4f dc f8 dd f1 39 0e 4d cb f2 68 4c d0 10 1c 0d 11 c0
         2c fa 98 63 df 84 31 ee 62 13 29 d2 db 20 6c d9 94 90 22 0d fc
         29 00 91 c2 55 56 40 a7 71 d5 9d 08 89 3d 20 02 eb ac 9a b5 47
         2c a2 c2 81 b0 20 d9 97 bf 85 6e e9 d9 2a 14 08 a7 00 13 08 1a
         20 ee f4 82 c4 a7 15 1d 65 d4 5d f5 5d 79 d7 31 ad 57 80 0c 57

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  f5 54 68 d3 92 2e 97 97 d5 7f 70 f2 3e 87 1c b0
         0b 87 ce 4f e4 f1 9a 86 ba c5 9b c9 27 2d 37 10





Thomson                 Expires December 31, 2018              [Page 43]

Internet-Draft               TLS 1.3 Traces                    June 2018


      hash (32 octets):  89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0 51
         9f f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0
         51 9f f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      output (32 octets):  98 2e bb ce 13 7e ad 4d 42 8c 39 28 5c c2 ac
         01 75 95 0d 05 8c 79 c3 a5 8f 23 a8 83 72 80 9a fc

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  f5 54 68 d3 92 2e 97 97 d5 7f 70 f2 3e 87 1c b0
         0b 87 ce 4f e4 f1 9a 86 ba c5 9b c9 27 2d 37 10

      hash (32 octets):  89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0 51
         9f f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0
         51 9f f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      output (32 octets):  8a a0 81 82 f0 94 17 2c 13 b6 4c f9 68 03 eb
         ad fd d8 33 b7 14 73 cf f8 6a 7b 2f 49 d1 b1 b3 c9

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  f5 54 68 d3 92 2e 97 97 d5 7f 70 f2 3e 87 1c b0
         0b 87 ce 4f e4 f1 9a 86 ba c5 9b c9 27 2d 37 10

      hash (32 octets):  89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0 51
         9f f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 89 e4 79 c1 da b1 50 63 86 df 51 c2 a3 29 a0 51 9f
         f4 da b9 37 73 9b e4 62 b9 31 76 02 7a eb 53

      output (32 octets):  23 76 b2 d4 11 f2 77 ed 67 31 18 34 18 a9 34
         f0 32 99 45 cf 7c 85 c6 5a e6 02 ef df 4e 58 3f 80

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  8a a0 81 82 f0 94 17 2c 13 b6 4c f9 68 03 eb ad
         fd d8 33 b7 14 73 cf f8 6a 7b 2f 49 d1 b1 b3 c9

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00





Thomson                 Expires December 31, 2018              [Page 44]

Internet-Draft               TLS 1.3 Traces                    June 2018


      key output (16 octets):  e9 15 56 22 43 21 d8 82 f2 d1 96 55 e5 13
         22 9d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  65 0a f3 1a 2a 6c d8 24 3a cb 3d b3

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  57 af e9 3f 2a e6 c8 97 07 c6 08 cb 08 07 ce d7
         f2 6d 36 a5 66 4c 6b a8 86 50 ad 13 45 3e 96 21

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  77 98 b6 13 f2 51 bd bc ae cd 99 ae b9 0f
         fb 31

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  ef 0c 5b 4c 39 bc ab cf 1a 15 64 0e

   {client}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":




Thomson                 Expires December 31, 2018              [Page 45]

Internet-Draft               TLS 1.3 Traces                    June 2018


      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  8e 96 f1 6e 9a 90 4a 33 b9 45 d5 8a c2 cf 20 72
         f2 39 76 cd 8a 37 ae 00 52 c8 a7 95 69 a1 ec 31

      secret (32 octets):  c3 83 bd e0 c5 70 84 db 44 16 ca 05 20 31 2d
         37 2f cd 35 17 2a f5 2c f6 c3 3c 29 1d 15 9f 83 4b

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  3e 71 3f 11 79 e7 0b 69 2b e6 04 78 a5 a4 25 9b
         4d bd bb 21 7d 5d 9c e7 8c a7 aa 5c 8b 1c 2d 98

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  7d 7f 49 bf 57 9b d9 8b ff dd 7f 44 fc 8a
         10 3a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  c7 a5 65 1f 7c 84 77 56 5d dd 3c 20

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  send a Certificate handshake message

   {client}  send a CertificateVerify handshake message



Thomson                 Expires December 31, 2018              [Page 46]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  57 af e9 3f 2a e6 c8 97 07 c6 08 cb 08 07 ce d7
         f2 6d 36 a5 66 4c 6b a8 86 50 ad 13 45 3e 96 21

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  0b 0e 23 7f 64 e2 5a f5 e2 0e 5b 8f 3f e2 5e
         f9 78 c2 33 45 a6 6d e4 b5 c0 54 3d 2a 8a 3a 99 4f

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (623 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82 01
         b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86
         f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06 63
         6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39
         5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f 30
         0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06 09
         2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81
         00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7 a1
         c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81 e5
         22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f f1
         90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97 1c
         7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7 fe
         9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7 e0
         28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02
         30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a 86
         48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0 22
         af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91 6d
         c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80 be
         2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e f0
         c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2 17
         bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac 0f
         78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00 0f 00 00 84
         08 04 00 80 0d 0c 02 35 d7 51 b2 d7 95 bd 19 58 d5 d6 57 3f 92
         81 27 d9 28 21 d2 bb f6 73 2e 8a 79 de fb e8 3c 68 38 e3 be 84
         a8 d1 b7 5f 11 cc 72 06 1b d7 77 91 fb 0e fa 6e 91 51 b7 76 83
         ac e4 83 74 c1 de f5 fa 54 d4 50 f4 89 f5 41 1a ad a7 8a 29 3a
         9b 8c fd 1b 1d fc 36 09 4c 81 fb 42 25 bb 05 52 10 ef 0d 12 bd
         97 0d 1b 3d f2 34 85 6a 3f 99 31 69 03 a8 2e aa f7 cf 19 b3 a5
         1a 7b 53 31 ba 38 14 00 00 20 a3 12 64 97 b5 7f 16 18 d9 c1 e6
         3c 60 e9 e5 4c fa 47 dd 7f 80 7c eb 8a 7d ed 7d 82 4c e7 69 79




Thomson                 Expires December 31, 2018              [Page 47]

Internet-Draft               TLS 1.3 Traces                    June 2018


      ciphertext (645 octets):  17 03 03 02 80 11 a6 db 2a 29 9b 48 d3
         66 43 1a 61 d4 6b d2 35 13 ac c1 bc b7 ab bc 78 5e bc 58 a8 b2
         e4 eb c4 d2 cf 20 51 3d 1e cb 55 2e 5e 4c 0b 73 ce 2c 6b 2f 2b
         79 2f a9 13 7c 20 a7 d7 b3 13 0e 53 14 9d 64 4d 7d 3d 9d 04 8d
         59 ed fe 6e c0 13 73 81 03 46 95 a5 c1 5c 3c fb 7e 6e cd 8d d0
         c3 35 4c 16 5e ee 78 1a 14 5c cf 18 b6 07 fc ae 6e e2 5b f9 ce
         51 20 e5 e6 aa ef cd 46 e7 b2 ac 6c 68 21 fd 40 1c 0f 81 2c 00
         2e 51 38 29 5b 03 5c 17 5a 87 02 d6 24 f2 89 8e a3 02 89 b1 f4
         b1 26 c2 94 52 a2 25 0c 6c 69 ba c4 ff e1 ff 95 d3 32 80 2c 54
         1d 74 06 23 9b ec e4 3a ab 1e ff fa 40 33 f5 f1 43 db 8d 98 2a
         01 b6 38 62 f6 eb 35 0c c6 ea 21 61 63 da 47 2d 0f fb 15 a6 11
         4c f8 51 f4 4e 6f 0d b6 67 5f c1 7a 96 e8 cf 6d 13 7f 15 31 48
         09 81 82 dc 0f b6 0a 74 4f 0b 88 1f 2d 09 a1 d4 7c 94 db f8 00
         47 e1 85 47 26 f7 ff 62 48 0b 77 26 3c fb de 76 01 60 56 53 3f
         b1 bd c6 1a bb 78 a0 46 bb e2 ad 24 cc e2 1b c1 6f a1 78 aa b1
         85 ca 26 8d 68 1f 6b 3e 31 da 47 ea 3a 43 d9 8e 7f 14 40 a6 61
         45 23 4e 58 ea 00 39 ba 20 af d5 c0 dd f0 25 da c7 9c 74 83 47
         e8 47 bc 83 a6 42 8d d6 f7 24 20 f7 ce 45 b3 ae 24 0b 0c 6e ce
         d8 c7 8b 46 48 0a d8 16 e6 5c b0 b9 76 50 78 38 a6 26 6e 58 d5
         4e 7c d1 a1 ed 36 0a ae 19 55 5c 1e 73 32 c6 03 b2 28 a1 29 d1
         f9 66 86 95 61 50 95 cc fc ec e6 bb 7f 3f eb 82 d1 ad a1 e9 a5
         23 d4 d9 ba 0a 9d d8 e0 bf 42 ef ab 41 aa 4b 4b 5e d3 e8 7a 50
         2e 7b 24 e5 a4 d9 d0 8c e5 85 12 44 05 9c 14 ef 90 de c1 2e 0a
         21 d2 c8 42 1b ab 08 d3 e9 9c f6 26 26 9d 28 43 c2 65 c2 19 59
         c8 c9 b7 a9 81 4e 33 bb bd 13 56 79 9d a8 b0 a8 c4 df 23 e1 8f
         ec 3d 1a fd 76 6a 2f 9d ca c1 42 d4 8e 16 4c 1c f3 3d ac 1d 02
         14 08 f2 df 8f ad 03 8c 46 73 18 4d 04 13 22 b4 4c 08 8f 50 61
         e0 81 67 c4 53 2d d3 f7 9a 66 58 8e 7f f9 f7 a7 e7 76 30 de 29
         50 ac ae 09 88 c0 cd 7f 4d af cc 17 13 01 04 39 11 cb f8 da 28
         6a 20 9e 0c 9d 83 c4 bc 4e 8c 46 70 1c dc 9e 08 fa 55 03 1b 13
         97 29 93 f3 14 43 f9 f1 6f f6 1c bb 2c a4 85 ff 8c 18 13 6b a6
         83 75

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  98 2e bb ce 13 7e ad 4d 42 8c 39 28 5c c2 ac 01
         75 95 0d 05 8c 79 c3 a5 8f 23 a8 83 72 80 9a fc

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  bf 21 bc dd ac 09 19 3d 3a f7 70 e5 ed 16
         02 8c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  51 ff aa 63 37 b6 7e b8 e9 f7 f3 39

   {client}  derive secret "tls13 res master":



Thomson                 Expires December 31, 2018              [Page 48]

Internet-Draft               TLS 1.3 Traces                    June 2018


      PRK (32 octets):  f5 54 68 d3 92 2e 97 97 d5 7f 70 f2 3e 87 1c b0
         0b 87 ce 4f e4 f1 9a 86 ba c5 9b c9 27 2d 37 10

      hash (32 octets):  12 73 17 42 19 0d 46 2e c1 fe 7e 2a c2 dc b2 56
         8d da 84 7f 3d 09 cf c7 7e f2 0c 54 f2 b5 b9 2a

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 12 73 17 42 19 0d 46 2e c1 fe 7e 2a c2 dc b2 56 8d
         da 84 7f 3d 09 cf c7 7e f2 0c 54 f2 b5 b9 2a

      output (32 octets):  9b a5 cd 66 d6 a0 23 ac 1d 51 1c 9f 6a 62 30
         94 8c ca cc f3 7c cd 1c 54 24 f2 98 2b 0a 2b ed b2

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 92 13 8d 47 ee 25 76 56 fc
         ca 02 91 45 72 dd df f0 c9 dc

   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 57 66 34 8d 7e 30 bd 80 da
         83 78 a7 17 79 e4 6f c2 3b 79

7.  Compatibility Mode

   This example shows use of the handshake with the client requesting
   that the server use compatibility mode as defined in Appendix D.4 of
   [TLS13].

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  c4 46 1f c5 ca 87 b8 76 f1 6f e8 59 43
         0d 52 3b 52 15 4c 48 73 3c 3c 38 fb 01 d5 6d 05 a8 86 a0

      public key (32 octets):  8f d3 b4 e8 d3 d1 f0 86 03 e9 a9 36 ba 88
         e5 71 d4 de 9b 55 2b c7 65 07 a3 e6 4e 5c ce cd 0c 3a




Thomson                 Expires December 31, 2018              [Page 49]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {client}  send a ClientHello handshake message

   {client}  send handshake record:

      payload (224 octets):  01 00 00 dc 03 03 07 57 6f 7d ef 4c 0c 00
         5f dc 23 64 cb 63 bb 2a 4b 48 12 fd 3a 8e 55 69 76 97 5c 7f 15
         c5 e1 27 20 61 b8 27 a4 93 df eb eb 4a 26 49 ad 78 db 96 c0 0b
         53 65 62 9c 2a 7f e8 5e f5 51 d0 e5 aa 8b b2 00 06 13 01 13 03
         13 02 01 00 00 8d 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72
         ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00
         01 01 01 02 01 03 01 04 00 33 00 26 00 24 00 1d 00 20 8f d3 b4
         e8 d3 d1 f0 86 03 e9 a9 36 ba 88 e5 71 d4 de 9b 55 2b c7 65 07
         a3 e6 4e 5c ce cd 0c 3a 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      ciphertext (229 octets):  16 03 01 00 e0 01 00 00 dc 03 03 07 57
         6f 7d ef 4c 0c 00 5f dc 23 64 cb 63 bb 2a 4b 48 12 fd 3a 8e 55
         69 76 97 5c 7f 15 c5 e1 27 20 61 b8 27 a4 93 df eb eb 4a 26 49
         ad 78 db 96 c0 0b 53 65 62 9c 2a 7f e8 5e f5 51 d0 e5 aa 8b b2
         00 06 13 01 13 03 13 02 01 00 00 8d 00 00 00 0b 00 09 00 00 06
         73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17
         00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00 26 00 24 00
         1d 00 20 8f d3 b4 e8 d3 d1 f0 86 03 e9 a9 36 ba 88 e5 71 d4 de
         9b 55 2b c7 65 07 a3 e6 4e 5c ce cd 0c 3a 00 2b 00 03 02 7f 1c
         00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04
         01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01
         00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  56 06 18 00 fe b8 ca ea d1 95 87 c3 18
         32 f4 70 7d e2 03 6d 2a ac c7 fc ab 3f 78 58 ac ec 2a 8f

      public key (32 octets):  97 3b dd 92 de a7 e0 fb 5f 5b 86 5b d0 2c
         7c 94 8a 63 a9 19 e2 19 7c ff ff ee 7c 8d e7 ac 01 63

   {server}  send a ServerHello handshake message



Thomson                 Expires December 31, 2018              [Page 50]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {server}  send handshake record:

      payload (122 octets):  02 00 00 76 03 03 ba 8b 1d d4 16 07 4f b5
         84 0a cf 37 d3 39 b2 94 c4 5e 22 03 19 e4 dd d1 f3 ec 16 7a f2
         a4 61 4f 20 61 b8 27 a4 93 df eb eb 4a 26 49 ad 78 db 96 c0 0b
         53 65 62 9c 2a 7f e8 5e f5 51 d0 e5 aa 8b b2 13 01 00 00 2e 00
         33 00 24 00 1d 00 20 97 3b dd 92 de a7 e0 fb 5f 5b 86 5b d0 2c
         7c 94 8a 63 a9 19 e2 19 7c ff ff ee 7c 8d e7 ac 01 63 00 2b 00
         02 7f 1c

      ciphertext (127 octets):  16 03 03 00 7a 02 00 00 76 03 03 ba 8b
         1d d4 16 07 4f b5 84 0a cf 37 d3 39 b2 94 c4 5e 22 03 19 e4 dd
         d1 f3 ec 16 7a f2 a4 61 4f 20 61 b8 27 a4 93 df eb eb 4a 26 49
         ad 78 db 96 c0 0b 53 65 62 9c 2a 7f e8 5e f5 51 d0 e5 aa 8b b2
         13 01 00 00 2e 00 33 00 24 00 1d 00 20 97 3b dd 92 de a7 e0 fb
         5f 5b 86 5b d0 2c 7c 94 8a 63 a9 19 e2 19 7c ff ff ee 7c 8d e7
         ac 01 63 00 2b 00 02 7f 1c

   {server}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  3a fd 77 2a 2a 78 0a 64 13 b6 6e 3a 28 78 dc d1
         01 77 3e 26 db 00 76 1e 38 30 0a d7 c0 f9 ac 40





Thomson                 Expires December 31, 2018              [Page 51]

Internet-Draft               TLS 1.3 Traces                    June 2018


      secret (32 octets):  a9 87 e2 1d aa 09 0c d5 68 6c 55 e4 67 b0 ae
         f8 20 5b c0 4d 27 86 b0 93 6e 0c 3d 7b 70 92 e9 0a

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  a9 87 e2 1d aa 09 0c d5 68 6c 55 e4 67 b0 ae f8
         20 5b c0 4d 27 86 b0 93 6e 0c 3d 7b 70 92 e9 0a

      hash (32 octets):  74 e0 c3 c1 f1 8a ab 4f 9e 7a df e1 dd 73 a0 2b
         b0 71 12 d3 bb de 3c 94 c0 1b 8d be f1 0b 35 f9

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 74 e0 c3 c1 f1 8a ab 4f 9e 7a df e1 dd 73 a0
         2b b0 71 12 d3 bb de 3c 94 c0 1b 8d be f1 0b 35 f9

      output (32 octets):  18 01 f7 4f e5 16 f1 cd 17 18 e2 82 e4 ca 7c
         8c d9 98 d2 a8 2f fd 51 30 b8 6c 7b d2 9e 09 dc af

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  a9 87 e2 1d aa 09 0c d5 68 6c 55 e4 67 b0 ae f8
         20 5b c0 4d 27 86 b0 93 6e 0c 3d 7b 70 92 e9 0a

      hash (32 octets):  74 e0 c3 c1 f1 8a ab 4f 9e 7a df e1 dd 73 a0 2b
         b0 71 12 d3 bb de 3c 94 c0 1b 8d be f1 0b 35 f9

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 74 e0 c3 c1 f1 8a ab 4f 9e 7a df e1 dd 73 a0
         2b b0 71 12 d3 bb de 3c 94 c0 1b 8d be f1 0b 35 f9

      output (32 octets):  51 f2 03 d8 13 92 bf 03 02 c7 2f bb 98 d7 fd
         c5 60 fb 9a 00 56 c6 32 c5 59 da fd 33 74 e0 2f 2b

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  a9 87 e2 1d aa 09 0c d5 68 6c 55 e4 67 b0 ae f8
         20 5b c0 4d 27 86 b0 93 6e 0c 3d 7b 70 92 e9 0a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  7c e2 f5 47 bb 6c 38 69 97 70 08 e2 b3 ea 22
         5f 91 ea 51 00 7e 14 41 da 52 45 92 f2 00 1b cd 15




Thomson                 Expires December 31, 2018              [Page 52]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {server}  extract secret "master":

      salt (32 octets):  7c e2 f5 47 bb 6c 38 69 97 70 08 e2 b3 ea 22 5f
         91 ea 51 00 7e 14 41 da 52 45 92 f2 00 1b cd 15

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  0a 51 96 c0 66 5d de 4e 0a 09 e7 e8 e1 ba 66
         1b a4 85 eb 46 07 c5 65 f8 8b 60 ec 2d 4d ce ae f5

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  51 f2 03 d8 13 92 bf 03 02 c7 2f bb 98 d7 fd c5
         60 fb 9a 00 56 c6 32 c5 59 da fd 33 74 e0 2f 2b

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  4f d1 27 29 ce 0a ba a4 40 e1 b0 06 fa 0f
         bc 4f

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  49 cf f4 cb 51 39 78 3f 61 57 f0 fa

   {server}  send a EncryptedExtensions handshake message

   {server}  send a Certificate handshake message

   {server}  send a CertificateVerify handshake message

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  51 f2 03 d8 13 92 bf 03 02 c7 2f bb 98 d7 fd c5
         60 fb 9a 00 56 c6 32 c5 59 da fd 33 74 e0 2f 2b

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  e8 fa 24 91 38 d7 56 f9 bc 09 1e aa 10 61 6b
         7e 4d a9 28 e9 67 63 e8 cc 1a 68 94 44 49 e3 b1 25

   {server}  send a Finished handshake message

   {server}  send handshake record:




Thomson                 Expires December 31, 2018              [Page 53]

Internet-Draft               TLS 1.3 Traces                    June 2018


      payload (657 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30
         82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d
         01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36
         30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04
         03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01
         01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30
         3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a
         24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e
         aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01
         8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53
         0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab
         9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01
         a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d
         0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05
         00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17
         06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5
         8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72
         60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63
         a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84
         e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29
         ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 73 fb ca 15
         51 67 83 95 b7 3d 7f e3 20 f2 98 08 bd a6 bf 7c 63 70 a7 f6 0a
         72 25 14 77 9b 26 24 5f 5f ed 53 e7 96 eb 13 e2 26 a3 fd 97 03
         aa 56 98 79 8a 80 e1 86 1c c6 59 c8 5e 2f c5 14 78 00 dd 11 d9
         91 65 82 9a a2 55 dc 6b 53 c4 6e 7b 8a 77 50 cc a0 5e ab d2 c8
         23 d2 2a b8 fd bf 8c f1 5b 98 d4 91 5f 82 f8 0d 0c 3c 27 41 a0
         f9 18 d0 7d 6f 3d 47 59 4e 42 c6 81 af 65 b1 8f f0 93 02 14 00
         00 20 0b c5 f9 c6 78 9b 55 36 85 de d4 15 0f e4 3f 6b 66 3f 70
         0e 70 46 b9 85 dd 19 e3 73 29 5c d7 ec

      ciphertext (679 octets):  17 03 03 02 a2 92 41 7f 9d 72 f0 f0 a8
         5e 2f 81 81 fe 2d cb 28 0b b9 bc 64 d2 34 b7 54 74 ac 1e d5 ba
         1b e0 cf bb 59 09 38 30 9f 8b 90 fb 3f 21 ab ae ee 58 98 0d 3a
         36 3d bc a3 3f d1 67 3b 6f ff 45 38 55 50 82 b1 0b cf cb ed 09
         c4 67 cc 72 f9 ea 8f bf 2d ea 6a 06 a1 f2 4c 96 bb 8c 22 be be
         28 b8 37 b5 47 fb be 55 5b be 7d ce f9 b5 38 c4 b2 a6 a4 ed 8e
         1a 61 ba b6 95 68 fa d4 e7 9f 6d ac 8b 1f ad 99 40 da b1 97 ac
         25 58 8c 5d c5 68 88 14 54 23 01 84 6d 0c e2 be e7 d4 ee 79 97
         05 fc 68 54 8b e6 c6 aa 10 d5 f4 4d 78 71 d3 c5 23 96 dd 47 79
         52 47 9a b8 bb e4 53 1c 83 5c 04 44 74 ec 7e 32 ac c8 8a a9 88
         a6 6d 63 0c 4f af 24 68 03 8f 15 7a e5 32 11 ee 8e 88 53 aa 87
         ff b2 49 a3 fd 6e 3e 32 73 90 5c 6b 75 82 42 1b 11 28 e1 55 a2
         b2 74 c4 7a e6 2d 2d f1 ca 90 f1 b3 1e b9 8d 85 2b cd b4 d0 f4
         cd a9 d6 63 59 63 f6 03 a8 78 4d 7c 8b 55 47 15 01 ef cb c0 77
         13 26 d0 9c b5 b5 52 4e ef 71 80 37 12 e1 43 1b 77 df 7e 77 93



Thomson                 Expires December 31, 2018              [Page 54]

Internet-Draft               TLS 1.3 Traces                    June 2018


         53 56 39 16 0b 4a 17 da b9 35 c2 ea c7 e4 c0 5f 7a 1c 91 2f 7a
         07 b2 c6 a4 c6 7c 32 95 82 bd fb 6c 80 64 14 11 88 95 39 7d 11
         ab 0b 99 3f c8 dc 21 e9 00 bf 37 eb fc 26 99 80 9a 10 45 a7 2c
         e7 16 38 90 a1 db 49 ab a9 6e 61 22 ab 63 70 50 00 da 6e 63 01
         a5 56 85 f2 ae 6d e0 68 93 a5 39 17 1b 6a 78 cd 54 b1 67 7c 0b
         aa 1a b0 4a 32 63 aa e1 0c 52 fa 04 e6 f4 e4 f0 eb 04 dc 21 47
         b4 e1 b5 71 be ab b6 2a a1 61 9a 48 7d bc fa 2d ad ce b6 6c 7b
         a0 c9 ee 75 01 5e 49 06 00 0a c6 8d 2b 29 44 a3 1d 78 b5 6a 25
         63 ab 79 9f 2b 25 f4 a9 1e d6 36 8c e7 9c 6f 02 d4 a7 b4 b1 f5
         4c 6e f8 c2 ae e7 23 ce 60 58 57 c9 de 3f 49 fc aa 16 59 4d 4a
         e6 07 83 e2 ae 27 1b 37 21 69 ca 37 37 c9 c8 cc 2b ae ec 81 00
         25 8c 65 b8 2d 93 22 02 82 53 9b 7f e7 99 3d 30 cf a4 90 56 d4
         c1 80 bd 62 dd 9e 98 64 ab ad 62 8b d8 9b e6 32 b3 b6 95 d2 35
         13 b9 ad 7c bd d9 b8 6c 4b 5d a6 7a a6 1e 8f 6a 93 6c 0c 57 87
         ef 69 2f c4 b1 b7 e2 bd 49 b0 5d 85 5d 13 c1 a6 0f f2 f3 fe dc
         c4 dc 37 ac e1 4d 49 8e 68 1a cb 53 6d 97 5a 1e d9 0b 16 e5 7e
         52 e6 57 8a ce fb cb 87 64 3c c1 1c 83 81 83 a7 84 d7 26 25 26
         f8 04 2e 3a e3 bd 80 59 17 0b dc b7 92 dc 8b

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  0a 51 96 c0 66 5d de 4e 0a 09 e7 e8 e1 ba 66 1b
         a4 85 eb 46 07 c5 65 f8 8b 60 ec 2d 4d ce ae f5

      hash (32 octets):  4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d 02
         42 26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d
         02 42 26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      output (32 octets):  46 44 8c a8 d3 e2 66 ae 66 a4 c4 77 4b c6 63
         6d a0 10 71 a2 e3 bc f9 3b 76 67 34 41 b5 97 c3 4b

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  0a 51 96 c0 66 5d de 4e 0a 09 e7 e8 e1 ba 66 1b
         a4 85 eb 46 07 c5 65 f8 8b 60 ec 2d 4d ce ae f5

      hash (32 octets):  4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d 02
         42 26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d
         02 42 26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      output (32 octets):  4c 6f 8c 5a e1 31 f0 68 b2 11 90 a7 ed 0a 03
         12 f4 73 e0 91 cb 22 38 92 e4 fb 4d 27 38 9f 15 9f



Thomson                 Expires December 31, 2018              [Page 55]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  0a 51 96 c0 66 5d de 4e 0a 09 e7 e8 e1 ba 66 1b
         a4 85 eb 46 07 c5 65 f8 8b 60 ec 2d 4d ce ae f5

      hash (32 octets):  4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d 02
         42 26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 4a f0 d9 76 d7 09 26 72 13 cd a9 e7 53 36 4d 02 42
         26 e8 10 9f 54 a7 1c 4f 67 84 b2 d2 59 b7 33

      output (32 octets):  c5 68 96 1f 0c 68 6d 5c a6 e4 bb 73 42 f6 c0
         05 9e 14 83 7e 9a e2 c0 9b d6 27 48 13 46 f5 75 72

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  4c 6f 8c 5a e1 31 f0 68 b2 11 90 a7 ed 0a 03 12
         f4 73 e0 91 cb 22 38 92 e4 fb 4d 27 38 9f 15 9f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  84 a2 ff 6a c2 23 63 95 8f b9 e4 25 03 d6
         40 12

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  a4 29 dd e1 8a b1 9f 14 a6 b4 3a 8b

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  18 01 f7 4f e5 16 f1 cd 17 18 e2 82 e4 ca 7c 8c
         d9 98 d2 a8 2f fd 51 30 b8 6c 7b d2 9e 09 dc af

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  c2 ea d1 f5 3f 9a 85 89 4b fd f8 d3 0a ac
         e7 fb

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  73 51 df da f9 a7 e1 e2 14 a3 2e 9a

   {client}  extract secret "early":

      salt:  (absent)





Thomson                 Expires December 31, 2018              [Page 56]

Internet-Draft               TLS 1.3 Traces                    June 2018


      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      output (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6
         97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  3a fd 77 2a 2a 78 0a 64 13 b6 6e 3a 28 78 dc d1
         01 77 3e 26 db 00 76 1e 38 30 0a d7 c0 f9 ac 40

      secret (32 octets):  a9 87 e2 1d aa 09 0c d5 68 6c 55 e4 67 b0 ae
         f8 20 5b c0 4d 27 86 b0 93 6e 0c 3d 7b 70 92 e9 0a

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server)

   {client}  derive read traffic keys for handshake data:

      PRK (32 octets):  51 f2 03 d8 13 92 bf 03 02 c7 2f bb 98 d7 fd c5
         60 fb 9a 00 56 c6 32 c5 59 da fd 33 74 e0 2f 2b

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00





Thomson                 Expires December 31, 2018              [Page 57]

Internet-Draft               TLS 1.3 Traces                    June 2018


      key output (16 octets):  4f d1 27 29 ce 0a ba a4 40 e1 b0 06 fa 0f
         bc 4f

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  49 cf f4 cb 51 39 78 3f 61 57 f0 fa

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send change_cipher_spec record:

      payload (1 octets):  01

      ciphertext (6 octets):  14 03 03 00 01 01

   {client}  derive write traffic keys for handshake data (same as
      server read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  18 01 f7 4f e5 16 f1 cd 17 18 e2 82 e4 ca 7c 8c
         d9 98 d2 a8 2f fd 51 30 b8 6c 7b d2 9e 09 dc af

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      output (32 octets):  2e 29 93 45 c0 07 14 84 a3 6e 24 d8 ce 2b e2
         2a 9f ef 1b 15 d1 64 f3 0d a2 bc 62 fe 05 dd 43 40

   {client}  send a Finished handshake message

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 0e ea ff 5e 63 21 f8 fb 35 f3 6c
         04 a0 69 dc d9 45 5b c6 0b 7a db 4e 94 8b 79 9e 4b 19 33 6b 97





Thomson                 Expires December 31, 2018              [Page 58]

Internet-Draft               TLS 1.3 Traces                    June 2018


      ciphertext (58 octets):  17 03 03 00 35 68 51 79 48 42 99 0d 8c 97
         e1 04 73 83 c3 77 eb df 0a d4 5a 22 39 92 65 c4 b6 08 92 31 21
         6a 46 79 ef b2 09 66 c9 b6 48 4a ee 2c 89 0a e3 f1 b7 9b 9d e7
         71 ff

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  46 44 8c a8 d3 e2 66 ae 66 a4 c4 77 4b c6 63 6d
         a0 10 71 a2 e3 bc f9 3b 76 67 34 41 b5 97 c3 4b

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key output (16 octets):  44 bf 98 ce 02 b0 5e 49 e7 84 54 f2 51 e4
         3a 27

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv output (12 octets):  f0 4d 31 79 50 cb 18 cd 17 93 6e 72

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  0a 51 96 c0 66 5d de 4e 0a 09 e7 e8 e1 ba 66 1b
         a4 85 eb 46 07 c5 65 f8 8b 60 ec 2d 4d ce ae f5

      hash (32 octets):  ca 4a 07 d2 e8 19 7b 85 55 36 d2 ba 7e 66 b2 b2
         d4 04 67 0f 78 73 a1 7d 25 2d 61 60 8d 0c 0e bb

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 ca 4a 07 d2 e8 19 7b 85 55 36 d2 ba 7e 66 b2 b2 d4
         04 67 0f 78 73 a1 7d 25 2d 61 60 8d 0c 0e bb

      output (32 octets):  dc 94 30 57 3d ad 07 6d 99 61 b4 23 d5 6b c5
         13 53 17 7b b5 4e 66 0c af f3 b3 49 1d e3 ff 99 67

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 a7 da ad 44 cd fc 47 0b 09
         6f 64 92 8f 43 86 3c a4 a9 30




Thomson                 Expires December 31, 2018              [Page 59]

Internet-Draft               TLS 1.3 Traces                    June 2018


   {server}  send alert record:

      payload (2 octets):  01 00

      ciphertext (24 octets):  17 03 03 00 13 1c f9 02 30 b2 cb dd be 19
         66 04 95 bf 63 30 72 f1 98 db

8.  Security Considerations

   It probably isn't a good idea to use the private key here.  If it
   weren't for the fact that it is too small to provide any meaningful
   security, it is now very well known.

9.  IANA Considerations

   This document makes no requests of IANA.

10.  References

10.1.  Normative References

   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-21 (work in progress),
              July 2017.

10.2.  Informative References

   [FIPS186]  National Institute of Standards and Technology (NIST),
              "Digital Signature Standard (DSS)", NIST PUB 186-4 , July
              2013.

   [RFC5869]  Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-Expand
              Key Derivation Function (HKDF)", RFC 5869,
              DOI 10.17487/RFC5869, May 2010,
              <https://www.rfc-editor.org/info/rfc5869>.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

10.3.  URIs

   [1] https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS








Thomson                 Expires December 31, 2018              [Page 60]

Internet-Draft               TLS 1.3 Traces                    June 2018


Appendix A.  Acknowledgements

   This draft is generated using tests that were written for NSS [1].
   None of this would have been possible without Franziskus Kiefer, Eric
   Rescorla and Tim Taubert, who did a lot of the work in NSS.

Author's Address

   Martin Thomson
   Mozilla

   Email: martin.thomson@gmail.com







































Thomson                 Expires December 31, 2018              [Page 61]
