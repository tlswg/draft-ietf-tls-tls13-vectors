



TLS                                                           M. Thomson
Internet-Draft                                                   Mozilla
Intended status: Informational                           August 01, 2018
Expires: February 2, 2019


                  Example Handshake Traces for TLS 1.3
                  draft-ietf-tls-tls13-vectors-latest

Abstract

   Examples of TLS 1.3 handshakes are shown.  Private keys and inputs
   are provided so that these handshakes might be reproduced.
   Intermediate values, including secrets, traffic keys and IVs are
   shown so that implementations might be checked incrementally against
   these values.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 2, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Thomson                 Expires February 2, 2019                [Page 1]

Internet-Draft               TLS 1.3 Traces                  August 2018


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Private Keys  . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  Simple 1-RTT Handshake  . . . . . . . . . . . . . . . . . . .   3
   4.  Resumed 0-RTT Handshake . . . . . . . . . . . . . . . . . . .  16
   5.  HelloRetryRequest . . . . . . . . . . . . . . . . . . . . . .  28
   6.  Client Authentication . . . . . . . . . . . . . . . . . . . .  42
   7.  Compatibility Mode  . . . . . . . . . . . . . . . . . . . . .  54
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  65
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  65
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  65
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  65
     10.2.  Informative References . . . . . . . . . . . . . . . . .  65
   Appendix A.  Acknowledgements . . . . . . . . . . . . . . . . . .  66
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  66

1.  Introduction

   TLS 1.3 [TLS13] defines a new key schedule and a number of new
   cryptographic operations.  This document includes sample handshakes
   that show all intermediate values.  This allows an implementation to
   be verified incrementally, examining inputs and outputs of each
   cryptographic computation independently.

   A private key is included with the traces so that implementations can
   be checked by importing these values and verifying that the same
   outputs are produced.

   Note:  Invocations of HMAC-based Extract-and-Expand Key Derivation
      Function (HKDF) [RFC5869] are not labelled, but can be identified
      through the use of the labels used by HKDF.

2.  Private Keys

   Ephemeral private keys are shown as they are generated in the traces.

   The server in most examples uses an RSA certificate with a private
   key of:

   modulus (public):  b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c
      0c 68 de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab
      bc 9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
      a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f
      da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0
      3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e
      3f




Thomson                 Expires February 2, 2019                [Page 2]

Internet-Draft               TLS 1.3 Traces                  August 2018


   public exponent:  01 00 01

   private exponent:  04 de a7 05 d4 3a 6e a7 20 9d d8 07 21 11 a8 3c 81
      e3 22 a5 92 78 b3 34 80 64 1e af 7c 0a 69 85 b8 e3 1c 44 f6 de 62
      e1 b4 c2 30 9f 61 26 e7 7b 7c 41 e9 23 31 4b bf a3 88 13 05 dc 12
      17 f1 6c 81 9c e5 38 e9 22 f3 69 82 8d 0e 57 19 5d 8c 84 88 46 02
      07 b2 fa a7 26 bc f7 08 bb d7 db 7f 67 9f 89 34 92 fc 2a 62 2e 08
      97 0a ac 44 1c e4 e0 c3 08 8d f2 5a e6 79 23 3d f8 a3 bd a2 ff 99
      41

   prime1:  e4 35 fb 7c c8 37 37 75 6d ac ea 96 ab 7f 59 a2 cc 10 69 db
      7d eb 19 0e 17 e3 3a 53 2b 27 3f 30 a3 27 aa 0a aa bc 58 cd 67 46
      6a f9 84 5f ad c6 75 fe 09 4a f9 2c 4b d1 f2 c1 bc 33 dd 2e 05 15

   prime2:  ca bd 3b c0 e0 43 86 64 c8 d4 cc 9f 99 97 7a 94 d9 bb fe ad
      8e 43 87 0a ba e3 f7 eb 8b 4e 0e ee 8a f1 d9 b4 71 9b a6 19 6c f2
      cb ba ee eb f8 b3 49 0a fe 9e 9f fa 74 a8 8a a5 1f c6 45 62 93 03

   exponent1:  3f 57 34 5c 27 fe 1b 68 7e 6e 76 16 27 b7 8b 1b 82 64 33
      dd 76 0f a0 be a6 a6 ac f3 94 90 aa 1b 47 cd a4 86 9d 68 f5 84 dd
      5b 50 29 bd 32 09 3b 82 58 66 1f e7 15 02 5e 5d 70 a4 5a 08 d3 d3
      19

   exponent2:  18 3d a0 13 63 bd 2f 28 85 ca cb dc 99 64 bf 47 64 f1 51
      76 36 f8 64 01 28 6f 71 89 3c 52 cc fe 40 a6 c2 3d 0d 08 6b 47 c6
      fb 10 d8 fd 10 41 e0 4d ef 7e 9a 40 ce 95 7c 41 77 94 e1 04 12 d1
      39

   coefficient:  83 9c a9 a0 85 e4 28 6b 2c 90 e4 66 99 7a 2c 68 1f 21
      33 9a a3 47 78 14 e4 de c1 18 33 05 0e d5 0d d1 3c c0 38 04 8a 43
      c5 9b 2a cc 41 68 89 c0 37 66 5f e5 af a6 05 96 9f 8c 01 df a5 ca
      96 9d

3.  Simple 1-RTT Handshake

   In this example, the simplest possible handshake is completed.  The
   server is authenticated, but the client remains anonymous.  After
   connecting, a few application data octets are exchanged.  The server
   sends a session ticket that permits the use of 0-RTT data in any
   resumed session.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  29 15 06 f3 fa dd cc 57 98 8f 7d 8a 1a
         28 1f 00 a9 f6 f1 33 1a 90 3f e2 9b e3 80 24 eb e4 ca 22

      public key (32 octets):  85 57 d0 49 c4 1c 55 2e 52 3d 41 ff f9 08
         e5 c0 57 c9 2b 1d c2 08 0a 3d 30 7b 2d 8f 34 a8 fe 1d



Thomson                 Expires February 2, 2019                [Page 3]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {client}  construct a ClientHello handshake message

      ClientHello (196 octets):  01 00 00 c0 03 03 fc 5b 66 2c 22 64 78
         4e 29 8c c0 0a e2 76 a1 80 92 a0 33 b0 69 9b 13 83 48 28 d2 44
         37 90 40 5f 00 00 06 13 01 13 03 13 02 01 00 00 91 00 00 00 0b
         00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23
         00 00 00 33 00 26 00 24 00 1d 00 20 85 57 d0 49 c4 1c 55 2e 52
         3d 41 ff f9 08 e5 c0 57 c9 2b 1d c2 08 0a 3d 30 7b 2d 8f 34 a8
         fe 1d 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03
         02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06
         02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {client}  send handshake record:

      payload (196 octets):  01 00 00 c0 03 03 fc 5b 66 2c 22 64 78 4e
         29 8c c0 0a e2 76 a1 80 92 a0 33 b0 69 9b 13 83 48 28 d2 44 37
         90 40 5f 00 00 06 13 01 13 03 13 02 01 00 00 91 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 23 00
         00 00 33 00 26 00 24 00 1d 00 20 85 57 d0 49 c4 1c 55 2e 52 3d
         41 ff f9 08 e5 c0 57 c9 2b 1d c2 08 0a 3d 30 7b 2d 8f 34 a8 fe
         1d 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      complete record (201 octets):  16 03 01 00 c4 01 00 00 c0 03 03 fc
         5b 66 2c 22 64 78 4e 29 8c c0 0a e2 76 a1 80 92 a0 33 b0 69 9b
         13 83 48 28 d2 44 37 90 40 5f 00 00 06 13 01 13 03 13 02 01 00
         00 91 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01
         00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02
         01 03 01 04 00 23 00 00 00 33 00 26 00 24 00 1d 00 20 85 57 d0
         49 c4 1c 55 2e 52 3d 41 ff f9 08 e5 c0 57 c9 2b 1d c2 08 0a 3d
         30 7b 2d 8f 34 a8 fe 1d 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:



Thomson                 Expires February 2, 2019                [Page 4]

Internet-Draft               TLS 1.3 Traces                  August 2018


      private key (32 octets):  5f 27 26 fb f9 3c 30 6e 0f 26 8a 31 18
         ef f3 c7 6e 97 ba 5d 3a 51 5f 36 36 1f 0c a8 99 30 e8 63

      public key (32 octets):  1a e1 c4 13 ce cc 1c 2f 08 09 a1 cf 5f a0
         10 69 cf d7 8e cd dc c7 95 99 11 12 e2 fd 44 99 8d 5e

   {server}  construct a ServerHello handshake message

      ServerHello (90 octets):  02 00 00 56 03 03 af 7b 8e 30 e4 df f9
         ff 5a f4 80 26 95 1f 4c 27 f4 de b8 eb 64 0b 8c a1 a2 36 c4 db
         4f 01 a0 ad 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 1a e1 c4
         13 ce cc 1c 2f 08 09 a1 cf 5f a0 10 69 cf d7 8e cd dc c7 95 99
         11 12 e2 fd 44 99 8d 5e 00 2b 00 02 7f 1c

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  15 50 ea 55 7a 24 75 34 2a e1 e3 7f c1 eb ef 7e
         4a 6e a1 83 13 1d a3 63 84 75 17 0a a5 7e d0 5d

      secret (32 octets):  97 71 ea 98 b5 ab 53 23 0b 80 2f 33 50 86 09
         7c a9 b3 44 78 04 b2 22 60 eb 8d 42 b7 87 33 ff 0c

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  97 71 ea 98 b5 ab 53 23 0b 80 2f 33 50 86 09 7c
         a9 b3 44 78 04 b2 22 60 eb 8d 42 b7 87 33 ff 0c

      hash (32 octets):  41 cc 03 6e dc 6f 25 4a 95 8f a9 51 ec 61 c3 a9
         d4 1e ae 90 8c f4 6e 5e c7 85 70 83 56 84 52 e3




Thomson                 Expires February 2, 2019                [Page 5]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 41 cc 03 6e dc 6f 25 4a 95 8f a9 51 ec 61 c3
         a9 d4 1e ae 90 8c f4 6e 5e c7 85 70 83 56 84 52 e3

      expanded (32 octets):  f6 52 cf 3d 92 16 06 38 21 3c 88 2c eb 32
         16 7f 03 85 fe 02 43 e7 80 e3 33 c0 d8 00 dc 41 32 a6

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  97 71 ea 98 b5 ab 53 23 0b 80 2f 33 50 86 09 7c
         a9 b3 44 78 04 b2 22 60 eb 8d 42 b7 87 33 ff 0c

      hash (32 octets):  41 cc 03 6e dc 6f 25 4a 95 8f a9 51 ec 61 c3 a9
         d4 1e ae 90 8c f4 6e 5e c7 85 70 83 56 84 52 e3

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 41 cc 03 6e dc 6f 25 4a 95 8f a9 51 ec 61 c3
         a9 d4 1e ae 90 8c f4 6e 5e c7 85 70 83 56 84 52 e3

      expanded (32 octets):  f5 d7 58 50 6a 2a f3 16 7f 3a 35 b5 9b fe
         b7 e4 ee 49 69 a9 96 ce 1e 2f 1f 85 a5 99 90 0b b9 4e

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  97 71 ea 98 b5 ab 53 23 0b 80 2f 33 50 86 09 7c
         a9 b3 44 78 04 b2 22 60 eb 8d 42 b7 87 33 ff 0c

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  40 bf 9a 94 48 2d d6 9a 27 65 a2 01 5e db
         32 18 30 02 5e 1e 19 bd 70 fc 0d 8b fd 60 55 cd a0 f4

   {server}  extract secret "master":

      salt (32 octets):  40 bf 9a 94 48 2d d6 9a 27 65 a2 01 5e db 32 18
         30 02 5e 1e 19 bd 70 fc 0d 8b fd 60 55 cd a0 f4

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  5b cc 45 0c 94 76 76 63 da 98 0f cd 58 c5 5b
         83 36 6f 40 d5 4a 68 9e a6 8c 54 ee 2a 02 de c7 e0




Thomson                 Expires February 2, 2019                [Page 6]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 af 7b 8e 30 e4 df f9 ff 5a
         f4 80 26 95 1f 4c 27 f4 de b8 eb 64 0b 8c a1 a2 36 c4 db 4f 01
         a0 ad 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 1a e1 c4 13 ce
         cc 1c 2f 08 09 a1 cf 5f a0 10 69 cf d7 8e cd dc c7 95 99 11 12
         e2 fd 44 99 8d 5e 00 2b 00 02 7f 1c

      complete record (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 af
         7b 8e 30 e4 df f9 ff 5a f4 80 26 95 1f 4c 27 f4 de b8 eb 64 0b
         8c a1 a2 36 c4 db 4f 01 a0 ad 00 13 01 00 00 2e 00 33 00 24 00
         1d 00 20 1a e1 c4 13 ce cc 1c 2f 08 09 a1 cf 5f a0 10 69 cf d7
         8e cd dc c7 95 99 11 12 e2 fd 44 99 8d 5e 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  f5 d7 58 50 6a 2a f3 16 7f 3a 35 b5 9b fe b7 e4
         ee 49 69 a9 96 ce 1e 2f 1f 85 a5 99 90 0b b9 4e

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  d9 dd 65 da 2d 25 43 9c 77 1c c9 bb 3f
         4c 0d 7a

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  0b fe d4 d0 1e e8 c9 1d f4 7a c9 03

   {server}  construct a EncryptedExtensions handshake message

      EncryptedExtensions (40 octets):  08 00 00 24 00 22 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c
         00 02 40 01 00 00 00 00

   {server}  construct a Certificate handshake message

      Certificate (445 octets):  0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93



Thomson                 Expires February 2, 2019                [Page 7]

Internet-Draft               TLS 1.3 Traces                  August 2018


         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b
         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00

   {server}  construct a CertificateVerify handshake message

      CertificateVerify (136 octets):  0f 00 00 84 08 04 00 80 20 f0 1d
         fd 62 ed f6 bb 97 85 be 87 ab 1b e1 d6 03 f6 ce 3e 03 28 f0 c5
         77 52 fc 9f 48 1e ce ec bc ef dc b5 ff 04 68 83 ae f0 eb 8e 50
         31 81 af 3f fc 1a de c4 d8 06 58 1b 8c 94 3b 8e 01 10 3f 5c 92
         16 aa cc d0 9e 4c b8 3c 11 b6 f9 43 59 f4 5c cb 69 d9 70 bc cc
         8b 54 37 96 8a b3 82 bb 44 02 36 34 6b bc 46 2f df b1 7a 56 96
         e6 60 f6 3b 43 ad 34 f1 9d d8 a2 03 1b b8 c0 04 40 91 ca 43

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  f5 d7 58 50 6a 2a f3 16 7f 3a 35 b5 9b fe b7 e4
         ee 49 69 a9 96 ce 1e 2f 1f 85 a5 99 90 0b b9 4e

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  7a b7 68 0a b4 7e 77 3f 62 61 61 69 94 65
         90 dd b6 18 75 8c 92 75 66 e9 56 52 f5 ae 4c 03 3f 0c

   {server}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 fd fe 86 91 a5 58 0c a6 b4 2c
         2c 25 c9 ec 56 a5 60 4f 1e 3f ea ee 28 f9 80 c9 d1 10 6c 57 50
         51

   {server}  send handshake record:

      payload (657 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30
         82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d
         01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36



Thomson                 Expires February 2, 2019                [Page 8]

Internet-Draft               TLS 1.3 Traces                  August 2018


         30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04
         03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01
         01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30
         3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a
         24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e
         aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01
         8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53
         0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab
         9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01
         a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d
         0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05
         00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17
         06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5
         8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72
         60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63
         a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84
         e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29
         ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 20 f0 1d fd
         62 ed f6 bb 97 85 be 87 ab 1b e1 d6 03 f6 ce 3e 03 28 f0 c5 77
         52 fc 9f 48 1e ce ec bc ef dc b5 ff 04 68 83 ae f0 eb 8e 50 31
         81 af 3f fc 1a de c4 d8 06 58 1b 8c 94 3b 8e 01 10 3f 5c 92 16
         aa cc d0 9e 4c b8 3c 11 b6 f9 43 59 f4 5c cb 69 d9 70 bc cc 8b
         54 37 96 8a b3 82 bb 44 02 36 34 6b bc 46 2f df b1 7a 56 96 e6
         60 f6 3b 43 ad 34 f1 9d d8 a2 03 1b b8 c0 04 40 91 ca 43 14 00
         00 20 fd fe 86 91 a5 58 0c a6 b4 2c 2c 25 c9 ec 56 a5 60 4f 1e
         3f ea ee 28 f9 80 c9 d1 10 6c 57 50 51

      complete record (679 octets):  17 03 03 02 a2 01 12 69 7e ca a4 49
         b3 42 8d ca 09 eb 23 52 11 db 2b 5a 38 bc 9a 11 9b 24 40 d5 35
         2e ed 15 d3 f3 84 a6 75 7e 3d dc eb 93 7a 2a 87 bb 89 18 4c 2c
         4d a5 1e 0b bf 0f b1 3b 26 c2 82 de 48 c2 80 9d f2 37 97 86 36
         66 44 e1 1b 89 35 b9 d3 5f 10 8c 6c 1f c8 bd 3b c9 01 8f a6 0d
         67 ba 3b be 53 5b ea f8 c0 df 35 a3 e3 f5 64 3a d6 32 98 7f 40
         a9 87 6d da 09 0d c7 48 55 d4 15 15 01 df 53 92 ac 7d 9a 6e 75
         9e af 6a 6a 3d 7b a7 e6 9e ed 5f d1 17 2b 0e 4f e5 cb 89 8b b3
         9a ab 7c b7 55 f1 19 87 2f 5d e7 95 7e 9e f9 d5 52 df 04 50 12
         a3 1a 6a ef 88 52 6d 5d f7 b6 89 58 06 d0 dd 94 e5 7a 30 7a 8a
         63 69 aa 56 5d f0 8a 2d 1e 08 91 d0 da ac 1e 1d 29 9d cd ea 26
         0a 39 9a 0a 35 cf ac ed 7f 66 3f 3c 5c 52 f4 41 88 f3 bc 9b 8e
         33 46 81 dd 31 f1 af df 4f e6 0e a9 60 03 8d 9e d6 52 d8 62 07
         d0 8a 1b 48 23 f1 4b a0 1f 7b 8b 67 7b 8d c9 0d 7d 18 6a e3 5e
         16 be 30 fe 38 9a 09 7b 91 c1 ab ed 4c 4f 13 80 bf fe 87 bb 81
         11 30 49 53 b7 b4 ba b2 e3 d4 30 33 33 88 d6 fc 8b 4e c7 1c b0
         f3 c7 fe 5f a2 2c 1a 93 fe 35 a1 bf 3a 32 71 ee 5e 38 e4 aa cf
         e1 a9 72 0d d8 65 c8 ee a2 6b be 33 7c e8 7a 3f 2a b0 0f c4 5c
         0e 58 f6 a3 da 76 0d da 83 88 d0 a8 b8 c1 9c 3e 70 01 08 14 c2
         40 05 81 44 5e f0 6d 32 80 45 aa 89 16 9c 39 68 0e a3 20 dd 4c
         a9 29 d0 a8 fe 5f e2 58 91 29 fe 47 bc 23 88 4e b3 0e d8 56 5b



Thomson                 Expires February 2, 2019                [Page 9]

Internet-Draft               TLS 1.3 Traces                  August 2018


         47 20 06 35 85 39 46 26 f3 79 2b 48 27 99 f1 06 d5 16 68 96 de
         0f 26 45 26 8e cf 50 ce 1c 60 ac a8 ee ec d6 10 b3 d6 0c 27 c7
         34 6d c9 f6 e5 02 ae ee 91 55 b5 8c b3 e8 b2 54 da 03 e5 c4 bf
         b7 15 39 7b 43 2c 9a db d5 c0 48 a6 93 c7 f5 3e 0b c3 13 1e 70
         bc 1c 19 1e b1 a1 b7 5a 31 13 2e 94 e4 f0 51 33 e4 35 f3 47 0e
         47 a2 62 06 37 e6 9b f3 10 ec 6e cc 47 a7 58 99 db 26 84 48 8d
         33 bf 5b 83 7e fa a6 83 6b fe b9 0a 63 c3 04 56 36 1a e7 f0 85
         b6 67 94 3c d6 4d 95 5e 8e bf 79 76 a2 9e 0f ae 38 63 e2 e4 61
         5d 3c d8 5f cd 51 8d 5b bd d1 11 ab ba b6 cb b1 e0 ba 3d 1a 8e
         be 1d 51 99 d0 f7 c4 93 39 69 9f ae 9c 30 dc b6 e8 82 0d e3 6e
         ca b8 62 9c 96 da 65 cd 78 b8 7e a5 4b 8c 26 c2 3f ab a5 04 cc
         52 87 44 26 52 e6 23 6f 08 05 0b cd 52 c2 ee c6

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  5b cc 45 0c 94 76 76 63 da 98 0f cd 58 c5 5b 83
         36 6f 40 d5 4a 68 9e a6 8c 54 ee 2a 02 de c7 e0

      hash (32 octets):  76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6 3f
         48 24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6
         3f 48 24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      expanded (32 octets):  4f 59 fa ca 21 63 02 e7 e8 78 6a 3d f9 d0
         55 dd f1 b9 a5 ea 4d 06 8b 61 11 66 ad bf 24 62 20 dc

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  5b cc 45 0c 94 76 76 63 da 98 0f cd 58 c5 5b 83
         36 6f 40 d5 4a 68 9e a6 8c 54 ee 2a 02 de c7 e0

      hash (32 octets):  76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6 3f
         48 24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6
         3f 48 24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      expanded (32 octets):  1e c1 5e 33 f4 cb a6 ae dc b3 7b e1 e4 f7
         c3 cf 1a 71 b6 65 98 f2 7c 26 a9 f7 8e ee 23 d6 35 5a

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  5b cc 45 0c 94 76 76 63 da 98 0f cd 58 c5 5b 83
         36 6f 40 d5 4a 68 9e a6 8c 54 ee 2a 02 de c7 e0




Thomson                 Expires February 2, 2019               [Page 10]

Internet-Draft               TLS 1.3 Traces                  August 2018


      hash (32 octets):  76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6 3f
         48 24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 76 7e 51 9f 1f 0f b4 17 b6 57 65 e5 51 e7 d6 3f 48
         24 4a 8d 07 72 d9 80 87 6d 58 8b 12 41 39 56

      expanded (32 octets):  6f 57 f4 fd 14 fc 11 d4 b1 4f 5c 17 93 c9
         b4 05 6e 92 97 9e 7a 85 8d 51 8a b4 dd 0c 3c 8b 92 32

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  1e c1 5e 33 f4 cb a6 ae dc b3 7b e1 e4 f7 c3 cf
         1a 71 b6 65 98 f2 7c 26 a9 f7 8e ee 23 d6 35 5a

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  5c f5 33 3b ac 6b 40 da 0c ab d1 7d e9
         57 14 41

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  fe b4 30 5e 63 d6 e7 49 6e c7 16 fa

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  f6 52 cf 3d 92 16 06 38 21 3c 88 2c eb 32 16 7f
         03 85 fe 02 43 e7 80 e3 33 c0 d8 00 dc 41 32 a6

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  c6 91 d5 b0 22 20 18 37 83 4e 5e 6c 8a
         66 5c 3c

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  86 de 4c 2f 3e a3 8d 9f d8 fd e8 d9

   {client}  extract secret "early" (same as server early secret)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55




Thomson                 Expires February 2, 2019               [Page 11]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake" (same as server handshake
      secret)

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server master secret)

   {client}  derive read traffic keys for handshake data (same as server
      handshake data write traffic keys)

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server handshake data read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server application data write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  f6 52 cf 3d 92 16 06 38 21 3c 88 2c eb 32 16 7f
         03 85 fe 02 43 e7 80 e3 33 c0 d8 00 dc 41 32 a6

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  79 2e 9b df 46 42 db 58 df a4 f1 91 8a 91
         24 09 4b 3b 9c 45 71 9e f5 31 bb d7 db e2 32 49 0b cd




Thomson                 Expires February 2, 2019               [Page 12]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {client}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 a3 ec 53 65 8a d0 e1 ce ce a2
         64 4f 73 39 4e ea 55 8b 52 2f dd 5b 8b cd 3b cc 46 8d fa 69 85
         40

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 a3 ec 53 65 8a d0 e1 ce ce a2 64
         4f 73 39 4e ea 55 8b 52 2f dd 5b 8b cd 3b cc 46 8d fa 69 85 40

      complete record (58 octets):  17 03 03 00 35 37 78 4d af a6 3e d0
         10 04 db 46 67 53 82 c5 b7 c5 6e c9 f1 2f d8 6d ae 3f bc 22 3a
         4f 28 ee 4c 8e 86 02 5b 95 12 61 73 ad a6 c2 65 b4 34 b4 db 8a
         83 61 05 bb

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  4f 59 fa ca 21 63 02 e7 e8 78 6a 3d f9 d0 55 dd
         f1 b9 a5 ea 4d 06 8b 61 11 66 ad bf 24 62 20 dc

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  a3 5f 4a 7a 8d 2e f3 3f 2d 49 87 0f 8a
         34 24 fc

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  f1 c0 8e fb fc a9 73 7b 08 c9 32 a2

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  5b cc 45 0c 94 76 76 63 da 98 0f cd 58 c5 5b 83
         36 6f 40 d5 4a 68 9e a6 8c 54 ee 2a 02 de c7 e0

      hash (32 octets):  82 ce 15 22 d1 aa bc 66 5b d8 12 20 19 7b 47 a9
         1e 0a 21 8b a6 fc 4e 5f 38 dd 3a e1 f9 9a f6 02

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 82 ce 15 22 d1 aa bc 66 5b d8 12 20 19 7b 47 a9 1e
         0a 21 8b a6 fc 4e 5f 38 dd 3a e1 f9 9a f6 02

      expanded (32 octets):  ae b0 1f 3c b3 49 83 3d 3f ee cb c6 ab ad
         d9 3d 8e d1 14 58 56 15 55 b0 9f 45 00 c8 f6 f1 26 19

   {server}  calculate finished "tls13 finished" (same as client)





Thomson                 Expires February 2, 2019               [Page 13]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  derive read traffic keys for application data (same as
      client application data write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {server}  generate resumption secret "tls13 resumption":

      PRK (32 octets):  ae b0 1f 3c b3 49 83 3d 3f ee cb c6 ab ad d9 3d
         8e d1 14 58 56 15 55 b0 9f 45 00 c8 f6 f1 26 19

      hash (2 octets):  00 00

      info (22 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 75 6d 70 74
         69 6f 6e 02 00 00

      expanded (32 octets):  c5 40 1b d5 a7 9f 9d 16 59 60 fd 8b af 6c
         8c 13 c6 a9 e0 5f ba 48 3b c6 a4 dc 6a 08 ff 0c 03 8e

   {server}  construct a NewSessionTicket handshake message

      NewSessionTicket (205 octets):  04 00 00 c9 00 00 00 1e 9b e2 5f
         74 02 00 00 00 b2 f8 1e c2 67 63 6e d6 fe da a0 16 b7 00 00 00
         00 be c4 bd 6a 4f 28 c4 b6 f9 b9 67 b5 91 cb e2 dd 00 70 e9 d9
         29 6b 7d a7 94 86 ee 4b 18 a3 26 b1 80 41 7d a4 5c 8a a0 29 27
         56 11 d5 ea 77 c0 86 85 d4 5d 67 a4 fa e7 06 78 89 ba 29 eb 1c
         7b db ee 7e 7a 29 04 16 19 42 e5 ce 83 77 a8 0b 74 8b ed 03 43
         47 3e 7f 08 c2 e5 1c 78 b4 50 b6 39 3a 3a dc 5c 06 28 b5 af b5
         ec a0 54 f0 d2 73 04 6c 4a 91 a0 48 c2 f2 83 2f 05 cd 59 3b 8c
         be 64 8d 2f 11 e5 33 7a af 0f ea 8a 4a 9d 24 de 3e 4b aa 7e bb
         b2 65 05 2a b1 19 dd 36 46 82 7a 25 8d 21 89 c8 00 08 00 2a 00
         04 00 00 04 00

   {server}  send handshake record:

      payload (205 octets):  04 00 00 c9 00 00 00 1e 9b e2 5f 74 02 00
         00 00 b2 f8 1e c2 67 63 6e d6 fe da a0 16 b7 00 00 00 00 be c4
         bd 6a 4f 28 c4 b6 f9 b9 67 b5 91 cb e2 dd 00 70 e9 d9 29 6b 7d
         a7 94 86 ee 4b 18 a3 26 b1 80 41 7d a4 5c 8a a0 29 27 56 11 d5
         ea 77 c0 86 85 d4 5d 67 a4 fa e7 06 78 89 ba 29 eb 1c 7b db ee
         7e 7a 29 04 16 19 42 e5 ce 83 77 a8 0b 74 8b ed 03 43 47 3e 7f
         08 c2 e5 1c 78 b4 50 b6 39 3a 3a dc 5c 06 28 b5 af b5 ec a0 54
         f0 d2 73 04 6c 4a 91 a0 48 c2 f2 83 2f 05 cd 59 3b 8c be 64 8d
         2f 11 e5 33 7a af 0f ea 8a 4a 9d 24 de 3e 4b aa 7e bb b2 65 05
         2a b1 19 dd 36 46 82 7a 25 8d 21 89 c8 00 08 00 2a 00 04 00 00
         04 00

      complete record (227 octets):  17 03 03 00 de e7 df 60 63 6e 13 88
         bf 3f 0c ec 73 a0 5d da 1b 8a 16 e8 21 3c 0c d6 0c 2e e9 0d 7c



Thomson                 Expires February 2, 2019               [Page 14]

Internet-Draft               TLS 1.3 Traces                  August 2018


         86 ca ba 60 b2 e8 45 12 55 41 49 a8 f9 a1 b2 cb d4 60 7e d8 d0
         94 41 ac 06 63 7e 4c b3 f5 d9 92 60 3c 28 05 22 99 00 08 0b c8
         59 11 50 47 05 63 99 24 ff 92 90 b6 fb 09 ef c8 7f e2 3a 6c 73
         d7 50 67 b6 63 43 ab 1c 2d bb 81 2d 7b 13 b9 1b c1 cc 01 91 58
         b0 6f a0 2c 38 e8 b4 35 8f ab 21 21 36 fd dc 35 38 cf 5b c8 11
         c7 aa d6 3a a6 42 bd 1c 76 2a e2 f1 6a fa c0 83 c0 b0 92 08 94
         85 f6 bf 84 c5 2a 11 fe b2 07 49 bb 47 7b 8b f3 57 f1 ec c8 7c
         9f 31 34 c0 32 06 4a f3 9c 18 ff d0 3f 56 58 c2 6b ae 3f 0a e8
         5a 53 13 8e 42 68 f6 a7 14 b5 55 84 ec f4 d3 f5 4f 9d d9 6a 02
         a1 4b c1 fc 66

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      complete record (72 octets):  17 03 03 00 43 29 55 66 43 b6 2e cd
         99 86 d8 0d c2 0e 0d 7c 85 fb be bd 5c 27 71 4b 47 0e 47 a7 1d
         4b 8c 6f 1e 54 8d ef 4e 6d 39 d0 51 d6 81 71 e9 09 fd c6 a0 73
         5f 79 c6 f8 33 06 14 19 c5 0c 02 0f 7f f1 db bc fd 5b

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      complete record (72 octets):  17 03 03 00 43 d1 54 29 86 76 a9 17
         ef 85 83 b8 a5 37 b6 3e 18 65 02 e1 93 87 ba 0b 04 22 08 c0 28
         9b ef bc ce cb fc 24 a9 f5 08 5d 2a 37 37 2e 66 c3 60 4a b4 4c
         0f 3c 08 87 8f bc 10 fd 0b ed 68 ac cc ba 60 27 1a 85

   {client}  generate resumption secret "tls13 resumption" (same as
      server)

   {client}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 b9 b4 d7 4f 87 9d 31
         4d ec c6 36 30 a4 43 50 94 aa dd 7f

   {server}  send alert record:

      payload (2 octets):  01 00





Thomson                 Expires February 2, 2019               [Page 15]

Internet-Draft               TLS 1.3 Traces                  August 2018


      complete record (24 octets):  17 03 03 00 13 47 23 08 64 76 ee 1a
         67 5c bc 0c 51 2b 3a 41 2f 7c 2d 44

4.  Resumed 0-RTT Handshake

   This handshake resumes from the handshake in Section 3.  Since the
   server provided a session ticket that permitted 0-RTT, and the client
   is configured for 0-RTT, the client is able to send 0-RTT data.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  cb b8 e3 12 7b 14 5d 8e c3 a9 bb 09 1d
         82 2e 01 d7 41 9d f7 14 12 cd f7 4d 08 66 6e 2a eb 8d a5

      public key (32 octets):  20 b1 4d 94 ef 4c f0 be cf 0a 8a a3 a1 f3
         72 c2 40 c6 a0 09 7a 8d 5f 09 6b 57 9f fc 4f 83 aa 5c

   {client}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  c5 40 1b d5 a7 9f 9d 16 59 60 fd 8b af 6c 8c 13
         c6 a9 e0 5f ba 48 3b c6 a4 dc 6a 08 ff 0c 03 8e

      secret (32 octets):  1a 2c 1c 8a 1f 71 53 42 36 ac be 4f 35 2c 89
         ad 6c b0 34 2c 7c 94 0f 1d 67 27 96 48 f3 30 3a da

   {client}  construct a ClientHello handshake message

      ClientHello (477 octets):  01 00 01 fc 03 03 7b 32 92 8e 7f 1d c5
         02 68 48 6e ea f0 33 e8 e6 18 89 8f 62 33 20 a8 a4 ad 00 48 b9
         fc ac 78 6d 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b
         00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33
         00 26 00 24 00 1d 00 20 20 b1 4d 94 ef 4c f0 be cf 0a 8a a3 a1
         f3 72 c2 40 c6 a0 09 7a 8d 5f 09 6b 57 9f fc 4f 83 aa 5c 00 2a
         00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03
         02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06
         02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01 00 15 00 57 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 29 00 dd 00 b8 00 b2 f8 1e c2 67 63 6e d6 fe da a0 16 b7
         00 00 00 00 be c4 bd 6a 4f 28 c4 b6 f9 b9 67 b5 91 cb e2 dd 00
         70 e9 d9 29 6b 7d a7 94 86 ee 4b 18 a3 26 b1 80 41 7d a4 5c 8a
         a0 29 27 56 11 d5 ea 77 c0 86 85 d4 5d 67 a4 fa e7 06 78 89 ba
         29 eb 1c 7b db ee 7e 7a 29 04 16 19 42 e5 ce 83 77 a8 0b 74 8b



Thomson                 Expires February 2, 2019               [Page 16]

Internet-Draft               TLS 1.3 Traces                  August 2018


         ed 03 43 47 3e 7f 08 c2 e5 1c 78 b4 50 b6 39 3a 3a dc 5c 06 28
         b5 af b5 ec a0 54 f0 d2 73 04 6c 4a 91 a0 48 c2 f2 83 2f 05 cd
         59 3b 8c be 64 8d 2f 11 e5 33 7a af 0f ea 8a 4a 9d 24 de 3e 4b
         aa 7e bb b2 65 05 2a b1 19 dd 36 46 82 7a 25 8d 21 89 c8 9b e2
         5f 79

   {client}  calculate PSK binder:

      ClientHello prefix (477 octets):  01 00 01 fc 03 03 7b 32 92 8e 7f
         1d c5 02 68 48 6e ea f0 33 e8 e6 18 89 8f 62 33 20 a8 a4 ad 00
         48 b9 fc ac 78 6d 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00
         00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00
         14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04
         00 33 00 26 00 24 00 1d 00 20 20 b1 4d 94 ef 4c f0 be cf 0a 8a
         a3 a1 f3 72 c2 40 c6 a0 09 7a 8d 5f 09 6b 57 9f fc 4f 83 aa 5c
         00 2a 00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03
         06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05
         02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01 00 15 00 57
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 29 00 dd 00 b8 00 b2 f8 1e c2 67 63 6e d6 fe da a0
         16 b7 00 00 00 00 be c4 bd 6a 4f 28 c4 b6 f9 b9 67 b5 91 cb e2
         dd 00 70 e9 d9 29 6b 7d a7 94 86 ee 4b 18 a3 26 b1 80 41 7d a4
         5c 8a a0 29 27 56 11 d5 ea 77 c0 86 85 d4 5d 67 a4 fa e7 06 78
         89 ba 29 eb 1c 7b db ee 7e 7a 29 04 16 19 42 e5 ce 83 77 a8 0b
         74 8b ed 03 43 47 3e 7f 08 c2 e5 1c 78 b4 50 b6 39 3a 3a dc 5c
         06 28 b5 af b5 ec a0 54 f0 d2 73 04 6c 4a 91 a0 48 c2 f2 83 2f
         05 cd 59 3b 8c be 64 8d 2f 11 e5 33 7a af 0f ea 8a 4a 9d 24 de
         3e 4b aa 7e bb b2 65 05 2a b1 19 dd 36 46 82 7a 25 8d 21 89 c8
         9b e2 5f 79

      binder hash (32 octets):  7e c4 25 35 46 50 70 db 84 20 75 2e b1
         a6 24 e6 e8 fd 19 f2 58 10 bf c7 27 5c 53 81 85 0b 5b 66

      PRK (32 octets):  b8 52 21 f2 18 f5 7b 3e 3d a0 51 76 73 a7 08 87
         b8 99 dd af a1 72 a3 2f 22 5c b1 e1 7a e8 56 d8

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  63 fc e9 b8 51 9a 37 6d 4f 48 52 7d e3 85
         f1 37 06 79 5c 77 15 ce 2b 66 f8 76 4d 9f ab 68 e0 5f

   {client}  send handshake record:



Thomson                 Expires February 2, 2019               [Page 17]

Internet-Draft               TLS 1.3 Traces                  August 2018


      payload (512 octets):  01 00 01 fc 03 03 7b 32 92 8e 7f 1d c5 02
         68 48 6e ea f0 33 e8 e6 18 89 8f 62 33 20 a8 a4 ad 00 48 b9 fc
         ac 78 6d 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 20 b1 4d 94 ef 4c f0 be cf 0a 8a a3 a1 f3
         72 c2 40 c6 a0 09 7a 8d 5f 09 6b 57 9f fc 4f 83 aa 5c 00 2a 00
         00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02
         03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02
         02 02 00 2d 00 02 01 01 00 1c 00 02 40 01 00 15 00 57 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 29 00 dd 00 b8 00 b2 f8 1e c2 67 63 6e d6 fe da a0 16 b7 00
         00 00 00 be c4 bd 6a 4f 28 c4 b6 f9 b9 67 b5 91 cb e2 dd 00 70
         e9 d9 29 6b 7d a7 94 86 ee 4b 18 a3 26 b1 80 41 7d a4 5c 8a a0
         29 27 56 11 d5 ea 77 c0 86 85 d4 5d 67 a4 fa e7 06 78 89 ba 29
         eb 1c 7b db ee 7e 7a 29 04 16 19 42 e5 ce 83 77 a8 0b 74 8b ed
         03 43 47 3e 7f 08 c2 e5 1c 78 b4 50 b6 39 3a 3a dc 5c 06 28 b5
         af b5 ec a0 54 f0 d2 73 04 6c 4a 91 a0 48 c2 f2 83 2f 05 cd 59
         3b 8c be 64 8d 2f 11 e5 33 7a af 0f ea 8a 4a 9d 24 de 3e 4b aa
         7e bb b2 65 05 2a b1 19 dd 36 46 82 7a 25 8d 21 89 c8 9b e2 5f
         79 00 21 20 e4 d2 1e bb 48 52 22 28 4c 50 29 6f 4a b4 c0 ad b1
         db a4 b6 a3 4e 8f ae 7a fd a5 cf d5 30 58 43

      complete record (517 octets):  16 03 01 02 00 01 00 01 fc 03 03 7b
         32 92 8e 7f 1d c5 02 68 48 6e ea f0 33 e8 e6 18 89 8f 62 33 20
         a8 a4 ad 00 48 b9 fc ac 78 6d 00 00 06 13 01 13 03 13 02 01 00
         01 cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01
         00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02
         01 03 01 04 00 33 00 26 00 24 00 1d 00 20 20 b1 4d 94 ef 4c f0
         be cf 0a 8a a3 a1 f3 72 c2 40 c6 a0 09 7a 8d 5f 09 6b 57 9f fc
         4f 83 aa 5c 00 2a 00 00 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01
         00 15 00 57 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 29 00 dd 00 b8 00 b2 f8 1e c2 67 63 6e
         d6 fe da a0 16 b7 00 00 00 00 be c4 bd 6a 4f 28 c4 b6 f9 b9 67
         b5 91 cb e2 dd 00 70 e9 d9 29 6b 7d a7 94 86 ee 4b 18 a3 26 b1
         80 41 7d a4 5c 8a a0 29 27 56 11 d5 ea 77 c0 86 85 d4 5d 67 a4
         fa e7 06 78 89 ba 29 eb 1c 7b db ee 7e 7a 29 04 16 19 42 e5 ce
         83 77 a8 0b 74 8b ed 03 43 47 3e 7f 08 c2 e5 1c 78 b4 50 b6 39
         3a 3a dc 5c 06 28 b5 af b5 ec a0 54 f0 d2 73 04 6c 4a 91 a0 48
         c2 f2 83 2f 05 cd 59 3b 8c be 64 8d 2f 11 e5 33 7a af 0f ea 8a



Thomson                 Expires February 2, 2019               [Page 18]

Internet-Draft               TLS 1.3 Traces                  August 2018


         4a 9d 24 de 3e 4b aa 7e bb b2 65 05 2a b1 19 dd 36 46 82 7a 25
         8d 21 89 c8 9b e2 5f 79 00 21 20 e4 d2 1e bb 48 52 22 28 4c 50
         29 6f 4a b4 c0 ad b1 db a4 b6 a3 4e 8f ae 7a fd a5 cf d5 30 58
         43

   {client}  derive secret "tls13 c e traffic":

      PRK (32 octets):  1a 2c 1c 8a 1f 71 53 42 36 ac be 4f 35 2c 89 ad
         6c b0 34 2c 7c 94 0f 1d 67 27 96 48 f3 30 3a da

      hash (32 octets):  b7 28 82 84 57 93 dd 90 0b bb b0 5a 74 0a ea e6
         3d e7 a8 32 4c 61 06 ef 1d 88 d4 f2 29 b9 af b4

      info (53 octets):  00 20 11 74 6c 73 31 33 20 63 20 65 20 74 72 61
         66 66 69 63 20 b7 28 82 84 57 93 dd 90 0b bb b0 5a 74 0a ea e6
         3d e7 a8 32 4c 61 06 ef 1d 88 d4 f2 29 b9 af b4

      expanded (32 octets):  f6 26 54 2f 15 dd 93 20 f3 7b 3f 5e 63 04
         81 46 41 16 d6 46 ad e3 d3 0a 80 36 44 c6 49 9a bf d4

   {client}  derive secret "tls13 e exp master":

      PRK (32 octets):  1a 2c 1c 8a 1f 71 53 42 36 ac be 4f 35 2c 89 ad
         6c b0 34 2c 7c 94 0f 1d 67 27 96 48 f3 30 3a da

      hash (32 octets):  b7 28 82 84 57 93 dd 90 0b bb b0 5a 74 0a ea e6
         3d e7 a8 32 4c 61 06 ef 1d 88 d4 f2 29 b9 af b4

      info (54 octets):  00 20 12 74 6c 73 31 33 20 65 20 65 78 70 20 6d
         61 73 74 65 72 20 b7 28 82 84 57 93 dd 90 0b bb b0 5a 74 0a ea
         e6 3d e7 a8 32 4c 61 06 ef 1d 88 d4 f2 29 b9 af b4

      expanded (32 octets):  7d fd a5 b8 34 22 3a 38 79 47 ad 65 82 c0
         20 fc 59 4c 04 16 84 a5 9b 9c 5b f2 ac ad ed ce 13 13

   {client}  derive write traffic keys for early application data:

      PRK (32 octets):  f6 26 54 2f 15 dd 93 20 f3 7b 3f 5e 63 04 81 46
         41 16 d6 46 ad e3 d3 0a 80 36 44 c6 49 9a bf d4

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  d8 1d b4 3b 49 09 e9 22 3f 29 4a 83 08
         01 0c 5f

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  9c aa 82 3d 3f 7d ae cd f6 fd 38 65



Thomson                 Expires February 2, 2019               [Page 19]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {client}  send application_data record:

      payload (6 octets):  41 42 43 44 45 46

      complete record (28 octets):  17 03 03 00 17 bc 1c f1 41 92 8c 2f
         e6 43 83 d0 20 51 6a 84 30 6c 7c 63 f4 f3 af 36

   {server}  extract secret "early" (same as client early secret)

   {server}  calculate PSK binder (same as client)

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  5c 64 7b 81 aa 65 43 f9 30 c2 9a f5 4f
         c2 01 00 6e ca 1d 29 ce 5e 93 c6 09 41 da ff f2 9c a9 44

      public key (32 octets):  f1 c1 79 26 16 72 80 c0 d6 58 5c 29 13 d6
         b0 a0 87 82 43 87 a0 a3 91 33 28 97 e0 1e 4f b2 e9 7d

   {server}  derive secret "tls13 c e traffic" (same as client)

   {server}  derive secret "tls13 e exp master" (same as client)

   {server}  construct a ServerHello handshake message

      ServerHello (96 octets):  02 00 00 5c 03 03 c1 11 8a 6d d3 2f e1
         38 88 0b e2 3b 2d 2b ad 0a 7e 31 fc d6 3f 3f 7f 4f f0 de 99 1f
         ec a8 77 90 00 13 01 00 00 34 00 29 00 02 00 00 00 33 00 24 00
         1d 00 20 f1 c1 79 26 16 72 80 c0 d6 58 5c 29 13 d6 b0 a0 87 82
         43 87 a0 a3 91 33 28 97 e0 1e 4f b2 e9 7d 00 2b 00 02 7f 1c

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  1a 2c 1c 8a 1f 71 53 42 36 ac be 4f 35 2c 89 ad
         6c b0 34 2c 7c 94 0f 1d 67 27 96 48 f3 30 3a da

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  24 8c ae f8 76 2a 63 21 53 be b5 48 da a0
         32 7d fa c7 06 6c 48 86 3d 3a 71 2f de f0 d8 63 40 65

   {server}  extract secret "handshake":




Thomson                 Expires February 2, 2019               [Page 20]

Internet-Draft               TLS 1.3 Traces                  August 2018


      salt (32 octets):  24 8c ae f8 76 2a 63 21 53 be b5 48 da a0 32 7d
         fa c7 06 6c 48 86 3d 3a 71 2f de f0 d8 63 40 65

      IKM (32 octets):  ef 95 34 43 16 c2 eb 13 6b 50 99 81 03 09 57 ce
         57 13 d5 17 3f 9c fc 2e 50 57 0f b5 1e 67 8c 7c

      secret (32 octets):  58 e7 08 a6 3f 94 b0 a0 68 35 05 1f b9 5d 0d
         d0 9d 86 09 23 0c 99 48 1e 8b 5b 66 6a 2e 5e 37 cf

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  58 e7 08 a6 3f 94 b0 a0 68 35 05 1f b9 5d 0d d0
         9d 86 09 23 0c 99 48 1e 8b 5b 66 6a 2e 5e 37 cf

      hash (32 octets):  bd ea ab 28 c6 73 ff ce a6 95 7f ed e2 95 9a 14
         95 7c 91 11 56 e8 bc 4d 17 85 d2 3d d5 2a d5 67

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 bd ea ab 28 c6 73 ff ce a6 95 7f ed e2 95 9a
         14 95 7c 91 11 56 e8 bc 4d 17 85 d2 3d d5 2a d5 67

      expanded (32 octets):  db c2 42 38 b8 fc 65 31 83 0f 9f 61 e5 d6
         6a 3b 71 6d cb 48 5a 1b e8 fc bd 69 27 1b a7 d7 27 5d

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  58 e7 08 a6 3f 94 b0 a0 68 35 05 1f b9 5d 0d d0
         9d 86 09 23 0c 99 48 1e 8b 5b 66 6a 2e 5e 37 cf

      hash (32 octets):  bd ea ab 28 c6 73 ff ce a6 95 7f ed e2 95 9a 14
         95 7c 91 11 56 e8 bc 4d 17 85 d2 3d d5 2a d5 67

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 bd ea ab 28 c6 73 ff ce a6 95 7f ed e2 95 9a
         14 95 7c 91 11 56 e8 bc 4d 17 85 d2 3d d5 2a d5 67

      expanded (32 octets):  da 99 31 de 43 23 99 06 34 85 40 b0 0e 19
         10 e6 c9 1d 14 82 de eb 88 28 14 12 dc b5 ad 4f 3d 86

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  58 e7 08 a6 3f 94 b0 a0 68 35 05 1f b9 5d 0d d0
         9d 86 09 23 0c 99 48 1e 8b 5b 66 6a 2e 5e 37 cf

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55





Thomson                 Expires February 2, 2019               [Page 21]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  88 1b ea b4 73 85 39 92 a6 af 24 df 62 8b
         72 0a ff f4 56 29 7a db 27 5e 04 23 02 93 15 6d 28 2b

   {server}  extract secret "master":

      salt (32 octets):  88 1b ea b4 73 85 39 92 a6 af 24 df 62 8b 72 0a
         ff f4 56 29 7a db 27 5e 04 23 02 93 15 6d 28 2b

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  65 89 ce 62 ba c6 68 0a 2a f4 0d d1 3d e4 36
         3c 22 12 83 94 e5 a6 18 7e b7 64 e7 7b 04 32 91 75

   {server}  send handshake record:

      payload (96 octets):  02 00 00 5c 03 03 c1 11 8a 6d d3 2f e1 38 88
         0b e2 3b 2d 2b ad 0a 7e 31 fc d6 3f 3f 7f 4f f0 de 99 1f ec a8
         77 90 00 13 01 00 00 34 00 29 00 02 00 00 00 33 00 24 00 1d 00
         20 f1 c1 79 26 16 72 80 c0 d6 58 5c 29 13 d6 b0 a0 87 82 43 87
         a0 a3 91 33 28 97 e0 1e 4f b2 e9 7d 00 2b 00 02 7f 1c

      complete record (101 octets):  16 03 03 00 60 02 00 00 5c 03 03 c1
         11 8a 6d d3 2f e1 38 88 0b e2 3b 2d 2b ad 0a 7e 31 fc d6 3f 3f
         7f 4f f0 de 99 1f ec a8 77 90 00 13 01 00 00 34 00 29 00 02 00
         00 00 33 00 24 00 1d 00 20 f1 c1 79 26 16 72 80 c0 d6 58 5c 29
         13 d6 b0 a0 87 82 43 87 a0 a3 91 33 28 97 e0 1e 4f b2 e9 7d 00
         2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  da 99 31 de 43 23 99 06 34 85 40 b0 0e 19 10 e6
         c9 1d 14 82 de eb 88 28 14 12 dc b5 ad 4f 3d 86

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  fe c5 86 81 a2 46 68 00 2f 63 54 ba c6
         82 1d f7

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  ba 21 36 b7 34 a9 27 75 ab 14 be 49

   {server}  construct a EncryptedExtensions handshake message



Thomson                 Expires February 2, 2019               [Page 22]

Internet-Draft               TLS 1.3 Traces                  August 2018


      EncryptedExtensions (44 octets):  08 00 00 28 00 26 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c
         00 02 40 01 00 00 00 00 00 2a 00 00

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  da 99 31 de 43 23 99 06 34 85 40 b0 0e 19 10 e6
         c9 1d 14 82 de eb 88 28 14 12 dc b5 ad 4f 3d 86

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  e3 36 cc 3a 45 57 5d fe 55 8e 92 bb 28 b2
         5e 41 2e a9 01 95 15 c0 53 3f 20 13 d4 07 e8 73 e2 6c

   {server}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 de a3 bb 6e 25 3a f8 e8 ed 42
         0c 4b 34 e0 b1 f4 8e 2e 3b 53 1d 86 2e 27 23 2f ec 41 9c f8 72
         8d

   {server}  send handshake record:

      payload (80 octets):  08 00 00 28 00 26 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40 01
         00 00 00 00 00 2a 00 00 14 00 00 20 de a3 bb 6e 25 3a f8 e8 ed
         42 0c 4b 34 e0 b1 f4 8e 2e 3b 53 1d 86 2e 27 23 2f ec 41 9c f8
         72 8d

      complete record (102 octets):  17 03 03 00 61 ca ff 13 f4 4e 4f 98
         3d ab e5 f8 ed 6d 9f be 87 f8 c5 f0 23 73 3b be da 64 1c 4f 17
         60 5c 08 93 da e2 46 75 3d b5 4c a9 88 43 87 6d 4d 06 fa c8 3c
         cb 62 9c e5 eb 49 f1 5e a1 48 e5 6a ca 06 75 83 c8 4d 67 03 93
         3d 1a f0 1b bb ba af 9b ab fb ed 72 14 a7 df 42 07 56 8c 88 86
         2f 2c 8a 07 fc 1c

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  65 89 ce 62 ba c6 68 0a 2a f4 0d d1 3d e4 36 3c
         22 12 83 94 e5 a6 18 7e b7 64 e7 7b 04 32 91 75

      hash (32 octets):  b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46 1a
         9e 66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70






Thomson                 Expires February 2, 2019               [Page 23]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46
         1a 9e 66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70

      expanded (32 octets):  ba 97 bd fb bc 37 d1 34 b3 00 8e f2 56 7c
         1c 7c 4d 0e 06 27 de 1e 05 c7 1e 99 61 cf ee 6d 10 27

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  65 89 ce 62 ba c6 68 0a 2a f4 0d d1 3d e4 36 3c
         22 12 83 94 e5 a6 18 7e b7 64 e7 7b 04 32 91 75

      hash (32 octets):  b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46 1a
         9e 66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46
         1a 9e 66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70

      expanded (32 octets):  a4 fb 9f 37 49 c8 78 15 eb 38 c6 77 48 c6
         94 a2 70 9e 89 8d a3 c7 0a 9f 5b 3c f6 4d b1 3e fb 0f

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  65 89 ce 62 ba c6 68 0a 2a f4 0d d1 3d e4 36 3c
         22 12 83 94 e5 a6 18 7e b7 64 e7 7b 04 32 91 75

      hash (32 octets):  b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46 1a
         9e 66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 b5 df 6b 3a f3 cb 68 d6 b5 45 c6 44 f5 d8 46 1a 9e
         66 b6 7f fd 18 c5 30 4d e1 ba 84 29 7d 98 70

      expanded (32 octets):  c5 7f 2d 21 04 d0 bc 62 e8 29 ec bd 3f 9d
         fe 9b ad ea f2 41 18 a6 21 e9 6c ee 36 bb 5a c8 f0 59

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  a4 fb 9f 37 49 c8 78 15 eb 38 c6 77 48 c6 94 a2
         70 9e 89 8d a3 c7 0a 9f 5b 3c f6 4d b1 3e fb 0f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  9d e6 26 fe 52 c9 9d 97 cc b7 b1 cf 53
         5e fc a2

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00



Thomson                 Expires February 2, 2019               [Page 24]

Internet-Draft               TLS 1.3 Traces                  August 2018


      iv expanded (12 octets):  4f e2 59 01 e1 76 7d 0a 5a 7c 0c bc

   {server}  derive read traffic keys for early application data (same
      as client early application data write traffic keys)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  1a 2c 1c 8a 1f 71 53 42 36 ac be 4f 35 2c 89 ad
         6c b0 34 2c 7c 94 0f 1d 67 27 96 48 f3 30 3a da

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  24 8c ae f8 76 2a 63 21 53 be b5 48 da a0
         32 7d fa c7 06 6c 48 86 3d 3a 71 2f de f0 d8 63 40 65

   {client}  extract secret "handshake" (same as server handshake
      secret)

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server master secret)

   {client}  derive read traffic keys for handshake data (same as server
      handshake data write traffic keys)

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  construct a EndOfEarlyData handshake message

      EndOfEarlyData (4 octets):  05 00 00 00

   {client}  send handshake record:




Thomson                 Expires February 2, 2019               [Page 25]

Internet-Draft               TLS 1.3 Traces                  August 2018


      payload (4 octets):  05 00 00 00

      complete record (26 octets):  17 03 03 00 15 d9 75 fd d5 92 7e af
         f0 52 dc 20 ed 78 0e 5f 77 9b 10 bd 02 6e

   {client}  derive write traffic keys for handshake data:

      PRK (32 octets):  db c2 42 38 b8 fc 65 31 83 0f 9f 61 e5 d6 6a 3b
         71 6d cb 48 5a 1b e8 fc bd 69 27 1b a7 d7 27 5d

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  26 17 32 69 b9 6b 5f e6 2d ff 28 7a 3e
         8a 35 c1

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  51 26 70 7c 8f 01 a1 6f 1e 69 02 7d

   {client}  derive read traffic keys for application data (same as
      server application data write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  db c2 42 38 b8 fc 65 31 83 0f 9f 61 e5 d6 6a 3b
         71 6d cb 48 5a 1b e8 fc bd 69 27 1b a7 d7 27 5d

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  61 f7 22 3c 2f c4 eb 9d 7a b6 44 cb a6 69
         5b 98 3a 67 b2 cb db 3d 8e 95 43 f9 bf 29 5a 02 66 96

   {client}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 dc 08 73 be c1 70 bc 2d a7 2a
         f6 3d 82 30 b1 8a 6a 76 74 09 13 51 c5 b1 5c 73 7a ae d1 d7 a3
         d6

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 dc 08 73 be c1 70 bc 2d a7 2a f6
         3d 82 30 b1 8a 6a 76 74 09 13 51 c5 b1 5c 73 7a ae d1 d7 a3 d6

      complete record (58 octets):  17 03 03 00 35 df 41 9b a1 4e d9 0b
         92 c4 db 46 d4 92 cd 3e 68 df a5 f6 46 28 ba 57 a1 9e 30 ad 84



Thomson                 Expires February 2, 2019               [Page 26]

Internet-Draft               TLS 1.3 Traces                  August 2018


         1f f1 07 28 fa 61 14 f3 7b 16 d2 9d 31 fc 62 af aa f4 fa d8 78
         9c 22 ac 0f

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  ba 97 bd fb bc 37 d1 34 b3 00 8e f2 56 7c 1c 7c
         4d 0e 06 27 de 1e 05 c7 1e 99 61 cf ee 6d 10 27

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  ec dc 13 30 1c ea 47 40 e0 d2 03 fd 8d
         5a aa 75

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  88 fd a4 bc 0b 45 53 4d 65 34 be 9f

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  65 89 ce 62 ba c6 68 0a 2a f4 0d d1 3d e4 36 3c
         22 12 83 94 e5 a6 18 7e b7 64 e7 7b 04 32 91 75

      hash (32 octets):  f2 f9 84 00 48 03 c5 51 44 28 16 e6 9a 76 a1 fc
         fd 53 68 23 d3 71 48 d3 45 76 34 26 46 d5 64 9c

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 f2 f9 84 00 48 03 c5 51 44 28 16 e6 9a 76 a1 fc fd
         53 68 23 d3 71 48 d3 45 76 34 26 46 d5 64 9c

      expanded (32 octets):  cb 2e fc 69 29 04 e4 1e 84 40 88 3f c6 23
         d0 36 00 3c 87 13 16 90 f4 83 d8 66 dc 45 4d d8 3f 76

   {server}  derive read traffic keys for handshake data (same as client
      handshake data write traffic keys)

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client application data write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31




Thomson                 Expires February 2, 2019               [Page 27]

Internet-Draft               TLS 1.3 Traces                  August 2018


      complete record (72 octets):  17 03 03 00 43 83 4d 57 e1 5e 98 3d
         a9 c1 9a f8 2e f8 08 ca a8 44 41 a1 7a f5 ef 5c 2c be cc ff c7
         a8 ab 90 d9 69 94 13 a5 39 c1 43 d9 67 5b 1d 4d 80 6e 5c 0a 8b
         2c 1e 18 cf dd bc bf a2 a2 af f5 c9 9a ae 13 82 3d 39

   {server}  send application_data record:

      payload (50 octets):  00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e
         0f 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23
         24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31

      complete record (72 octets):  17 03 03 00 43 dc 58 c5 72 08 5e 6d
         e9 60 50 37 69 4d 50 c0 6e 2d 72 a6 e4 7e 4b 85 d7 01 2e ee 43
         5b cf f3 18 0e c4 b2 4e 78 3f 29 de 0c 59 a2 0d 09 71 f5 75 34
         e2 ed 53 56 b6 94 fe 32 c2 48 34 0f 66 37 fd ef db 79

   {client}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 93 27 43 d0 8d 9b ac
         1b 4c ab 33 f0 be db 1f 55 70 eb bd

   {server}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 87 e3 2d eb d8 2a a7
         0a 44 fe fb 30 d6 0e fb 42 db 70 1d

5.  HelloRetryRequest

   In this example, the client initiates a handshake with an X25519
   [RFC7748] share.  The server however prefers P-256 [FIPS186] and
   sends a HelloRetryRequest that requires the client to generate a key
   share on the P-256 curve.

   Note:  The HelloRetryRequest uses the same handshake message type as
      a ServerHello and so is labeled as ServerHello here.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  5a 94 06 30 c7 c0 b5 67 f8 5c 9f f4 5e
         be 0a 24 c2 03 66 02 97 37 cb 22 2e 97 44 65 52 68 ed d5

      public key (32 octets):  c9 20 dc 58 31 c3 34 0c a2 6f 6c 1a bd 1a
         50 3b 47 a1 f8 ca 51 e7 cf 91 49 f4 0d 56 b4 a7 6f 0f




Thomson                 Expires February 2, 2019               [Page 28]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {client}  construct a ClientHello handshake message

      ClientHello (180 octets):  01 00 00 b0 03 03 e2 54 42 15 64 bb b0
         6a ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2 de 91 23 02 b7 79
         a0 1e c0 69 00 00 06 13 01 13 03 13 02 01 00 00 81 00 00 00 0b
         00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00
         06 00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00 20 c9 20 dc 58
         31 c3 34 0c a2 6f 6c 1a bd 1a 50 3b 47 a1 f8 ca 51 e7 cf 91 49
         f4 0d 56 b4 a7 6f 0f 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04
         03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01
         04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {client}  send handshake record:

      payload (180 octets):  01 00 00 b0 03 03 e2 54 42 15 64 bb b0 6a
         ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2 de 91 23 02 b7 79 a0
         1e c0 69 00 00 06 13 01 13 03 13 02 01 00 00 81 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 26 00 24 00 1d 00 20 c9 20 dc 58 31
         c3 34 0c a2 6f 6c 1a bd 1a 50 3b 47 a1 f8 ca 51 e7 cf 91 49 f4
         0d 56 b4 a7 6f 0f 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03
         05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04
         02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      complete record (185 octets):  16 03 01 00 b4 01 00 00 b0 03 03 e2
         54 42 15 64 bb b0 6a ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2
         de 91 23 02 b7 79 a0 1e c0 69 00 00 06 13 01 13 03 13 02 01 00
         00 81 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01
         00 00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 26 00 24 00 1d
         00 20 c9 20 dc 58 31 c3 34 0c a2 6f 6c 1a bd 1a 50 3b 47 a1 f8
         ca 51 e7 cf 91 49 f4 0d 56 b4 a7 6f 0f 00 2b 00 03 02 7f 1c 00
         0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01
         05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00
         1c 00 02 40 01

   {server}  construct a ServerHello handshake message

      ServerHello (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61
         11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2
         c8 a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17 00 2c 00 74 00
         72 c8 17 76 da 33 4b 42 02 33 40 15 fc 00 00 00 00 7b 3b 04 a8
         b2 19 4d c6 8d 2c 78 68 ba b5 1c 05 00 30 6e 72 10 f1 05 7f a7
         30 cf bf e8 57 55 d0 b8 ca d1 07 6f 1e c4 9f 80 4e ad d9 ea ff
         93 81 91 c4 2b b4 93 16 7d 48 f0 3d 2f 07 5c b5 4e 33 d8 9f 95
         6f da d4 4e 74 fd ba 9d 7c 31 13 c3 b1 e2 7e 0a c3 be b2 fc 3a
         39 ec ed ab 21 ca b2 ce b7 54 00 2b 00 02 7f 1c

   {server}  send handshake record:



Thomson                 Expires February 2, 2019               [Page 29]

Internet-Draft               TLS 1.3 Traces                  August 2018


      payload (176 octets):  02 00 00 ac 03 03 cf 21 ad 74 e5 9a 61 11
         be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb 8c 5e 07 9e 09 e2 c8
         a8 33 9c 00 13 01 00 00 84 00 33 00 02 00 17 00 2c 00 74 00 72
         c8 17 76 da 33 4b 42 02 33 40 15 fc 00 00 00 00 7b 3b 04 a8 b2
         19 4d c6 8d 2c 78 68 ba b5 1c 05 00 30 6e 72 10 f1 05 7f a7 30
         cf bf e8 57 55 d0 b8 ca d1 07 6f 1e c4 9f 80 4e ad d9 ea ff 93
         81 91 c4 2b b4 93 16 7d 48 f0 3d 2f 07 5c b5 4e 33 d8 9f 95 6f
         da d4 4e 74 fd ba 9d 7c 31 13 c3 b1 e2 7e 0a c3 be b2 fc 3a 39
         ec ed ab 21 ca b2 ce b7 54 00 2b 00 02 7f 1c

      complete record (181 octets):  16 03 03 00 b0 02 00 00 ac 03 03 cf
         21 ad 74 e5 9a 61 11 be 1d 8c 02 1e 65 b8 91 c2 a2 11 16 7a bb
         8c 5e 07 9e 09 e2 c8 a8 33 9c 00 13 01 00 00 84 00 33 00 02 00
         17 00 2c 00 74 00 72 c8 17 76 da 33 4b 42 02 33 40 15 fc 00 00
         00 00 7b 3b 04 a8 b2 19 4d c6 8d 2c 78 68 ba b5 1c 05 00 30 6e
         72 10 f1 05 7f a7 30 cf bf e8 57 55 d0 b8 ca d1 07 6f 1e c4 9f
         80 4e ad d9 ea ff 93 81 91 c4 2b b4 93 16 7d 48 f0 3d 2f 07 5c
         b5 4e 33 d8 9f 95 6f da d4 4e 74 fd ba 9d 7c 31 13 c3 b1 e2 7e
         0a c3 be b2 fc 3a 39 ec ed ab 21 ca b2 ce b7 54 00 2b 00 02 7f
         1c

   {client}  create an ephemeral P-256 key pair:

      private key (32 octets):  45 39 78 45 40 66 e1 74 69 cd 23 e1 1f
         1a f3 8b c6 44 d8 82 c2 9e c4 43 fb dc 76 8b 7e 25 a4 05

      public key (65 octets):  04 fb 44 db 39 c2 bc 7e 27 b6 50 90 9f aa
         5b 8c 8d 63 b6 d8 36 89 e9 a8 21 f2 0f 11 17 ce 24 cb 46 d5 68
         4e 0c 5b f5 5a aa f3 85 e4 97 19 05 b2 b3 5d b5 52 1c 9b a7 d7
         0d b3 6b ee 94 48 18 ee 3a

   {client}  construct a ClientHello handshake message

      ClientHello (512 octets):  01 00 01 fc 03 03 e2 54 42 15 64 bb b0
         6a ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2 de 91 23 02 b7 79
         a0 1e c0 69 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b
         00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00
         06 00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00 41 04 fb 44 db
         39 c2 bc 7e 27 b6 50 90 9f aa 5b 8c 8d 63 b6 d8 36 89 e9 a8 21
         f2 0f 11 17 ce 24 cb 46 d5 68 4e 0c 5b f5 5a aa f3 85 e4 97 19
         05 b2 b3 5d b5 52 1c 9b a7 d7 0d b3 6b ee 94 48 18 ee 3a 00 2b
         00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04
         08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00
         2c 00 74 00 72 c8 17 76 da 33 4b 42 02 33 40 15 fc 00 00 00 00
         7b 3b 04 a8 b2 19 4d c6 8d 2c 78 68 ba b5 1c 05 00 30 6e 72 10
         f1 05 7f a7 30 cf bf e8 57 55 d0 b8 ca d1 07 6f 1e c4 9f 80 4e
         ad d9 ea ff 93 81 91 c4 2b b4 93 16 7d 48 f0 3d 2f 07 5c b5 4e
         33 d8 9f 95 6f da d4 4e 74 fd ba 9d 7c 31 13 c3 b1 e2 7e 0a c3



Thomson                 Expires February 2, 2019               [Page 30]

Internet-Draft               TLS 1.3 Traces                  August 2018


         be b2 fc 3a 39 ec ed ab 21 ca b2 ce b7 54 00 2d 00 02 01 01 00
         1c 00 02 40 01 00 15 00 af 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

   {client}  send handshake record:

      payload (512 octets):  01 00 01 fc 03 03 e2 54 42 15 64 bb b0 6a
         ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2 de 91 23 02 b7 79 a0
         1e c0 69 00 00 06 13 01 13 03 13 02 01 00 01 cd 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 08 00 06
         00 1d 00 17 00 18 00 33 00 47 00 45 00 17 00 41 04 fb 44 db 39
         c2 bc 7e 27 b6 50 90 9f aa 5b 8c 8d 63 b6 d8 36 89 e9 a8 21 f2
         0f 11 17 ce 24 cb 46 d5 68 4e 0c 5b f5 5a aa f3 85 e4 97 19 05
         b2 b3 5d b5 52 1c 9b a7 d7 0d b3 6b ee 94 48 18 ee 3a 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2c
         00 74 00 72 c8 17 76 da 33 4b 42 02 33 40 15 fc 00 00 00 00 7b
         3b 04 a8 b2 19 4d c6 8d 2c 78 68 ba b5 1c 05 00 30 6e 72 10 f1
         05 7f a7 30 cf bf e8 57 55 d0 b8 ca d1 07 6f 1e c4 9f 80 4e ad
         d9 ea ff 93 81 91 c4 2b b4 93 16 7d 48 f0 3d 2f 07 5c b5 4e 33
         d8 9f 95 6f da d4 4e 74 fd ba 9d 7c 31 13 c3 b1 e2 7e 0a c3 be
         b2 fc 3a 39 ec ed ab 21 ca b2 ce b7 54 00 2d 00 02 01 01 00 1c
         00 02 40 01 00 15 00 af 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      complete record (517 octets):  16 03 03 02 00 01 00 01 fc 03 03 e2
         54 42 15 64 bb b0 6a ff d1 20 ec fc 5d 5a 7b e5 b1 31 66 52 d2
         de 91 23 02 b7 79 a0 1e c0 69 00 00 06 13 01 13 03 13 02 01 00
         01 cd 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01
         00 00 0a 00 08 00 06 00 1d 00 17 00 18 00 33 00 47 00 45 00 17
         00 41 04 fb 44 db 39 c2 bc 7e 27 b6 50 90 9f aa 5b 8c 8d 63 b6
         d8 36 89 e9 a8 21 f2 0f 11 17 ce 24 cb 46 d5 68 4e 0c 5b f5 5a
         aa f3 85 e4 97 19 05 b2 b3 5d b5 52 1c 9b a7 d7 0d b3 6b ee 94
         48 18 ee 3a 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03



Thomson                 Expires February 2, 2019               [Page 31]

Internet-Draft               TLS 1.3 Traces                  August 2018


         06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05
         02 06 02 02 02 00 2c 00 74 00 72 c8 17 76 da 33 4b 42 02 33 40
         15 fc 00 00 00 00 7b 3b 04 a8 b2 19 4d c6 8d 2c 78 68 ba b5 1c
         05 00 30 6e 72 10 f1 05 7f a7 30 cf bf e8 57 55 d0 b8 ca d1 07
         6f 1e c4 9f 80 4e ad d9 ea ff 93 81 91 c4 2b b4 93 16 7d 48 f0
         3d 2f 07 5c b5 4e 33 d8 9f 95 6f da d4 4e 74 fd ba 9d 7c 31 13
         c3 b1 e2 7e 0a c3 be b2 fc 3a 39 ec ed ab 21 ca b2 ce b7 54 00
         2d 00 02 01 01 00 1c 00 02 40 01 00 15 00 af 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral P-256 key pair:

      private key (32 octets):  8f e8 63 d3 97 87 7d d1 05 cd 9b cf 9b
         bd 54 76 fb dd 69 5d 80 ca b0 3e 61 5b 14 9f bd 41 12 f2

      public key (65 octets):  04 8e 03 6d 7e 6e 61 49 6f b2 ed 8b 3e 33
         54 d0 df 5b 2e dd 94 9a cd 97 db f6 28 2c bc f8 48 39 ea f5 15
         51 6f 85 a6 3c 4e 46 87 f6 10 64 17 1d 6a 51 39 af ab 8e a4 b5
         95 8a c5 d6 18 de b2 46 8a

   {server}  construct a ServerHello handshake message

      ServerHello (123 octets):  02 00 00 77 03 03 76 96 ef f9 ed 79 5d
         e9 89 07 bb 4b c8 b1 21 b5 9a a5 10 95 6d d9 0b bc 76 77 13 46
         aa 35 af eb 00 13 01 00 00 4f 00 33 00 45 00 17 00 41 04 8e 03
         6d 7e 6e 61 49 6f b2 ed 8b 3e 33 54 d0 df 5b 2e dd 94 9a cd 97
         db f6 28 2c bc f8 48 39 ea f5 15 51 6f 85 a6 3c 4e 46 87 f6 10
         64 17 1d 6a 51 39 af ab 8e a4 b5 95 8a c5 d6 18 de b2 46 8a 00
         2b 00 02 7f 1c




Thomson                 Expires February 2, 2019               [Page 32]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  7e a1 f1 b7 21 31 ad 35 c1 9a a5 51 7d a9 0d 58
         02 2f af e0 76 16 7c 40 2c d3 0a 08 6c ab e5 55

      secret (32 octets):  27 35 ec a0 86 53 8a 2e 41 c5 90 33 e1 d4 35
         5f 79 c3 33 22 c7 dc 7b 0e 0a 22 00 29 fb 9e 04 40

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  27 35 ec a0 86 53 8a 2e 41 c5 90 33 e1 d4 35 5f
         79 c3 33 22 c7 dc 7b 0e 0a 22 00 29 fb 9e 04 40

      hash (32 octets):  97 2d c3 fe 48 0a 05 0a b5 e0 c8 4c aa 4c 14 77
         65 57 42 30 74 17 88 a5 36 e7 c1 eb 89 7f 76 f6

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 97 2d c3 fe 48 0a 05 0a b5 e0 c8 4c aa 4c 14
         77 65 57 42 30 74 17 88 a5 36 e7 c1 eb 89 7f 76 f6

      expanded (32 octets):  af a2 64 1a e4 31 ad 0f e5 f4 fc 54 c3 6a
         f1 0f f8 14 b1 f3 6e 9a f0 47 18 fc ae 00 2b 6d 46 c2

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  27 35 ec a0 86 53 8a 2e 41 c5 90 33 e1 d4 35 5f
         79 c3 33 22 c7 dc 7b 0e 0a 22 00 29 fb 9e 04 40

      hash (32 octets):  97 2d c3 fe 48 0a 05 0a b5 e0 c8 4c aa 4c 14 77
         65 57 42 30 74 17 88 a5 36 e7 c1 eb 89 7f 76 f6



Thomson                 Expires February 2, 2019               [Page 33]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 97 2d c3 fe 48 0a 05 0a b5 e0 c8 4c aa 4c 14
         77 65 57 42 30 74 17 88 a5 36 e7 c1 eb 89 7f 76 f6

      expanded (32 octets):  20 59 bb d5 d6 6c e0 37 77 2e eb ef 6f b1
         57 93 f7 b8 70 de 49 75 66 e2 52 a6 8e e7 70 aa 6f 04

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  27 35 ec a0 86 53 8a 2e 41 c5 90 33 e1 d4 35 5f
         79 c3 33 22 c7 dc 7b 0e 0a 22 00 29 fb 9e 04 40

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  81 5a a6 19 d7 e1 bd 00 78 f3 f0 8e be 8c
         89 81 c5 32 87 b2 de 47 ba 01 95 d4 77 57 d6 6a 7f 27

   {server}  extract secret "master":

      salt (32 octets):  81 5a a6 19 d7 e1 bd 00 78 f3 f0 8e be 8c 89 81
         c5 32 87 b2 de 47 ba 01 95 d4 77 57 d6 6a 7f 27

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  db 3b ad 91 45 43 5a 7d ca 5f 84 17 aa 4d 44
         1d b9 12 e2 fe 6b cc 4e f6 57 18 66 de f1 32 d9 c7

   {server}  send handshake record:

      payload (123 octets):  02 00 00 77 03 03 76 96 ef f9 ed 79 5d e9
         89 07 bb 4b c8 b1 21 b5 9a a5 10 95 6d d9 0b bc 76 77 13 46 aa
         35 af eb 00 13 01 00 00 4f 00 33 00 45 00 17 00 41 04 8e 03 6d
         7e 6e 61 49 6f b2 ed 8b 3e 33 54 d0 df 5b 2e dd 94 9a cd 97 db
         f6 28 2c bc f8 48 39 ea f5 15 51 6f 85 a6 3c 4e 46 87 f6 10 64
         17 1d 6a 51 39 af ab 8e a4 b5 95 8a c5 d6 18 de b2 46 8a 00 2b
         00 02 7f 1c

      complete record (128 octets):  16 03 03 00 7b 02 00 00 77 03 03 76
         96 ef f9 ed 79 5d e9 89 07 bb 4b c8 b1 21 b5 9a a5 10 95 6d d9
         0b bc 76 77 13 46 aa 35 af eb 00 13 01 00 00 4f 00 33 00 45 00
         17 00 41 04 8e 03 6d 7e 6e 61 49 6f b2 ed 8b 3e 33 54 d0 df 5b
         2e dd 94 9a cd 97 db f6 28 2c bc f8 48 39 ea f5 15 51 6f 85 a6



Thomson                 Expires February 2, 2019               [Page 34]

Internet-Draft               TLS 1.3 Traces                  August 2018


         3c 4e 46 87 f6 10 64 17 1d 6a 51 39 af ab 8e a4 b5 95 8a c5 d6
         18 de b2 46 8a 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  20 59 bb d5 d6 6c e0 37 77 2e eb ef 6f b1 57 93
         f7 b8 70 de 49 75 66 e2 52 a6 8e e7 70 aa 6f 04

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  57 49 19 f8 10 d5 c9 db 95 6c d0 a1 a6
         3a fb c1

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  8a 2b 1f 6e ab d3 5d a4 19 82 3c a5

   {server}  construct a EncryptedExtensions handshake message

      EncryptedExtensions (28 octets):  08 00 00 18 00 16 00 0a 00 08 00
         06 00 17 00 18 00 1d 00 1c 00 02 40 01 00 00 00 00

   {server}  construct a Certificate handshake message

      Certificate (445 octets):  0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93
         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b
         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00

   {server}  construct a CertificateVerify handshake message



Thomson                 Expires February 2, 2019               [Page 35]

Internet-Draft               TLS 1.3 Traces                  August 2018


      CertificateVerify (136 octets):  0f 00 00 84 08 04 00 80 9e a9 4b
         f0 b7 db 15 c1 13 85 aa 61 fa 7f e9 15 a9 9b cf ff af ce 4a e4
         21 06 5e 40 58 e2 2b c7 6e 58 d4 3a 60 7e 7f 90 f6 3d 4d 64 14
         b4 27 e7 7f 39 2b 9a 54 43 aa bc 67 8c 54 c4 dd 5a 8e 51 5e dc
         6c 3a 7b 6e 91 a8 d1 aa f1 82 3c 8b f4 af 76 5c 3b 0b 12 0a 9e
         80 fb 25 be fa 9f 66 6f a1 ba f4 2c e7 10 ab be 01 e9 65 b1 9d
         50 a0 0b 95 06 e0 23 38 30 57 99 4e da 8f 4a ab a5 0a 67 17

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  20 59 bb d5 d6 6c e0 37 77 2e eb ef 6f b1 57 93
         f7 b8 70 de 49 75 66 e2 52 a6 8e e7 70 aa 6f 04

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  7b e4 99 89 3b f8 57 4e d0 0f 1c f4 6d fb
         21 27 d4 cb 2e 97 f9 3c 32 45 76 89 d7 c3 54 bf f4 16

   {server}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 8d dd df c0 ba f2 fb ca 60 48
         d0 45 02 61 d3 0e 4a ad eb 1d d1 be 37 08 1c e8 bc 08 a3 c5 80
         b4

   {server}  send handshake record:

      payload (645 octets):  08 00 00 18 00 16 00 0a 00 08 00 06 00 17
         00 18 00 1d 00 1c 00 02 40 01 00 00 00 00 0b 00 01 b9 00 00 01
         b5 00 01 b0 30 82 01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30
         0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31
         32 33 35 39 5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30
         0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06
         09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81
         81 00 b4 bb 49 8f 82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68
         de 55 e1 bd b8 26 d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc
         9a 95 13 7a ce 6c 1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87
         a8 0e e0 cc b0 52 4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a
         5f da 43 08 46 74 80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6
         d1 d0 3e 2b d1 93 ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7
         9f 7f 1e 3f 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04
         02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a
         86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27
         6b 90 8c 65 f7 3a 72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5
         94 36 54 17 f2 ea e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5



Thomson                 Expires February 2, 2019               [Page 36]

Internet-Draft               TLS 1.3 Traces                  August 2018


         5b 80 f2 1a 03 01 51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70
         2e 60 8c ca e6 be c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9
         b9 eb 2b d5 20 3b 1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d
         40 2d cc 0c c8 f8 96 12 29 ac 91 87 b4 2b 4d e1 00 00 0f 00 00
         84 08 04 00 80 9e a9 4b f0 b7 db 15 c1 13 85 aa 61 fa 7f e9 15
         a9 9b cf ff af ce 4a e4 21 06 5e 40 58 e2 2b c7 6e 58 d4 3a 60
         7e 7f 90 f6 3d 4d 64 14 b4 27 e7 7f 39 2b 9a 54 43 aa bc 67 8c
         54 c4 dd 5a 8e 51 5e dc 6c 3a 7b 6e 91 a8 d1 aa f1 82 3c 8b f4
         af 76 5c 3b 0b 12 0a 9e 80 fb 25 be fa 9f 66 6f a1 ba f4 2c e7
         10 ab be 01 e9 65 b1 9d 50 a0 0b 95 06 e0 23 38 30 57 99 4e da
         8f 4a ab a5 0a 67 17 14 00 00 20 8d dd df c0 ba f2 fb ca 60 48
         d0 45 02 61 d3 0e 4a ad eb 1d d1 be 37 08 1c e8 bc 08 a3 c5 80
         b4

      complete record (667 octets):  17 03 03 02 96 27 9a 07 0c 52 31 82
         c7 c6 2e 9f e4 5b c3 dc 99 5f cd 94 1a 26 e8 9a 53 1b 41 a0 c7
         b8 1d a7 aa 9b 76 45 18 85 f8 ca c8 b3 68 7c 5f b9 d8 42 a1 91
         bd 84 05 79 a6 48 d1 1a 9b 53 2b 56 c5 ce 67 d6 1c 07 d9 26 e0
         a1 da f7 e2 03 24 8f c8 ba 2a 73 d9 b2 87 7b 12 e1 e5 e6 cb 59
         d1 3a 66 3c ac 3e 43 06 88 8b 3e ce 90 3c 0b a1 0f fb 5f dc 62
         7d 97 5e 89 f1 ff 7d 64 b4 93 0d 07 0c e8 cf 17 f0 89 72 31 2f
         f7 57 c8 83 4d ce fc 0f 82 64 a1 b5 64 7b 59 71 55 52 36 d5 60
         19 13 e0 ca bc 03 16 a6 7f 2f e3 61 c2 97 e8 27 41 08 af 0e d6
         90 ef ed 42 74 5d 7e 35 1d 68 93 22 f6 1a e1 43 9a 1b c9 ba 70
         75 2a 3a 7f 6a 68 7e fc bf 46 c9 9b 5f 91 04 c3 88 92 7f 40 ca
         25 51 11 4c d0 8f 6f a1 06 92 68 4f 3a 9d 53 63 2c 85 d5 f7 ef
         1c 0d 92 89 e3 82 6a 71 71 93 96 b0 7d 70 d3 28 40 c2 0c ec de
         b3 06 8a d4 b1 9a 6a c4 5a c2 63 be e1 23 d5 63 c9 03 c9 71 96
         2d c0 19 f8 8e 27 e4 7a e7 86 85 0d fb d5 c2 c9 7e ce 56 5b cc
         d6 c1 27 ab b6 f4 19 98 d2 21 32 59 f5 d2 69 7c a3 8f c5 55 31
         a0 9b 6c 2b ee 6c 01 3b 1b 26 51 5e f8 38 56 9f 0b 6b e8 02 4c
         00 45 86 28 5c c4 96 d5 7b 52 7e 2e 9c 41 9a dd b9 7c 97 d6 67
         1f 66 98 d7 34 a1 b3 c0 77 ab 6e 73 12 ee 17 4d cd b9 3c 31 28
         86 4c b6 49 72 9d f2 b9 2d 6a 4f 7b 2c 13 bb 4d c3 41 22 f5 0c
         bf 61 18 ba dd 8b 08 bb ab 38 f2 30 fb 06 79 84 09 99 26 14 6f
         36 f4 93 28 9e 7d 49 37 8d 2e e4 4f f4 10 d0 ea c0 6c e0 09 66
         74 0c 1d 1d a4 d1 42 79 f7 5e 83 bd 9c e1 31 16 db 42 ec a7 d6
         58 b0 68 07 f1 0d 23 fd 56 b7 e1 3b bd 3f 7b 1f 1d 52 ac 5f f9
         ef 02 2b 16 3b 8b c2 05 d9 ce b1 43 f6 c6 d9 68 1b f0 3a 7c 99
         e3 66 b3 53 df db 25 ed 9c 53 8b 9f ea 6d 98 95 b2 99 af 92 98
         d8 7a 9a 0a 70 73 1f dc ae ed 4a 39 38 88 8b 0f e6 23 ed 1d 2d
         48 bf ff df be 55 37 cc d2 38 e6 86 10 13 51 d7 26 f2 66 d8 6a
         46 17 80 9b ad ab 7b 34 3b ca 5b 42 54 02 09 07 d1 75 59 9b 76
         93 d2 20 79 74 b4 d8 d3 d9 3b 3d a7 da 96 d9 d8 0d 8b 87 70 32
         b6 70 8e 74 97 15 38 23 2e 62 5f c9 12 96 5e 8c a0 c9 a6 00 fb
         6e 9b d8 9e 3a 47 2c 1d 02 68 12 a2 0e b7 70 4a ae 7c 71 28 55
         e1 9b 98 e3




Thomson                 Expires February 2, 2019               [Page 37]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  db 3b ad 91 45 43 5a 7d ca 5f 84 17 aa 4d 44 1d
         b9 12 e2 fe 6b cc 4e f6 57 18 66 de f1 32 d9 c7

      hash (32 octets):  c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c d2
         4b 4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c
         d2 4b 4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      expanded (32 octets):  1c fc 35 dc 50 55 19 ab e3 81 de fa c9 32
         51 42 ed 11 50 c5 63 91 48 6e df 71 be b8 ae 7b c0 66

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  db 3b ad 91 45 43 5a 7d ca 5f 84 17 aa 4d 44 1d
         b9 12 e2 fe 6b cc 4e f6 57 18 66 de f1 32 d9 c7

      hash (32 octets):  c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c d2
         4b 4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c
         d2 4b 4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      expanded (32 octets):  a3 04 c0 bd 92 3a 15 94 2b 3e c8 12 97 d9
         54 55 1b 45 f5 67 5c a2 9b ba a6 03 9a 3e cb 9f 80 5f

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  db 3b ad 91 45 43 5a 7d ca 5f 84 17 aa 4d 44 1d
         b9 12 e2 fe 6b cc 4e f6 57 18 66 de f1 32 d9 c7

      hash (32 octets):  c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c d2
         4b 4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 c4 21 e0 38 7a d0 05 bd fb 9e d2 c6 1c b2 7c d2 4b
         4e 64 c8 a5 90 78 45 00 c4 2c 63 4f 70 b8 27

      expanded (32 octets):  56 af 56 fc 87 09 38 55 c8 6c 51 37 ae f3
         27 48 90 7f af 7f 20 59 01 3b f7 19 4f 1c a5 7a d5 e6

   {server}  derive write traffic keys for application data:





Thomson                 Expires February 2, 2019               [Page 38]

Internet-Draft               TLS 1.3 Traces                  August 2018


      PRK (32 octets):  a3 04 c0 bd 92 3a 15 94 2b 3e c8 12 97 d9 54 55
         1b 45 f5 67 5c a2 9b ba a6 03 9a 3e cb 9f 80 5f

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  9b 58 52 84 8a a6 af 1a 12 cb 35 c1 ff
         77 d4 fb

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  61 7a 3b d5 82 b4 13 88 df 17 40 59

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  af a2 64 1a e4 31 ad 0f e5 f4 fc 54 c3 6a f1 0f
         f8 14 b1 f3 6e 9a f0 47 18 fc ae 00 2b 6d 46 c2

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  49 32 02 d4 09 dc 32 5c 13 de d1 3f 07
         2c 7a 6e

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  b8 28 7b 43 4f 5d 43 8b 64 06 68 2a

   {client}  extract secret "early" (same as server early secret)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake" (same as server handshake
      secret)

   {client}  derive secret "tls13 c hs traffic" (same as server)




Thomson                 Expires February 2, 2019               [Page 39]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server master secret)

   {client}  derive read traffic keys for handshake data (same as server
      handshake data write traffic keys)

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server handshake data read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server application data write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  af a2 64 1a e4 31 ad 0f e5 f4 fc 54 c3 6a f1 0f
         f8 14 b1 f3 6e 9a f0 47 18 fc ae 00 2b 6d 46 c2

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  2b 0d e8 77 eb dd c4 a9 54 34 90 59 0a bb
         4c 73 25 d6 6d 39 7c f6 10 d9 57 3d b4 5f 00 ce 1b 7b

   {client}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 ef 89 eb 7f c9 a2 f9 c3 89 47
         73 c9 2f cf b5 cb 02 09 09 f5 dd 46 ff bd 4c 5f 2b 8b b8 1a 0c
         a3

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 ef 89 eb 7f c9 a2 f9 c3 89 47 73
         c9 2f cf b5 cb 02 09 09 f5 dd 46 ff bd 4c 5f 2b 8b b8 1a 0c a3





Thomson                 Expires February 2, 2019               [Page 40]

Internet-Draft               TLS 1.3 Traces                  August 2018


      complete record (58 octets):  17 03 03 00 35 0c 1d 4d 6f 8e 5e 69
         43 10 bf f3 6e 57 92 a6 de c8 c0 f8 b8 82 5b 9b 46 1f a4 1b ba
         49 9d b9 3e cd 9a 6c aa ae f1 ae 89 26 76 f8 b3 34 44 2d bb 01
         23 58 6e 79

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  1c fc 35 dc 50 55 19 ab e3 81 de fa c9 32 51 42
         ed 11 50 c5 63 91 48 6e df 71 be b8 ae 7b c0 66

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  bc 73 f7 25 9f c7 a2 ac e9 3c bb ef 46
         05 b9 60

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  29 01 8e 59 4b 07 a1 58 0a da 37 e1

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  db 3b ad 91 45 43 5a 7d ca 5f 84 17 aa 4d 44 1d
         b9 12 e2 fe 6b cc 4e f6 57 18 66 de f1 32 d9 c7

      hash (32 octets):  5e b6 ee c4 75 5b db df 71 d0 9a a3 5c 4f 76 5d
         df f4 0f 0b c7 75 d0 94 c4 7b 6e 8e 8f b0 e9 3b

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 5e b6 ee c4 75 5b db df 71 d0 9a a3 5c 4f 76 5d df
         f4 0f 0b c7 75 d0 94 c4 7b 6e 8e 8f b0 e9 3b

      expanded (32 octets):  48 9f 34 df 05 85 49 ea 35 06 85 31 7a ff
         5e a7 fe b1 ee 40 76 b0 ae 4d 0f 86 71 79 a8 5a 6e 9a

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client application data write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 5d ab 4c fc 48 a6 fb
         b2 8c 05 09 28 da f7 57 61 93 10 c0




Thomson                 Expires February 2, 2019               [Page 41]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 73 8a 1b 72 e0 3d e1
         63 0b 28 ff d9 c7 0a 6a f0 c5 89 ab

6.  Client Authentication

   In this example, the server requests client authentication.  The
   client uses a certificate with an RSA key, the server uses an ECDSA
   certificate with a P-256 key.  Note that private keys for the
   certificates used this example are not shown.

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  85 72 5c 47 6c 7a 07 da a2 d9 f3 c6 32
         c4 3f be 9b 3f 19 7e 20 51 65 bf 99 b2 f2 55 85 8a 91 a3

      public key (32 octets):  12 22 5f 2b 4e fb 47 97 43 8a 36 4a a9 a3
         d3 78 94 c0 66 d0 31 2d 86 77 18 aa 10 34 f6 66 c7 64

   {client}  construct a ClientHello handshake message

      ClientHello (192 octets):  01 00 00 bc 03 03 91 c9 2b be d6 31 33
         1e 66 67 af 4a af d8 81 72 7f f8 1b 4c 5b 80 44 05 35 5b c6 62
         31 29 6b 6c 00 00 06 13 01 13 03 13 02 01 00 00 8d 00 00 00 0b
         00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33
         00 26 00 24 00 1d 00 20 12 22 5f 2b 4e fb 47 97 43 8a 36 4a a9
         a3 d3 78 94 c0 66 d0 31 2d 86 77 18 aa 10 34 f6 66 c7 64 00 2b
         00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04
         08 05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00
         2d 00 02 01 01 00 1c 00 02 40 01

   {client}  send handshake record:

      payload (192 octets):  01 00 00 bc 03 03 91 c9 2b be d6 31 33 1e
         66 67 af 4a af d8 81 72 7f f8 1b 4c 5b 80 44 05 35 5b c6 62 31
         29 6b 6c 00 00 06 13 01 13 03 13 02 01 00 00 8d 00 00 00 0b 00
         09 00 00 06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12
         00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00
         26 00 24 00 1d 00 20 12 22 5f 2b 4e fb 47 97 43 8a 36 4a a9 a3
         d3 78 94 c0 66 d0 31 2d 86 77 18 aa 10 34 f6 66 c7 64 00 2b 00
         03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08
         05 08 06 04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d
         00 02 01 01 00 1c 00 02 40 01




Thomson                 Expires February 2, 2019               [Page 42]

Internet-Draft               TLS 1.3 Traces                  August 2018


      complete record (197 octets):  16 03 01 00 c0 01 00 00 bc 03 03 91
         c9 2b be d6 31 33 1e 66 67 af 4a af d8 81 72 7f f8 1b 4c 5b 80
         44 05 35 5b c6 62 31 29 6b 6c 00 00 06 13 01 13 03 13 02 01 00
         00 8d 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72 ff 01 00 01
         00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02
         01 03 01 04 00 33 00 26 00 24 00 1d 00 20 12 22 5f 2b 4e fb 47
         97 43 8a 36 4a a9 a3 d3 78 94 c0 66 d0 31 2d 86 77 18 aa 10 34
         f6 66 c7 64 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e 04 03 05 03
         06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02 05
         02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  87 52 43 73 46 53 fa 6d 4b b0 a8 05 36
         dd 94 71 f3 33 3f a0 60 a8 24 a6 6f 97 7b 04 fa d9 9f b0

      public key (32 octets):  e2 19 50 4c 29 50 2d a3 a2 fa 2c 8a 49 2b
         56 53 8b 36 3f 9f b3 13 7e 3a be b1 e7 7e 98 5b 08 5b

   {server}  construct a ServerHello handshake message

      ServerHello (90 octets):  02 00 00 56 03 03 7e ff 63 35 e9 af ff
         bb d6 b4 1a d0 81 fb 1e 96 d9 4b e4 7e 8b f5 9e 81 a0 3b 7d 17
         ba 7e af 6b 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 e2 19 50
         4c 29 50 2d a3 a2 fa 2c 8a 49 2b 56 53 8b 36 3f 9f b3 13 7e 3a
         be b1 e7 7e 98 5b 08 5b 00 2b 00 02 7f 1c

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55



Thomson                 Expires February 2, 2019               [Page 43]

Internet-Draft               TLS 1.3 Traces                  August 2018


      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

      IKM (32 octets):  8b ec b1 3f 29 d6 1f 48 4a 60 7b 07 56 50 a0 ed
         b0 15 92 a7 a2 07 e5 f6 63 e5 92 99 2f 3d 8e 77

      secret (32 octets):  ee db e3 c9 1b bd 33 9d 63 40 f6 2c 7b a1 b0
         ca e6 df d8 f7 ba e7 87 92 56 a6 df 5f a8 7e 83 45

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  ee db e3 c9 1b bd 33 9d 63 40 f6 2c 7b a1 b0 ca
         e6 df d8 f7 ba e7 87 92 56 a6 df 5f a8 7e 83 45

      hash (32 octets):  83 58 17 3f e6 b6 a9 b9 08 15 b1 87 3e e9 50 cc
         cf 85 8b 3e 64 dd 08 f8 16 e0 ab 27 d5 05 48 d1

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 83 58 17 3f e6 b6 a9 b9 08 15 b1 87 3e e9 50
         cc cf 85 8b 3e 64 dd 08 f8 16 e0 ab 27 d5 05 48 d1

      expanded (32 octets):  bb 43 50 4e 59 6e 46 86 b1 24 f6 18 65 f8
         98 c4 31 e3 2d b6 07 0c a5 48 50 02 c1 ea 2e 9e 66 06

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  ee db e3 c9 1b bd 33 9d 63 40 f6 2c 7b a1 b0 ca
         e6 df d8 f7 ba e7 87 92 56 a6 df 5f a8 7e 83 45

      hash (32 octets):  83 58 17 3f e6 b6 a9 b9 08 15 b1 87 3e e9 50 cc
         cf 85 8b 3e 64 dd 08 f8 16 e0 ab 27 d5 05 48 d1

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 83 58 17 3f e6 b6 a9 b9 08 15 b1 87 3e e9 50
         cc cf 85 8b 3e 64 dd 08 f8 16 e0 ab 27 d5 05 48 d1

      expanded (32 octets):  1e 0f d5 de f2 20 aa f5 f3 ea 23 b6 fa f0
         02 f0 3d 2a 22 71 19 92 c7 5b 92 48 d6 72 07 79 e9 81

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  ee db e3 c9 1b bd 33 9d 63 40 f6 2c 7b a1 b0 ca
         e6 df d8 f7 ba e7 87 92 56 a6 df 5f a8 7e 83 45



Thomson                 Expires February 2, 2019               [Page 44]

Internet-Draft               TLS 1.3 Traces                  August 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6c 24 2c 1c 94 cf 3f 86 d8 37 93 9e 28 31
         2c 7a 22 fb 99 e9 a9 d6 d2 96 f3 3a 20 81 f8 3f 61 c2

   {server}  extract secret "master":

      salt (32 octets):  6c 24 2c 1c 94 cf 3f 86 d8 37 93 9e 28 31 2c 7a
         22 fb 99 e9 a9 d6 d2 96 f3 3a 20 81 f8 3f 61 c2

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  67 af fd b2 85 1a 4a 4f 7b eb 6c 4f 3e 65 b6
         6a 0b 8e d0 90 6b d5 2b 82 d0 ea 46 38 c0 a5 cd 01

   {server}  send handshake record:

      payload (90 octets):  02 00 00 56 03 03 7e ff 63 35 e9 af ff bb d6
         b4 1a d0 81 fb 1e 96 d9 4b e4 7e 8b f5 9e 81 a0 3b 7d 17 ba 7e
         af 6b 00 13 01 00 00 2e 00 33 00 24 00 1d 00 20 e2 19 50 4c 29
         50 2d a3 a2 fa 2c 8a 49 2b 56 53 8b 36 3f 9f b3 13 7e 3a be b1
         e7 7e 98 5b 08 5b 00 2b 00 02 7f 1c

      complete record (95 octets):  16 03 03 00 5a 02 00 00 56 03 03 7e
         ff 63 35 e9 af ff bb d6 b4 1a d0 81 fb 1e 96 d9 4b e4 7e 8b f5
         9e 81 a0 3b 7d 17 ba 7e af 6b 00 13 01 00 00 2e 00 33 00 24 00
         1d 00 20 e2 19 50 4c 29 50 2d a3 a2 fa 2c 8a 49 2b 56 53 8b 36
         3f 9f b3 13 7e 3a be b1 e7 7e 98 5b 08 5b 00 2b 00 02 7f 1c

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  1e 0f d5 de f2 20 aa f5 f3 ea 23 b6 fa f0 02 f0
         3d 2a 22 71 19 92 c7 5b 92 48 d6 72 07 79 e9 81

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  24 5b fe 0b ea db 40 95 b4 51 e1 57 84
         4a 78 9d

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  b1 a8 7f 1e ef c4 3f 62 77 07 f2 97



Thomson                 Expires February 2, 2019               [Page 45]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  construct a EncryptedExtensions handshake message

      EncryptedExtensions (40 octets):  08 00 00 24 00 22 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c
         00 02 40 01 00 00 00 00

   {server}  construct a CertificateRequest handshake message

      CertificateRequest (43 octets):  0d 00 00 27 00 00 24 00 0d 00 20
         00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06
         01 02 01 04 02 05 02 06 02 02 02

   {server}  construct a Certificate handshake message

      Certificate (319 octets):  0b 00 01 3b 00 00 01 37 00 01 32 30 82
         01 2e 30 81 d5 a0 03 02 01 02 02 01 07 30 0a 06 08 2a 86 48 ce
         3d 04 03 02 30 13 31 11 30 0f 06 03 55 04 03 13 08 65 63 64 73
         61 32 35 36 30 1e 17 0d 31 36 30 37 33 30 30 31 32 34 30 30 5a
         17 0d 32 36 30 37 33 30 30 31 32 34 30 30 5a 30 13 31 11 30 0f
         06 03 55 04 03 13 08 65 63 64 73 61 32 35 36 30 59 30 13 06 07
         2a 86 48 ce 3d 02 01 06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04
         08 d5 30 16 15 75 f4 cf e7 f1 54 ee 34 48 18 00 86 00 1e 88 43
         1a 79 ee 62 ee 6e 2f 83 ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4
         d2 f5 b5 6d 1f 04 ec e4 5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d
         d0 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55
         1d 0f 04 04 03 02 07 80 30 0a 06 08 2a 86 48 ce 3d 04 03 02 03
         48 00 30 45 02 21 00 df 30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4
         79 ca 69 3f ee ca 3b 71 b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62
         e2 a4 72 50 d3 20 fe a8 3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db
         d1 3f ee 94 6e 51 3e 01 1d 11 00 00

   {server}  construct a CertificateVerify handshake message

      CertificateVerify (78 octets):  0f 00 00 4a 04 03 00 46 30 44 02
         20 4f 19 c4 25 37 c2 fe 2d 5f 77 c3 fd fb 41 18 94 b9 5c 2a c6
         9f 9d a7 7d 3e b1 3f 1b 0d e2 2e 2f 02 20 67 ae e1 a5 18 ce cf
         27 82 2e 8d 89 fc ff 7a 5a 99 f3 2e 0f 63 1d cb 94 68 73 30 e3
         04 06 d9 d0

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  1e 0f d5 de f2 20 aa f5 f3 ea 23 b6 fa f0 02 f0
         3d 2a 22 71 19 92 c7 5b 92 48 d6 72 07 79 e9 81

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00



Thomson                 Expires February 2, 2019               [Page 46]

Internet-Draft               TLS 1.3 Traces                  August 2018


      expanded (32 octets):  f6 fe 83 8a 57 b1 a4 72 fd 68 1b c9 a1 1b
         cd f0 5d e1 7f bf 25 5e ed 99 3c 1a 78 13 5f 5f db 85

   {server}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 48 54 bc 32 82 a6 75 a8 b8 ad
         4d 23 ae 39 fd 90 1a 09 66 47 03 d3 61 99 38 44 be 61 8c 6b fd
         c6

   {server}  send handshake record:

      payload (516 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0d 00 00 27 00 00 24 00 0d 00 20 00 1e 04 03 05
         03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02 01 04 02
         05 02 06 02 02 02 0b 00 01 3b 00 00 01 37 00 01 32 30 82 01 2e
         30 81 d5 a0 03 02 01 02 02 01 07 30 0a 06 08 2a 86 48 ce 3d 04
         03 02 30 13 31 11 30 0f 06 03 55 04 03 13 08 65 63 64 73 61 32
         35 36 30 1e 17 0d 31 36 30 37 33 30 30 31 32 34 30 30 5a 17 0d
         32 36 30 37 33 30 30 31 32 34 30 30 5a 30 13 31 11 30 0f 06 03
         55 04 03 13 08 65 63 64 73 61 32 35 36 30 59 30 13 06 07 2a 86
         48 ce 3d 02 01 06 08 2a 86 48 ce 3d 03 01 07 03 42 00 04 08 d5
         30 16 15 75 f4 cf e7 f1 54 ee 34 48 18 00 86 00 1e 88 43 1a 79
         ee 62 ee 6e 2f 83 ef 38 ba 61 e9 fb 37 f3 4e 00 7a 7d f4 d2 f5
         b5 6d 1f 04 ec e4 5d 62 1f 46 84 06 f5 c3 a1 51 58 94 8d d0 a3
         1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d 0f
         04 04 03 02 07 80 30 0a 06 08 2a 86 48 ce 3d 04 03 02 03 48 00
         30 45 02 21 00 df 30 fd 45 07 f5 ed d2 2c 1a 6f f8 6d b4 79 ca
         69 3f ee ca 3b 71 b3 f9 ef 55 6b 29 37 c0 59 4d 02 20 62 e2 a4
         72 50 d3 20 fe a8 3c 7e 2d cb 5b 76 a5 0e 02 00 c0 9a db d1 3f
         ee 94 6e 51 3e 01 1d 11 00 00 0f 00 00 4a 04 03 00 46 30 44 02
         20 4f 19 c4 25 37 c2 fe 2d 5f 77 c3 fd fb 41 18 94 b9 5c 2a c6
         9f 9d a7 7d 3e b1 3f 1b 0d e2 2e 2f 02 20 67 ae e1 a5 18 ce cf
         27 82 2e 8d 89 fc ff 7a 5a 99 f3 2e 0f 63 1d cb 94 68 73 30 e3
         04 06 d9 d0 14 00 00 20 48 54 bc 32 82 a6 75 a8 b8 ad 4d 23 ae
         39 fd 90 1a 09 66 47 03 d3 61 99 38 44 be 61 8c 6b fd c6

      complete record (538 octets):  17 03 03 02 15 b7 98 9d 5f 61 a7 94
         0a 30 79 c5 06 c7 97 2d b7 46 54 8a 7c 20 e8 0f 29 1b c4 7c bb
         d0 20 71 02 41 1a 89 ce 18 54 e7 8b ec 59 2e 53 b4 e3 e1 95 0f
         99 12 58 dd d1 be 00 2c bd c6 c4 42 dd 24 b6 4c 8a e9 12 7d a3
         35 ae d3 67 d6 ca b1 c9 72 20 b3 1c 21 ba 8c 4b 08 be 87 8a 30
         db f2 dd 7e 5d f2 17 98 7f e6 5b 9b 84 5e e4 30 fe 03 da a7 de
         44 34 75 42 21 ec 9f 43 13 f8 d8 af 9b 96 51 07 94 be 01 a9 32
         2d 8d 60 fd b7 7a b7 45 fa cf 0b e2 af 01 55 ba 39 b0 2b d7 33
         64 b1 55 09 c3 22 f9 a0 b2 03 fa 4a f3 c1 c7 d4 67 09 7b fc 3f
         8a ef 99 53 c6 ec 1d ac b2 2d 0b c9 30 2f e5 2a 2e e5 7a d6 c8
         a8 cd 69 77 f3 9a 3c 01 1b 09 f9 f0 6a b2 df 9c f5 00 e7 d7 0d



Thomson                 Expires February 2, 2019               [Page 47]

Internet-Draft               TLS 1.3 Traces                  August 2018


         d6 56 c4 ba cd c2 46 ab 06 9e 01 19 7a 1c 4e 38 73 6b f9 0c 9e
         33 ea 96 a2 9b 8f ff 62 56 f1 3a 07 a1 1d e2 b7 ef 3d 93 98 dd
         36 6a c0 74 98 a9 94 6d 96 ca a5 a0 cd 82 8b 89 e7 fc b8 5d dd
         68 1e 62 38 13 42 5d d4 0a 1c a0 eb a0 8e 69 b0 8a 3a 8f a4 02
         04 d6 b1 69 ef 68 89 2e 18 c0 de 28 50 71 99 23 c0 ce 4c 09 f9
         17 60 10 bd ff fe 84 eb f7 d9 40 46 8c 5b 9c e0 25 a8 93 96 43
         c5 34 8c e1 22 77 5d 71 b8 74 f6 4d b9 a3 39 f8 bd 87 bf f8 a3
         a0 76 f6 62 e4 ac da f8 9c 19 95 6e 7d 87 3d 7a 70 b9 16 79 ae
         35 6b bd d8 d6 7f d1 50 0b d9 d8 42 c3 d5 bd d5 99 e4 3d 12 b6
         46 a0 99 09 97 1b 75 bb cf 7f b8 e2 b6 a7 80 28 63 cf 9f 4b 47
         33 a0 47 1e ad b3 28 ab 24 c4 5b b5 f4 72 b0 48 07 9c c0 0d d4
         32 00 5e 9e 86 d5 16 f3 78 71 7d bc e4 6a c6 1b 61 a8 0e c3 2f
         4a 4b 45 2b 65 f7 28 cf af d7 a1 8e fc df 19 a0 11 54 5a 3a 30
         df 1c 37 6c 0f e3 63 3a 31 c1 a7 a2 cb d3 8f 1e ba bd b1 95 75
         de 4d 30 4c 72 6d 21 d3 0f e1 a0 08 5b f2 e6 20 4e 57 1f 2d 1f
         39

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  67 af fd b2 85 1a 4a 4f 7b eb 6c 4f 3e 65 b6 6a
         0b 8e d0 90 6b d5 2b 82 d0 ea 46 38 c0 a5 cd 01

      hash (32 octets):  ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be 61
         bd 71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be
         61 bd 71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      expanded (32 octets):  1d d9 ab 3a d0 89 8b 8d a7 35 bc bf 14 e1
         41 14 31 03 09 c4 33 b6 ff 02 26 cf 77 6c 58 bf 00 66

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  67 af fd b2 85 1a 4a 4f 7b eb 6c 4f 3e 65 b6 6a
         0b 8e d0 90 6b d5 2b 82 d0 ea 46 38 c0 a5 cd 01

      hash (32 octets):  ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be 61
         bd 71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be
         61 bd 71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      expanded (32 octets):  26 f3 a7 30 87 39 84 85 0a b3 a9 4c d6 fa
         6b 6d 99 57 c8 29 22 b3 af eb a8 47 f5 f6 7a ee 10 53

   {server}  derive secret "tls13 exp master":



Thomson                 Expires February 2, 2019               [Page 48]

Internet-Draft               TLS 1.3 Traces                  August 2018


      PRK (32 octets):  67 af fd b2 85 1a 4a 4f 7b eb 6c 4f 3e 65 b6 6a
         0b 8e d0 90 6b d5 2b 82 d0 ea 46 38 c0 a5 cd 01

      hash (32 octets):  ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be 61
         bd 71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 ad 3b 59 8f 65 1d f8 35 33 03 fa 4e e8 1e be 61 bd
         71 0f ad 36 35 2b 1d 64 e0 6c 9b f2 ea dd 72

      expanded (32 octets):  6f 07 b7 c2 95 45 15 09 52 b7 fd d7 b7 81
         de df 11 90 81 22 62 71 5b 78 b6 41 43 1d 16 27 16 af

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  26 f3 a7 30 87 39 84 85 0a b3 a9 4c d6 fa 6b 6d
         99 57 c8 29 22 b3 af eb a8 47 f5 f6 7a ee 10 53

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  50 ca 27 53 b1 aa 38 dd c2 3b 8d 6c 85
         99 9a 22

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  e8 59 de 67 49 16 b7 31 2b fe 15 43

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  bb 43 50 4e 59 6e 46 86 b1 24 f6 18 65 f8 98 c4
         31 e3 2d b6 07 0c a5 48 50 02 c1 ea 2e 9e 66 06

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  cb ac e5 5c 44 b5 6c c9 b6 bc ec c5 07
         b5 bd 5b

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  2c a3 3c aa c7 8e 30 db 90 d8 a2 cf

   {client}  extract secret "early" (same as server early secret)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a




Thomson                 Expires February 2, 2019               [Page 49]

Internet-Draft               TLS 1.3 Traces                  August 2018


      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake" (same as server handshake
      secret)

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server master secret)

   {client}  derive read traffic keys for handshake data (same as server
      handshake data write traffic keys)

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  derive write traffic keys for handshake data (same as
      server handshake data read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server application data write traffic keys)

   {client}  construct a Certificate handshake message

      Certificate (451 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82
         01 b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06
         63 6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35
         39 5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f
         30 0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06
         09 2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81
         81 00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7



Thomson                 Expires February 2, 2019               [Page 50]

Internet-Draft               TLS 1.3 Traces                  August 2018


         a1 c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81
         e5 22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f
         f1 90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97
         1c 7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7
         fe 9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7
         e0 28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04
         02 30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a
         86 48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0
         22 af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91
         6d c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80
         be 2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e
         f0 c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2
         17 bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac
         0f 78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00

   {client}  construct a CertificateVerify handshake message

      CertificateVerify (136 octets):  0f 00 00 84 08 04 00 80 94 7b 66
         55 c9 fa 48 4d 52 af f5 5a 44 51 76 60 7e 19 73 fd 12 cd c9 67
         f1 30 e9 3f a7 7d 76 21 31 32 47 6a 6c 15 75 4c 53 88 ff 22 f0
         87 a8 0e 8c c0 f3 f2 31 21 07 be 6a 33 07 a0 95 04 9e ed ac de
         fd 87 78 5f cb e7 a6 58 94 08 d2 54 c9 b1 86 a7 dc 30 8c f9 6e
         4e 78 75 9d b0 73 b2 ae d4 48 2d 87 a7 8c b0 d5 87 c9 11 fa df
         94 34 80 0f e0 e8 d1 f3 18 88 a5 b4 41 2f 5c 02 7a c9 d8 65

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  bb 43 50 4e 59 6e 46 86 b1 24 f6 18 65 f8 98 c4
         31 e3 2d b6 07 0c a5 48 50 02 c1 ea 2e 9e 66 06

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  5c 0e c5 97 f5 22 e4 82 51 c6 7e d5 d8 03
         7a 1b 3f a2 fa d2 59 6e 05 64 6e 72 b3 c7 09 b4 2a 03

   {client}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 9e c5 96 24 6b 86 30 a4 30 e9
         d7 d3 58 52 f6 b4 d5 85 a1 17 e8 76 b6 6c 65 ef ee 64 ac 70 ed
         15

   {client}  send handshake record:

      payload (623 octets):  0b 00 01 bf 00 00 01 bb 00 01 b6 30 82 01
         b2 30 82 01 1b a0 03 02 01 02 02 01 01 30 0d 06 09 2a 86 48 86



Thomson                 Expires February 2, 2019               [Page 51]

Internet-Draft               TLS 1.3 Traces                  August 2018


         f7 0d 01 01 0b 05 00 30 11 31 0f 30 0d 06 03 55 04 03 13 06 63
         6c 69 65 6e 74 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39
         5a 17 0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 11 31 0f 30
         0d 06 03 55 04 03 13 06 63 6c 69 65 6e 74 30 81 9f 30 0d 06 09
         2a 86 48 86 f7 0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81
         00 c3 81 75 e0 04 a6 8d 09 3f 82 3b 9c 37 9d 20 1f bc 0b b7 a1
         c7 91 90 5e 3f bf 76 84 7e 44 e7 51 eb bc d3 60 bd 94 5c 81 e5
         22 2b cc 88 46 d3 a8 a0 f9 3e 9b f5 be ba bd 92 ed f1 de 1f f1
         90 21 70 3e 7a b6 c0 90 15 13 f9 7e 39 b1 11 f0 9c 93 48 97 1c
         7b 21 19 84 a7 54 cd 45 fe 09 5a f0 ea 42 36 82 9b cc f7 a7 fe
         9b 28 88 e7 8a b4 77 69 0a 5b 9e 1c cb e9 1c 6a 4a 0f 97 a7 e0
         28 42 01 02 03 01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02
         30 00 30 0b 06 03 55 1d 0f 04 04 03 02 07 80 30 0d 06 09 2a 86
         48 86 f7 0d 01 01 0b 05 00 03 81 81 00 1a 7a 5a 01 85 32 b0 22
         af 07 67 d4 86 16 0c ff 2d 16 7a 19 15 d2 38 35 b5 45 94 91 6d
         c6 80 be 5d 2e 62 60 76 c5 d5 27 22 eb cc 77 5d 7d 99 f9 80 be
         2f c9 4d 34 ac f6 cc 00 ba 90 cb cf b0 60 8a a1 e7 e3 97 1e f0
         c0 7a 41 d4 7a d8 34 5d 1f 81 fe 41 8a 1c f4 10 54 42 9f d2 17
         bd 77 7d c1 cf 08 f0 5d f9 07 99 c6 59 36 1e 0f 1a 8e e4 ac 0f
         78 97 42 0b db c8 23 da 80 a2 f2 ba 23 08 1c 00 00 0f 00 00 84
         08 04 00 80 94 7b 66 55 c9 fa 48 4d 52 af f5 5a 44 51 76 60 7e
         19 73 fd 12 cd c9 67 f1 30 e9 3f a7 7d 76 21 31 32 47 6a 6c 15
         75 4c 53 88 ff 22 f0 87 a8 0e 8c c0 f3 f2 31 21 07 be 6a 33 07
         a0 95 04 9e ed ac de fd 87 78 5f cb e7 a6 58 94 08 d2 54 c9 b1
         86 a7 dc 30 8c f9 6e 4e 78 75 9d b0 73 b2 ae d4 48 2d 87 a7 8c
         b0 d5 87 c9 11 fa df 94 34 80 0f e0 e8 d1 f3 18 88 a5 b4 41 2f
         5c 02 7a c9 d8 65 14 00 00 20 9e c5 96 24 6b 86 30 a4 30 e9 d7
         d3 58 52 f6 b4 d5 85 a1 17 e8 76 b6 6c 65 ef ee 64 ac 70 ed 15

      complete record (645 octets):  17 03 03 02 80 64 10 0e d3 d6 3b df
         59 4a d8 93 4b 97 38 08 5a c8 cb 3e 3e fa 0f 1b 34 78 25 e5 db
         c7 9d af ca d2 a1 1e 50 21 7f 08 25 06 71 4e 5a c5 1f 96 dc 16
         da 5f cd f3 60 cc 82 9b 9b 04 8e 64 38 52 36 a9 30 e1 d1 e6 ac
         a0 3d 2e a7 6b d3 36 8c 15 68 0b 36 42 49 0b 86 6d 4d 0b 2a 57
         ab e0 ab 4d 94 a1 8e 63 80 bb d4 44 c0 fe 0e a0 9d 8f bd 88 ca
         f9 35 96 74 d0 fc 81 f6 14 3a 94 fa 7b aa 02 d3 7d 2f 21 b7 c1
         a1 c4 7b 7a e8 68 d5 83 51 f3 02 20 39 5d d9 41 62 aa 89 0c 19
         3a ba fd 27 31 e9 fd 88 65 be 77 6b 13 ea 26 28 90 e4 48 d9 de
         d6 83 9b 45 84 30 9b 99 c0 d1 df 5e 30 a8 81 cf 19 3b f0 80 8b
         c5 1e b4 01 ff 3e ba 95 72 78 ee 42 d3 bd 42 1b b9 d3 b7 b7 2f
         0d a8 23 26 c8 d8 0b 2b 99 97 58 07 db bc cb 35 0d 12 9f 1a 0f
         a4 f1 b7 e6 f1 2a 6a ab 16 92 12 81 eb 16 28 86 fb d7 3b 44 22
         ee 33 81 5f ac 66 9c 8f 4b 62 32 e8 07 c5 ff 6a 14 87 f9 95 d3
         21 93 c5 3a 52 58 a6 3d 6b cc 2a 8d 7c f7 53 7d 35 2c b1 51 a6
         7f 5d ad 5a 99 59 99 64 67 bc 9e 6a 77 ea a1 e3 a3 82 c4 04 cc
         cb 78 2f df 86 56 0e 77 ae 01 ba f9 ec c3 e1 b5 80 af b5 ca 89
         92 8f cf 12 a3 9a 0e c4 37 13 53 c5 0e ee a6 54 97 f7 ea da f6
         ca b7 d1 f6 d8 43 b7 c4 13 15 ca 9e 77 1b ba 88 84 31 55 df a2



Thomson                 Expires February 2, 2019               [Page 52]

Internet-Draft               TLS 1.3 Traces                  August 2018


         5c 44 cd c9 e9 62 59 77 ae 28 57 31 a2 e6 d3 3c 50 59 55 d1 f6
         60 c3 17 d9 4b 86 11 75 62 09 c9 1d 80 5a 26 72 de 00 22 3d 85
         7c 34 fe e6 cd f5 31 3b bc 72 c5 00 bf 76 dd 74 38 93 11 ef c3
         f7 c4 72 da a3 b7 a7 2f c3 66 42 61 01 90 23 4c ee 8b a1 67 75
         59 22 c1 c7 46 9b ba d5 e8 34 aa 66 aa fe 6d f3 e6 84 18 a9 8f
         38 c1 b9 5d 63 09 b8 f0 62 87 f8 d9 10 f6 9e 61 2a d1 46 fc f1
         67 cc 53 3a 4a bc 39 aa 3c dd a1 93 6a 9b 92 e5 7e de 75 11 f7
         70 6f 3a 55 a5 f4 68 19 53 86 fe 7b c9 da d5 78 46 11 7a a6 68
         c9 d2 8a 17 8f 2b 14 33 22 75 0b eb 58 93 f4 78 6c dd 91 03 01
         8e 66 41 4f 7d 23 14 3d 85 86 3b 3d 18 9e 78 5f 01 b7 7a c5 6b
         51 0f f7 2e 23 8d a0 c7 77 ad f5 23 11 66 9c 4b a3 e6 8e 91 91
         e6 d0 8f 67 56 55 21 ca 70 db db 77 46 ad 99 96 d8 87 a4 86 d5
         5a ce 98

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  1d d9 ab 3a d0 89 8b 8d a7 35 bc bf 14 e1 41 14
         31 03 09 c4 33 b6 ff 02 26 cf 77 6c 58 bf 00 66

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  9a d3 f6 3c 8e 4c 9f 0d 06 66 51 f9 d2
         e0 ae e3

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  d5 8e 35 29 4d 8b 79 72 53 41 34 79

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  67 af fd b2 85 1a 4a 4f 7b eb 6c 4f 3e 65 b6 6a
         0b 8e d0 90 6b d5 2b 82 d0 ea 46 38 c0 a5 cd 01

      hash (32 octets):  42 07 6b 5f dc 70 60 ac 3d f3 ca 8d ae ed 94 c4
         4b 64 94 ae 90 cd 9e 4e b9 bf 68 cd e4 4a 12 72

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 42 07 6b 5f dc 70 60 ac 3d f3 ca 8d ae ed 94 c4 4b
         64 94 ae 90 cd 9e 4e b9 bf 68 cd e4 4a 12 72

      expanded (32 octets):  17 0f 88 68 c5 bb 21 fd 5f 36 9c c0 e7 b9
         83 fd 02 d4 c6 be 9c 3e 3b c1 8b ba cc ba a5 2c 9b ef

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client application data write traffic keys)




Thomson                 Expires February 2, 2019               [Page 53]

Internet-Draft               TLS 1.3 Traces                  August 2018


   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 53 b0 8a 8e 51 c7 7c
         18 bd 75 16 10 cd 82 67 13 c3 f4 3e

   {server}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 38 4a 43 65 b8 e5 05
         44 0c bb 4f 38 d5 53 65 4e a4 2c 71

7.  Compatibility Mode

   This example shows use of the handshake with the client requesting
   that the server use compatibility mode as defined in Appendix D.4 of
   [TLS13].

   {client}  create an ephemeral x25519 key pair:

      private key (32 octets):  72 ff 4d fe c2 ad 49 ce fe 32 3f 7c 6b
         77 db d0 7e 1e 3f 2a 2d f9 6e a2 39 df e1 0a 11 11 6e e0

      public key (32 octets):  08 45 64 b9 37 2f 79 2d ad 7e 52 50 31 38
         fa 1c 20 b3 c9 50 7c 0f 81 76 51 67 c9 2b 8f 46 2e 79

   {client}  construct a ClientHello handshake message

      ClientHello (224 octets):  01 00 00 dc 03 03 34 9b c9 e0 36 de c5
         ab c6 a6 bf 08 4b a9 e4 19 63 8d 4f 85 84 28 1c e7 30 94 40 c2
         ec bc 8a 8a 20 8e 29 f2 d2 08 e6 ab 56 1c c2 81 89 d4 7d 61 7a
         dd 6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5 6f 00 06 13 01 13
         03 13 02 01 00 00 8d 00 00 00 0b 00 09 00 00 06 73 65 72 76 65
         72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01
         00 01 01 01 02 01 03 01 04 00 33 00 26 00 24 00 1d 00 20 08 45
         64 b9 37 2f 79 2d ad 7e 52 50 31 38 fa 1c 20 b3 c9 50 7c 0f 81
         76 51 67 c9 2b 8f 46 2e 79 00 2b 00 03 02 7f 1c 00 0d 00 20 00
         1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01
         02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40
         01

   {client}  send handshake record:





Thomson                 Expires February 2, 2019               [Page 54]

Internet-Draft               TLS 1.3 Traces                  August 2018


      payload (224 octets):  01 00 00 dc 03 03 34 9b c9 e0 36 de c5 ab
         c6 a6 bf 08 4b a9 e4 19 63 8d 4f 85 84 28 1c e7 30 94 40 c2 ec
         bc 8a 8a 20 8e 29 f2 d2 08 e6 ab 56 1c c2 81 89 d4 7d 61 7a dd
         6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5 6f 00 06 13 01 13 03
         13 02 01 00 00 8d 00 00 00 0b 00 09 00 00 06 73 65 72 76 65 72
         ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00 17 00 18 00 19 01 00
         01 01 01 02 01 03 01 04 00 33 00 26 00 24 00 1d 00 20 08 45 64
         b9 37 2f 79 2d ad 7e 52 50 31 38 fa 1c 20 b3 c9 50 7c 0f 81 76
         51 67 c9 2b 8f 46 2e 79 00 2b 00 03 02 7f 1c 00 0d 00 20 00 1e
         04 03 05 03 06 03 02 03 08 04 08 05 08 06 04 01 05 01 06 01 02
         01 04 02 05 02 06 02 02 02 00 2d 00 02 01 01 00 1c 00 02 40 01

      complete record (229 octets):  16 03 01 00 e0 01 00 00 dc 03 03 34
         9b c9 e0 36 de c5 ab c6 a6 bf 08 4b a9 e4 19 63 8d 4f 85 84 28
         1c e7 30 94 40 c2 ec bc 8a 8a 20 8e 29 f2 d2 08 e6 ab 56 1c c2
         81 89 d4 7d 61 7a dd 6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5
         6f 00 06 13 01 13 03 13 02 01 00 00 8d 00 00 00 0b 00 09 00 00
         06 73 65 72 76 65 72 ff 01 00 01 00 00 0a 00 14 00 12 00 1d 00
         17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 33 00 26 00 24
         00 1d 00 20 08 45 64 b9 37 2f 79 2d ad 7e 52 50 31 38 fa 1c 20
         b3 c9 50 7c 0f 81 76 51 67 c9 2b 8f 46 2e 79 00 2b 00 03 02 7f
         1c 00 0d 00 20 00 1e 04 03 05 03 06 03 02 03 08 04 08 05 08 06
         04 01 05 01 06 01 02 01 04 02 05 02 06 02 02 02 00 2d 00 02 01
         01 00 1c 00 02 40 01

   {server}  extract secret "early":

      salt:  (absent)

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c
         e2 10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

   {server}  create an ephemeral x25519 key pair:

      private key (32 octets):  72 0f da 9f 66 f7 55 9d 4e 2a 4c c7 52
         b1 2f e7 88 81 aa 1f 8a 5e 5f 96 b2 b3 fd 4e 98 d6 6a 03

      public key (32 octets):  2e c1 99 e4 ec c8 50 b6 ee 99 d8 78 70 9b
         7c 49 9c f5 6b b5 d5 2a 23 d2 aa e4 c9 73 5a 35 5a 5a

   {server}  construct a ServerHello handshake message

      ServerHello (122 octets):  02 00 00 76 03 03 df 55 b4 15 e0 1e 31
         69 ec 9c 10 35 3b a6 63 17 dc 88 3c 94 24 73 e0 80 ea cc 9a ce
         aa 4e 68 f3 20 8e 29 f2 d2 08 e6 ab 56 1c c2 81 89 d4 7d 61 7a



Thomson                 Expires February 2, 2019               [Page 55]

Internet-Draft               TLS 1.3 Traces                  August 2018


         dd 6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5 6f 13 01 00 00 2e
         00 33 00 24 00 1d 00 20 2e c1 99 e4 ec c8 50 b6 ee 99 d8 78 70
         9b 7c 49 9c f5 6b b5 d5 2a 23 d2 aa e4 c9 73 5a 35 5a 5a 00 2b
         00 02 7f 1c

   {server}  send handshake record:

      payload (122 octets):  02 00 00 76 03 03 df 55 b4 15 e0 1e 31 69
         ec 9c 10 35 3b a6 63 17 dc 88 3c 94 24 73 e0 80 ea cc 9a ce aa
         4e 68 f3 20 8e 29 f2 d2 08 e6 ab 56 1c c2 81 89 d4 7d 61 7a dd
         6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5 6f 13 01 00 00 2e 00
         33 00 24 00 1d 00 20 2e c1 99 e4 ec c8 50 b6 ee 99 d8 78 70 9b
         7c 49 9c f5 6b b5 d5 2a 23 d2 aa e4 c9 73 5a 35 5a 5a 00 2b 00
         02 7f 1c

      complete record (127 octets):  16 03 03 00 7a 02 00 00 76 03 03 df
         55 b4 15 e0 1e 31 69 ec 9c 10 35 3b a6 63 17 dc 88 3c 94 24 73
         e0 80 ea cc 9a ce aa 4e 68 f3 20 8e 29 f2 d2 08 e6 ab 56 1c c2
         81 89 d4 7d 61 7a dd 6a b9 3e c2 ea 06 ed 1d b1 f1 b3 9f 5b e5
         6f 13 01 00 00 2e 00 33 00 24 00 1d 00 20 2e c1 99 e4 ec c8 50
         b6 ee 99 d8 78 70 9b 7c 49 9c f5 6b b5 d5 2a 23 d2 aa e4 c9 73
         5a 35 5a 5a 00 2b 00 02 7f 1c

   {server}  send change_cipher_spec record:

      payload (1 octets):  01

      complete record (6 octets):  14 03 03 00 01 01

   {server}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {server}  extract secret "handshake":

      salt (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba b6 97
         16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba



Thomson                 Expires February 2, 2019               [Page 56]

Internet-Draft               TLS 1.3 Traces                  August 2018


      IKM (32 octets):  8b f8 25 4b da 76 f6 b5 59 eb 67 e8 2b e7 a8 7c
         ce 90 99 cf 87 ff c9 19 24 45 1f 18 12 3b 91 21

      secret (32 octets):  9f ac 43 5a 89 ae 47 bc cd 75 2b 59 33 ad 6c
         0a 52 8a 91 94 20 fb 2c 99 66 8b b6 1d 50 9e a1 31

   {server}  derive secret "tls13 c hs traffic":

      PRK (32 octets):  9f ac 43 5a 89 ae 47 bc cd 75 2b 59 33 ad 6c 0a
         52 8a 91 94 20 fb 2c 99 66 8b b6 1d 50 9e a1 31

      hash (32 octets):  6a 02 60 0c 59 8a 99 ff 0e 10 a3 a2 6b 33 a9 cb
         59 91 ed d8 e2 37 34 12 09 ca f7 8d 45 af 57 33

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 68 73 20 74 72
         61 66 66 69 63 20 6a 02 60 0c 59 8a 99 ff 0e 10 a3 a2 6b 33 a9
         cb 59 91 ed d8 e2 37 34 12 09 ca f7 8d 45 af 57 33

      expanded (32 octets):  54 19 0d d0 55 33 85 55 8c f2 3f cf 09 4e
         98 85 d9 e3 9c f6 2a 92 0a e0 c3 4a 50 70 57 04 4d 89

   {server}  derive secret "tls13 s hs traffic":

      PRK (32 octets):  9f ac 43 5a 89 ae 47 bc cd 75 2b 59 33 ad 6c 0a
         52 8a 91 94 20 fb 2c 99 66 8b b6 1d 50 9e a1 31

      hash (32 octets):  6a 02 60 0c 59 8a 99 ff 0e 10 a3 a2 6b 33 a9 cb
         59 91 ed d8 e2 37 34 12 09 ca f7 8d 45 af 57 33

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 68 73 20 74 72
         61 66 66 69 63 20 6a 02 60 0c 59 8a 99 ff 0e 10 a3 a2 6b 33 a9
         cb 59 91 ed d8 e2 37 34 12 09 ca f7 8d 45 af 57 33

      expanded (32 octets):  57 8e bc 0c b9 96 37 35 fb cd d0 1e 91 ce
         d9 31 0c 76 7a c9 26 e0 3c 40 c4 66 7d 08 16 f1 3c e9

   {server}  derive secret for master "tls13 derived":

      PRK (32 octets):  9f ac 43 5a 89 ae 47 bc cd 75 2b 59 33 ad 6c 0a
         52 8a 91 94 20 fb 2c 99 66 8b b6 1d 50 9e a1 31

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55

      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55




Thomson                 Expires February 2, 2019               [Page 57]

Internet-Draft               TLS 1.3 Traces                  August 2018


      expanded (32 octets):  c7 7b cf 41 03 d5 82 d7 c5 55 80 79 1f 6b
         ca 7f 19 71 bb 55 a8 eb 0a 0b d6 97 f2 fe f0 56 6b d2

   {server}  extract secret "master":

      salt (32 octets):  c7 7b cf 41 03 d5 82 d7 c5 55 80 79 1f 6b ca 7f
         19 71 bb 55 a8 eb 0a 0b d6 97 f2 fe f0 56 6b d2

      IKM (32 octets):  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
         00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

      secret (32 octets):  42 99 10 c7 8c fe d8 67 81 40 46 c1 30 c3 e8
         a8 bc 2a bb d4 3e 6e 82 ee 03 9d e2 14 5f dc 02 c9

   {server}  derive write traffic keys for handshake data:

      PRK (32 octets):  57 8e bc 0c b9 96 37 35 fb cd d0 1e 91 ce d9 31
         0c 76 7a c9 26 e0 3c 40 c4 66 7d 08 16 f1 3c e9

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  65 e6 53 af bc 59 03 85 1e f4 4f 64 d4
         57 d5 2f

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  84 16 3f 2b bb fb ae b9 89 f9 e6 94

   {server}  construct a EncryptedExtensions handshake message

      EncryptedExtensions (40 octets):  08 00 00 24 00 22 00 0a 00 14 00
         12 00 1d 00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c
         00 02 40 01 00 00 00 00

   {server}  construct a Certificate handshake message

      Certificate (445 octets):  0b 00 01 b9 00 00 01 b5 00 01 b0 30 82
         01 ac 30 82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48
         86 f7 0d 01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03
         72 73 61 30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17
         0d 32 36 30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06
         03 55 04 03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7
         0d 01 01 01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f
         82 79 30 3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26
         d3 90 1a 24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c
         1a f1 9e aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52
         4b 1b 01 8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74
         80 30 53 0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93



Thomson                 Expires February 2, 2019               [Page 58]

Internet-Draft               TLS 1.3 Traces                  August 2018


         ef f0 ab 9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03
         01 00 01 a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06
         03 55 1d 0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01
         01 0b 05 00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a
         72 67 17 06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea
         e8 f8 a5 8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01
         51 56 72 60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be
         c1 fc 63 a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b
         1c 3b 84 e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8
         96 12 29 ac 91 87 b4 2b 4d e1 00 00

   {server}  construct a CertificateVerify handshake message

      CertificateVerify (136 octets):  0f 00 00 84 08 04 00 80 24 7a e4
         51 7e 52 06 53 36 c2 9d d6 f0 b3 98 af f2 f9 1d d8 24 79 a7 9b
         d6 e4 4e db 5d fd 5c 66 44 2d 3d c5 e8 2b 52 63 b4 7c bb ec 5c
         a2 20 4c 54 a6 3b 09 1b 4a 61 72 ec 29 b2 c5 21 fe 0e 44 03 59
         af d3 0b b2 50 2c 8f 58 1f 64 92 99 14 b5 50 4e 9f 3b cc 68 3a
         12 19 19 02 31 0d 60 77 40 ed 5e b4 01 92 e9 ed 14 5f 9a 9a c3
         48 9d 34 38 d5 f4 81 70 c0 f5 b4 67 33 fd 8f 36 7d f5 ca 06

   {server}  calculate finished "tls13 finished":

      PRK (32 octets):  57 8e bc 0c b9 96 37 35 fb cd d0 1e 91 ce d9 31
         0c 76 7a c9 26 e0 3c 40 c4 66 7d 08 16 f1 3c e9

      hash (0 octets):  (empty)

      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  59 03 25 f6 ef 1e b2 33 6a 93 52 2f 1b cf
         f9 f0 bf d8 6b e3 92 55 a1 07 f9 0e 7d 36 f9 3f f2 2a

   {server}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 47 76 c4 f3 2f 95 48 b8 7c ab
         fb 48 be 27 0c 8a 39 ab 4e 61 ae dc 7b 77 0b df 65 cc b9 8b e9
         4d

   {server}  send handshake record:

      payload (657 octets):  08 00 00 24 00 22 00 0a 00 14 00 12 00 1d
         00 17 00 18 00 19 01 00 01 01 01 02 01 03 01 04 00 1c 00 02 40
         01 00 00 00 00 0b 00 01 b9 00 00 01 b5 00 01 b0 30 82 01 ac 30
         82 01 15 a0 03 02 01 02 02 01 02 30 0d 06 09 2a 86 48 86 f7 0d
         01 01 0b 05 00 30 0e 31 0c 30 0a 06 03 55 04 03 13 03 72 73 61
         30 1e 17 0d 31 36 30 37 33 30 30 31 32 33 35 39 5a 17 0d 32 36



Thomson                 Expires February 2, 2019               [Page 59]

Internet-Draft               TLS 1.3 Traces                  August 2018


         30 37 33 30 30 31 32 33 35 39 5a 30 0e 31 0c 30 0a 06 03 55 04
         03 13 03 72 73 61 30 81 9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01
         01 05 00 03 81 8d 00 30 81 89 02 81 81 00 b4 bb 49 8f 82 79 30
         3d 98 08 36 39 9b 36 c6 98 8c 0c 68 de 55 e1 bd b8 26 d3 90 1a
         24 61 ea fd 2d e4 9a 91 d0 15 ab bc 9a 95 13 7a ce 6c 1a f1 9e
         aa 6a f9 8c 7c ed 43 12 09 98 e1 87 a8 0e e0 cc b0 52 4b 1b 01
         8c 3e 0b 63 26 4d 44 9a 6d 38 e2 2a 5f da 43 08 46 74 80 30 53
         0e f0 46 1c 8c a9 d9 ef bf ae 8e a6 d1 d0 3e 2b d1 93 ef f0 ab
         9a 80 02 c4 74 28 a6 d3 5a 8d 88 d7 9f 7f 1e 3f 02 03 01 00 01
         a3 1a 30 18 30 09 06 03 55 1d 13 04 02 30 00 30 0b 06 03 55 1d
         0f 04 04 03 02 05 a0 30 0d 06 09 2a 86 48 86 f7 0d 01 01 0b 05
         00 03 81 81 00 85 aa d2 a0 e5 b9 27 6b 90 8c 65 f7 3a 72 67 17
         06 18 a5 4c 5f 8a 7b 33 7d 2d f7 a5 94 36 54 17 f2 ea e8 f8 a5
         8c 8f 81 72 f9 31 9c f3 6b 7f d6 c5 5b 80 f2 1a 03 01 51 56 72
         60 96 fd 33 5e 5e 67 f2 db f1 02 70 2e 60 8c ca e6 be c1 fc 63
         a4 2a 99 be 5c 3e b7 10 7c 3c 54 e9 b9 eb 2b d5 20 3b 1c 3b 84
         e0 a8 b2 f7 59 40 9b a3 ea c9 d9 1d 40 2d cc 0c c8 f8 96 12 29
         ac 91 87 b4 2b 4d e1 00 00 0f 00 00 84 08 04 00 80 24 7a e4 51
         7e 52 06 53 36 c2 9d d6 f0 b3 98 af f2 f9 1d d8 24 79 a7 9b d6
         e4 4e db 5d fd 5c 66 44 2d 3d c5 e8 2b 52 63 b4 7c bb ec 5c a2
         20 4c 54 a6 3b 09 1b 4a 61 72 ec 29 b2 c5 21 fe 0e 44 03 59 af
         d3 0b b2 50 2c 8f 58 1f 64 92 99 14 b5 50 4e 9f 3b cc 68 3a 12
         19 19 02 31 0d 60 77 40 ed 5e b4 01 92 e9 ed 14 5f 9a 9a c3 48
         9d 34 38 d5 f4 81 70 c0 f5 b4 67 33 fd 8f 36 7d f5 ca 06 14 00
         00 20 47 76 c4 f3 2f 95 48 b8 7c ab fb 48 be 27 0c 8a 39 ab 4e
         61 ae dc 7b 77 0b df 65 cc b9 8b e9 4d

      complete record (679 octets):  17 03 03 02 a2 66 16 b5 6d c4 88 39
         96 36 d4 35 f7 e0 e1 d9 55 43 f4 2e 78 35 62 b6 38 7b 2d dc e4
         2c bb 7d ff 46 e6 1c f0 9c 2f e6 6a 8e be 88 56 0d 2c 75 26 0d
         99 c4 10 44 0f 04 5d f2 40 0e 9b 00 0f 94 ac 39 15 fd ca 3c 7a
         bd dd 52 55 66 69 22 17 e7 8f 39 a0 e2 70 21 73 7c df c5 45 0f
         47 e8 14 d0 7c 97 d2 3e d3 bc 43 3f 9a 91 b8 f6 86 ee 9e 53 13
         3f 93 62 dc 58 b1 8a 30 bb 2f e7 72 4c 68 69 cd dd fa 04 7c eb
         c5 af 41 35 dc 94 d0 f7 5f 23 17 c1 2e 92 94 4e d8 36 39 fa 0d
         8c 2b 7c 36 75 c4 9b 3a 00 b6 87 82 09 b9 03 1e 43 33 55 58 63
         4f a2 37 1b 19 3e e5 d5 8f 74 bb 6b ff ef 05 c2 76 23 bd bc 15
         c5 cf 4e ee c0 f8 3c 0f 02 4b d2 53 fa df eb ec 88 4e 89 eb 1e
         ab 04 eb 4b 4d 86 ef 77 fe 8b df 05 3d ce 38 77 aa 33 33 9b a8
         95 a9 46 d8 da 3b 83 73 69 c8 a0 74 75 cd b5 e3 99 dd 32 52 eb
         52 ca 0d 21 49 fa 9a 4a 1e 4c 57 38 bb 1a 89 29 9c ec 9c c4 71
         ff 62 20 12 1e 1c 18 9a 6e c3 64 2b bc 4e 97 ff 6e 41 84 a5 e1
         ff 0e ef 68 d5 c3 d3 c5 cc b8 68 41 52 73 82 a8 28 ab de d4 99
         f3 86 3e e1 6d e3 05 e5 81 5d 1f d9 b4 af fa 9f 65 08 b3 23 7e
         17 c8 76 e6 1b b0 35 c6 3a b0 ca 3d 81 d4 97 f9 02 ec 1f 92 cc
         90 7f 3a bb df 9c 6e 4f ec 93 9f 23 ec 88 79 10 82 d1 37 3b 07
         5f 1c 6a 28 76 3b b8 d3 de 2d 25 7d ed f7 c4 ee ac 7d 82 c1 47
         9f d9 05 bd 51 bb 14 ce 97 95 18 c6 e7 95 89 71 2d 1a 20 f3 fa



Thomson                 Expires February 2, 2019               [Page 60]

Internet-Draft               TLS 1.3 Traces                  August 2018


         6b c6 e7 1c 64 60 1a cf 6a 6e 04 81 c8 d9 86 60 35 62 cf ed a3
         9a ff e3 46 aa b4 ad 9b f5 c7 9d a4 12 46 58 bb db 59 34 fe d8
         c4 6b 25 5a bd 29 2b 69 ec 3c 89 1e 48 15 0c 90 60 23 bf 52 35
         e8 5d 89 21 32 e2 1d 42 45 df 86 b3 ec 2a 66 de e5 3a cb b2 ed
         88 e6 8a 0d 82 6c 8a a3 24 38 84 ab 32 de b2 cc 20 88 0f 5c 4d
         b9 5b 35 31 91 86 44 80 34 cf a4 79 f5 86 4a 75 1e e7 c5 37 25
         43 ae a8 07 2b 2b 98 2e 55 6f fd ce b9 3c d0 30 f0 9d e6 ad e2
         a9 f8 5b 4a 5c 9e a9 d2 2f f1 f3 aa ba 3c 5f 9d b4 45 4f c5 57
         13 c5 b7 14 0a d0 82 4a d1 49 5f d4 1c 50 ab ae 1e 85 69 32 6a
         36 df 2b 9c 00 ed 2f b5 5a e6 e6 49 2d 2a d7 7e bc a7 dc c7 f2
         92 9a f9 f2 d6 5b 3e ae 14 2b 5c 5d e4 f9 10 27 8f b6 80 47 e6
         e7 dc 5c 8f d9 64 27 d3 a1 45 3f 02 e5 6f 29 a3

   {server}  derive secret "tls13 c ap traffic":

      PRK (32 octets):  42 99 10 c7 8c fe d8 67 81 40 46 c1 30 c3 e8 a8
         bc 2a bb d4 3e 6e 82 ee 03 9d e2 14 5f dc 02 c9

      hash (32 octets):  2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0 74
         a1 96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      info (54 octets):  00 20 12 74 6c 73 31 33 20 63 20 61 70 20 74 72
         61 66 66 69 63 20 2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0
         74 a1 96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      expanded (32 octets):  0d 08 92 0b 6b 47 e6 af 75 83 5c 18 37 78
         51 8d 8d fc 77 14 e8 4f 17 11 77 a1 34 fb f8 77 09 28

   {server}  derive secret "tls13 s ap traffic":

      PRK (32 octets):  42 99 10 c7 8c fe d8 67 81 40 46 c1 30 c3 e8 a8
         bc 2a bb d4 3e 6e 82 ee 03 9d e2 14 5f dc 02 c9

      hash (32 octets):  2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0 74
         a1 96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      info (54 octets):  00 20 12 74 6c 73 31 33 20 73 20 61 70 20 74 72
         61 66 66 69 63 20 2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0
         74 a1 96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      expanded (32 octets):  60 f0 95 8d 07 7d 1a 65 ab d9 7b 9c 30 c6
         6f 7f 53 7d dd 03 0b 1b 44 b5 1b f8 3c bb 10 07 a8 fb

   {server}  derive secret "tls13 exp master":

      PRK (32 octets):  42 99 10 c7 8c fe d8 67 81 40 46 c1 30 c3 e8 a8
         bc 2a bb d4 3e 6e 82 ee 03 9d e2 14 5f dc 02 c9




Thomson                 Expires February 2, 2019               [Page 61]

Internet-Draft               TLS 1.3 Traces                  August 2018


      hash (32 octets):  2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0 74
         a1 96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      info (52 octets):  00 20 10 74 6c 73 31 33 20 65 78 70 20 6d 61 73
         74 65 72 20 2e d4 bb 7a fb 90 ec 64 77 39 7f 76 2d 6a b0 74 a1
         96 cd 28 0f 19 4f 80 e2 bc 90 18 d8 c4 aa 82

      expanded (32 octets):  44 91 87 f6 11 dd 06 6b e4 b8 52 59 ed 4b
         e2 b6 4e 8b ba 33 36 cf 04 3b 8e 17 7d e3 71 79 31 70

   {server}  derive write traffic keys for application data:

      PRK (32 octets):  60 f0 95 8d 07 7d 1a 65 ab d9 7b 9c 30 c6 6f 7f
         53 7d dd 03 0b 1b 44 b5 1b f8 3c bb 10 07 a8 fb

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  6a ef a5 18 aa 35 03 f4 ce 9c fc 76 25
         96 be 65

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  35 78 d8 75 84 1a 30 44 e9 98 53 8e

   {server}  derive read traffic keys for handshake data:

      PRK (32 octets):  54 19 0d d0 55 33 85 55 8c f2 3f cf 09 4e 98 85
         d9 e3 9c f6 2a 92 0a e0 c3 4a 50 70 57 04 4d 89

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  f3 54 57 10 17 40 b0 e8 0b b0 96 cd 38
         6b 3d b9

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  14 a1 6e 65 b2 dd a2 c5 88 c6 a7 c3

   {client}  extract secret "early" (same as server early secret)

   {client}  derive secret for handshake "tls13 derived":

      PRK (32 octets):  33 ad 0a 1c 60 7e c0 3b 09 e6 cd 98 93 68 0c e2
         10 ad f3 00 aa 1f 26 60 e1 b2 2e 10 f1 70 f9 2a

      hash (32 octets):  e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24
         27 ae 41 e4 64 9b 93 4c a4 95 99 1b 78 52 b8 55




Thomson                 Expires February 2, 2019               [Page 62]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (49 octets):  00 20 0d 74 6c 73 31 33 20 64 65 72 69 76 65 64
         20 e3 b0 c4 42 98 fc 1c 14 9a fb f4 c8 99 6f b9 24 27 ae 41 e4
         64 9b 93 4c a4 95 99 1b 78 52 b8 55

      expanded (32 octets):  6f 26 15 a1 08 c7 02 c5 67 8f 54 fc 9d ba
         b6 97 16 c0 76 18 9c 48 25 0c eb ea c3 57 6c 36 11 ba

   {client}  extract secret "handshake" (same as server handshake
      secret)

   {client}  derive secret "tls13 c hs traffic" (same as server)

   {client}  derive secret "tls13 s hs traffic" (same as server)

   {client}  derive secret for master "tls13 derived" (same as server)

   {client}  extract secret "master" (same as server master secret)

   {client}  derive read traffic keys for handshake data (same as server
      handshake data write traffic keys)

   {client}  calculate finished "tls13 finished" (same as server)

   {client}  derive secret "tls13 c ap traffic" (same as server)

   {client}  derive secret "tls13 s ap traffic" (same as server)

   {client}  derive secret "tls13 exp master" (same as server)

   {client}  send change_cipher_spec record:

      payload (1 octets):  01

      complete record (6 octets):  14 03 03 00 01 01

   {client}  derive write traffic keys for handshake data (same as
      server handshake data read traffic keys)

   {client}  derive read traffic keys for application data (same as
      server application data write traffic keys)

   {client}  calculate finished "tls13 finished":

      PRK (32 octets):  54 19 0d d0 55 33 85 55 8c f2 3f cf 09 4e 98 85
         d9 e3 9c f6 2a 92 0a e0 c3 4a 50 70 57 04 4d 89

      hash (0 octets):  (empty)




Thomson                 Expires February 2, 2019               [Page 63]

Internet-Draft               TLS 1.3 Traces                  August 2018


      info (18 octets):  00 20 0e 74 6c 73 31 33 20 66 69 6e 69 73 68 65
         64 00

      expanded (32 octets):  0c e2 54 79 ee d3 f3 cb d2 fc 8c 9f 8c 32
         dd 0a 0e a0 ba d5 11 d3 12 4d d8 23 37 04 9d d2 c3 89

   {client}  construct a Finished handshake message

      Finished (36 octets):  14 00 00 20 29 2a 52 39 16 6d 37 fc 70 2b
         96 56 8e 0e ae 46 25 a5 ba 46 39 20 31 db 04 00 d2 d2 f5 0d f5
         3d

   {client}  send handshake record:

      payload (36 octets):  14 00 00 20 29 2a 52 39 16 6d 37 fc 70 2b 96
         56 8e 0e ae 46 25 a5 ba 46 39 20 31 db 04 00 d2 d2 f5 0d f5 3d

      complete record (58 octets):  17 03 03 00 35 3a 7a 34 de e0 46 73
         a8 7a be dd ad 3a c5 68 2d 11 fe bb c5 ef 5e b5 66 b4 5c 46 78
         69 7d 7a 85 9c c8 09 dd 63 96 9a fd 7e 5d 3d 6c 8b 1d 73 cf 6d
         85 07 bf c0

   {client}  derive write traffic keys for application data:

      PRK (32 octets):  0d 08 92 0b 6b 47 e6 af 75 83 5c 18 37 78 51 8d
         8d fc 77 14 e8 4f 17 11 77 a1 34 fb f8 77 09 28

      key info (13 octets):  00 10 09 74 6c 73 31 33 20 6b 65 79 00

      key expanded (16 octets):  f6 e7 af ae b7 ea 39 23 28 59 30 b0 a8
         22 0c ad

      iv info (12 octets):  00 0c 08 74 6c 73 31 33 20 69 76 00

      iv expanded (12 octets):  1c 06 2b c4 8e d7 1c 05 cf 0f dd 39

   {client}  derive secret "tls13 res master":

      PRK (32 octets):  42 99 10 c7 8c fe d8 67 81 40 46 c1 30 c3 e8 a8
         bc 2a bb d4 3e 6e 82 ee 03 9d e2 14 5f dc 02 c9

      hash (32 octets):  da 09 ec 1c b2 c6 21 18 72 6b 22 c7 92 48 8e f5
         f3 af ff 6d 92 42 c6 de 6c 69 79 1d 1f ad 93 4c

      info (52 octets):  00 20 10 74 6c 73 31 33 20 72 65 73 20 6d 61 73
         74 65 72 20 da 09 ec 1c b2 c6 21 18 72 6b 22 c7 92 48 8e f5 f3
         af ff 6d 92 42 c6 de 6c 69 79 1d 1f ad 93 4c




Thomson                 Expires February 2, 2019               [Page 64]

Internet-Draft               TLS 1.3 Traces                  August 2018


      expanded (32 octets):  e8 17 a9 bd c3 4a f9 9e 43 ed 88 3e f0 a7
         18 dc 64 44 66 2f 10 b6 d3 e9 4a 4c 92 fc 9a fe 40 70

   {server}  calculate finished "tls13 finished" (same as client)

   {server}  derive read traffic keys for application data (same as
      client application data write traffic keys)

   {server}  derive secret "tls13 res master" (same as client)

   {client}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 f1 ef 0c cc f3 87 a7
         6b df 02 cd ab bb a3 5d 48 f8 ce 93

   {server}  send alert record:

      payload (2 octets):  01 00

      complete record (24 octets):  17 03 03 00 13 18 52 e6 bc 4b 37 49
         c0 66 46 cd 9f e8 24 58 98 f2 ec f0

8.  Security Considerations

   It probably isn't a good idea to use the private key here.  If it
   weren't for the fact that it is too small to provide any meaningful
   security, it is now very well known.

9.  IANA Considerations

   This document makes no requests of IANA.

10.  References

10.1.  Normative References

   [TLS13]    Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", draft-ietf-tls-tls13-21 (work in progress),
              July 2017.

10.2.  Informative References

   [FIPS186]  National Institute of Standards and Technology (NIST),
              "Digital Signature Standard (DSS)", NIST PUB 186-4 , July
              2013.




Thomson                 Expires February 2, 2019               [Page 65]

Internet-Draft               TLS 1.3 Traces                  August 2018


   [RFC5869]  Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-Expand
              Key Derivation Function (HKDF)", RFC 5869,
              DOI 10.17487/RFC5869, May 2010,
              <https://www.rfc-editor.org/info/rfc5869>.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

10.3.  URIs

   [1] https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS

Appendix A.  Acknowledgements

   This draft is generated using tests that were written for NSS [1].
   None of this would have been possible without Franziskus Kiefer, Eric
   Rescorla and Tim Taubert, who did a lot of the work in NSS.

Author's Address

   Martin Thomson
   Mozilla

   Email: martin.thomson@gmail.com


























Thomson                 Expires February 2, 2019               [Page 66]
